FIT Profiler Report
Profile stats for: prepare_data
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        1    0.000    0.000    0.000    0.000 hooks.py:325(prepare_data)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: configure_callbacks
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        1    0.000    0.000    0.000    0.000 lightning.py:1199(configure_callbacks)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_before_accelerator_backend_setup
         76 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:35(on_before_accelerator_backend_setup)
        6    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
        6    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        6    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        6    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        6    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        7    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        1    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        6    0.000    0.000    0.000    0.000 base.py:63(on_before_accelerator_backend_setup)
        6    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: setup
         72 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:45(setup)
        6    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
        6    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        6    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        6    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        6    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        6    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        6    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        6    0.000    0.000    0.000    0.000 base.py:67(setup)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 hooks.py:373(setup)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: configure_sharded_model
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        1    0.000    0.000    0.000    0.000 hooks.py:298(configure_sharded_model)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_configure_sharded_model
         76 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:40(on_configure_sharded_model)
        6    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
        6    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        6    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        6    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        6    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        7    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        1    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        6    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        6    0.000    0.000    0.000    0.000 base.py:60(on_configure_sharded_model)
        1    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: configure_optimizers
         3062 function calls (2600 primitive calls) in 0.006 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.006    0.006 deepmil.py:180(configure_optimizers)
        1    0.000    0.000    0.006    0.006 adam.py:60(__init__)
        1    0.000    0.000    0.006    0.006 optimizer.py:33(__init__)
       67    0.000    0.000    0.005    0.000 module.py:1499(parameters)
       67    0.000    0.000    0.005    0.000 module.py:1523(named_parameters)
       67    0.000    0.000    0.005    0.000 module.py:1486(_named_members)
   560/98    0.001    0.000    0.003    0.000 module.py:1653(named_modules)
       30    0.001    0.000    0.002    0.000 metric.py:560(__hash__)
      378    0.001    0.000    0.002    0.000 _tensor.py:650(__hash__)
      163    0.000    0.000    0.001    0.000 {method 'add' of 'set' objects}
        1    0.000    0.000    0.001    0.001 optimizer.py:232(add_param_group)
       30    0.000    0.000    0.001    0.000 {built-in method builtins.hash}
      408    0.000    0.000    0.000    0.000 {built-in method builtins.id}
      378    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
       97    0.000    0.000    0.000    0.000 module.py:1544(<lambda>)
      197    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      194    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
      136    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      127    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      115    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        1    0.000    0.000    0.000    0.000 optimizer.py:78(_hook_for_profile)
        1    0.000    0.000    0.000    0.000 optimizer.py:81(profile_hook_step)
        1    0.000    0.000    0.000    0.000 functools.py:37(update_wrapper)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
       12    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        5    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.setattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        1    0.000    0.000    0.000    0.000 functools.py:67(wraps)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}



Profile stats for: on_fit_start
         75 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:65(on_fit_start)
        6    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
        6    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        6    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        6    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        6    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        6    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        7    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        6    0.000    0.000    0.000    0.000 base.py:83(on_fit_start)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 hooks.py:28(on_fit_start)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_pretrain_routine_start
         12428 function calls (10684 primitive calls) in 0.028 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.028    0.028 callback_hook.py:145(on_pretrain_routine_start)
        1    0.000    0.000    0.028    0.028 model_summary.py:52(on_pretrain_routine_start)
       12    0.000    0.000    0.026    0.002 {built-in method builtins.sum}
      275    0.001    0.000    0.021    0.000 module.py:1499(parameters)
      275    0.001    0.000    0.020    0.000 module.py:1523(named_parameters)
      275    0.002    0.000    0.019    0.000 module.py:1486(_named_members)
 2142/398    0.005    0.000    0.013    0.000 module.py:1653(named_modules)
        2    0.000    0.000    0.012    0.006 model_summary.py:248(total_parameters)
      134    0.001    0.000    0.012    0.000 model_summary.py:250(<genexpr>)
        1    0.000    0.000    0.009    0.009 model_summary.py:300(_get_summary_data)
        1    0.000    0.000    0.009    0.009 model_summary.py:244(param_nums)
        1    0.000    0.000    0.009    0.009 model_summary.py:246(<listcomp>)
        8    0.000    0.000    0.009    0.001 model_summary.py:122(num_parameters)
       74    0.000    0.000    0.009    0.000 model_summary.py:125(<genexpr>)
      120    0.002    0.000    0.007    0.000 metric.py:560(__hash__)
      659    0.001    0.000    0.006    0.000 {method 'add' of 'set' objects}
        1    0.000    0.000    0.006    0.006 model_summary.py:258(model_size)
        1    0.000    0.000    0.006    0.006 model_summary.py:252(trainable_parameters)
        7    0.000    0.000    0.006    0.001 model_summary.py:255(<genexpr>)
      984    0.003    0.000    0.005    0.000 _tensor.py:650(__hash__)
      120    0.001    0.000    0.003    0.000 {built-in method builtins.hash}
       66    0.000    0.000    0.002    0.000 <__array_function__ internals>:2(prod)
       66    0.000    0.000    0.002    0.000 {built-in method numpy.core._multiarray_umath.implement_array_function}
       66    0.000    0.000    0.002    0.000 fromnumeric.py:2881(prod)
      204    0.001    0.000    0.002    0.000 model_summary.py:426(_is_lazy_weight_tensor)
       66    0.000    0.000    0.002    0.000 fromnumeric.py:70(_wrapreduction)
      387    0.001    0.000    0.001    0.000 module.py:1544(<lambda>)
      984    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_unary}
     1104    0.001    0.000    0.001    0.000 {built-in method builtins.id}
       66    0.001    0.000    0.001    0.000 {method 'reduce' of 'numpy.ufunc' objects}
      739    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
      712    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.001    0.001 model_summary.py:65(summarize)
      204    0.000    0.000    0.001    0.000 <frozen importlib._bootstrap>:1009(_handle_fromlist)
      775    0.001    0.000    0.001    0.000 {method 'items' of 'collections.OrderedDict' objects}
      572    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 model_summary.py:341(_format_summary_table)
      492    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        3    0.000    0.000    0.000    0.000 model_checkpoint.py:271(on_pretrain_routine_start)
        1    0.000    0.000    0.000    0.000 model_summary.py:439(summarize)
        1    0.000    0.000    0.000    0.000 model_summary.py:189(__init__)
        3    0.000    0.000    0.000    0.000 model_checkpoint.py:621(__warn_if_dir_not_empty)
        2    0.000    0.000    0.000    0.000 spec.py:622(isdir)
        1    0.000    0.000    0.000    0.000 model_summary.py:263(summarize)
        2    0.000    0.000    0.000    0.000 local.py:65(info)
        1    0.000    0.000    0.000    0.000 __init__.py:1373(info)
        2    0.000    0.000    0.000    0.000 local.py:182(_strip_protocol)
        1    0.000    0.000    0.000    0.000 __init__.py:1496(_log)
       11    0.000    0.000    0.000    0.000 model_summary.py:389(get_human_readable_count)
        9    0.000    0.000    0.000    0.000 model_summary.py:264(<genexpr>)
      138    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
        8    0.000    0.000    0.000    0.000 model_summary.py:68(__init__)
        2    0.000    0.000    0.000    0.000 utils.py:290(stringify_path)
        8    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        8    0.000    0.000    0.000    0.000 model_summary.py:78(_register_hook)
        1    0.000    0.000    0.000    0.000 __init__.py:1521(handle)
        6    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
        1    0.000    0.000    0.000    0.000 __init__.py:1575(callHandlers)
        1    0.000    0.000    0.000    0.000 __init__.py:892(handle)
        1    0.000    0.000    0.000    0.000 __init__.py:1481(makeRecord)
        1    0.000    0.000    0.000    0.000 __init__.py:293(__init__)
       36    0.000    0.000    0.000    0.000 model_summary.py:355(<genexpr>)
        6    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 __init__.py:1022(emit)
       66    0.000    0.000    0.000    0.000 fromnumeric.py:71(<dictcomp>)
        6    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        6    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       66    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
       66    0.000    0.000    0.000    0.000 fromnumeric.py:2876(_prod_dispatcher)
       16    0.000    0.000    0.000    0.000 model_summary.py:101(detach_hook)
        8    0.000    0.000    0.000    0.000 module.py:1053(register_forward_hook)
       40    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 model_summary.py:215(named_modules)
       48    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}
        8    0.000    0.000    0.000    0.000 model_summary.py:75(__del__)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        9    0.000    0.000    0.000    0.000 module.py:1606(named_children)
        4    0.000    0.000    0.000    0.000 trainer.py:1773(is_global_zero)
        2    0.000    0.000    0.000    0.000 {built-in method posix.stat}
        1    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        1    0.000    0.000    0.000    0.000 __init__.py:869(format)
        1    0.000    0.000    0.000    0.000 model_summary.py:232(layer_types)
        1    0.000    0.000    0.000    0.000 __init__.py:1619(isEnabledFor)
        1    0.000    0.000    0.000    0.000 __init__.py:1451(findCaller)
        4    0.000    0.000    0.000    0.000 trainer.py:1619(global_rank)
        1    0.000    0.000    0.000    0.000 __init__.py:606(format)
        1    0.000    0.000    0.000    0.000 model_summary.py:234(<listcomp>)
       16    0.000    0.000    0.000    0.000 hooks.py:20(remove)
        1    0.000    0.000    0.000    0.000 model_summary.py:272(<listcomp>)
        6    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        8    0.000    0.000    0.000    0.000 hooks.py:15(__init__)
        5    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        1    0.000    0.000    0.000    0.000 __init__.py:1011(flush)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 model_summary.py:362(<listcomp>)
        1    0.000    0.000    0.000    0.000 posixpath.py:121(splitext)
       11    0.000    0.000    0.000    0.000 {built-in method builtins.min}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       11    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        2    0.000    0.000    0.000    0.000 local.py:200(make_path_posix)
        1    0.000    0.000    0.000    0.000 posixpath.py:144(basename)
        8    0.000    0.000    0.000    0.000 model_summary.py:117(layer_type)
        8    0.000    0.000    0.000    0.000 {method 'count' of 'str' objects}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 __init__.py:584(usesTime)
        6    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        9    0.000    0.000    0.000    0.000 {method 'join' of 'str' objects}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 __init__.py:849(acquire)
        2    0.000    0.000    0.000    0.000 __init__.py:856(release)
        1    0.000    0.000    0.000    0.000 __init__.py:212(_acquireLock)
        1    0.000    0.000    0.000    0.000 __init__.py:154(<lambda>)
        1    0.000    0.000    0.000    0.000 posixpath.py:52(normcase)
        1    0.000    0.000    0.000    0.000 genericpath.py:117(_splitext)
        4    0.000    0.000    0.000    0.000 {method 'startswith' of 'str' objects}
        1    0.000    0.000    0.000    0.000 __init__.py:590(formatMessage)
        1    0.000    0.000    0.000    0.000 __init__.py:429(usesTime)
        1    0.000    0.000    0.000    0.000 __init__.py:117(getLevelName)
        3    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        3    0.000    0.000    0.000    0.000 {method 'rfind' of 'str' objects}
        3    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 model_summary.py:228(layer_names)
        1    0.000    0.000    0.000    0.000 threading.py:1214(current_thread)
        3    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
        2    0.000    0.000    0.000    0.000 lightning.py:186(example_input_array)
        2    0.000    0.000    0.000    0.000 __init__.py:747(filter)
        1    0.000    0.000    0.000    0.000 __init__.py:221(_releaseLock)
        3    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 {built-in method time.time}
        3    0.000    0.000    0.000    0.000 {built-in method posix.fspath}
        2    0.000    0.000    0.000    0.000 {method 'rstrip' of 'str' objects}
        3    0.000    0.000    0.000    0.000 model_checkpoint.py:582(__resolve_ckpt_dir)
        1    0.000    0.000    0.000    0.000 __init__.py:1605(getEffectiveLevel)
        1    0.000    0.000    0.000    0.000 __init__.py:432(format)
        1    0.000    0.000    0.000    0.000 posixpath.py:41(_get_sep)
        2    0.000    0.000    0.000    0.000 {built-in method _thread.get_ident}
        1    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
        1    0.000    0.000    0.000    0.000 {built-in method sys._getframe}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'find' of 'str' objects}
        1    0.000    0.000    0.000    0.000 hooks.py:64(on_pretrain_routine_start)
        1    0.000    0.000    0.000    0.000 model_summary.py:385(get_formatted_model_size)
        2    0.000    0.000    0.000    0.000 base.py:238(on_pretrain_routine_start)
        1    0.000    0.000    0.000    0.000 process.py:180(name)
        1    0.000    0.000    0.000    0.000 threading.py:1052(name)
        1    0.000    0.000    0.000    0.000 __init__.py:371(getMessage)
        1    0.000    0.000    0.000    0.000 {method 'keys' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        1    0.000    0.000    0.000    0.000 process.py:36(current_process)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_pretrain_routine_end
         75 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:150(on_pretrain_routine_end)
        6    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
        6    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        6    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        6    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        6    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        7    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        6    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        6    0.000    0.000    0.000    0.000 base.py:242(on_pretrain_routine_end)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 hooks.py:73(on_pretrain_routine_end)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_dataloader
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        1    0.000    0.000    0.000    0.000 hooks.py:620(on_train_dataloader)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_val_dataloader
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 hooks.py:628(on_val_dataloader)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_start
         391 function calls in 0.002 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.002    0.002 callback_hook.py:135(on_train_start)
        1    0.000    0.000    0.002    0.002 tqdm_progress.py:218(on_train_start)
        1    0.000    0.000    0.002    0.002 tqdm_progress.py:154(init_train_tqdm)
        1    0.000    0.000    0.001    0.001 std.py:560(__new__)
        1    0.000    0.000    0.001    0.001 tqdm_progress.py:34(__init__)
        1    0.000    0.000    0.001    0.001 asyncio.py:23(__init__)
        1    0.000    0.000    0.001    0.001 std.py:846(__init__)
        1    0.000    0.000    0.000    0.000 std.py:657(get_lock)
        1    0.000    0.000    0.000    0.000 std.py:92(__init__)
        1    0.000    0.000    0.000    0.000 std.py:118(create_mp_lock)
        1    0.000    0.000    0.000    0.000 context.py:69(RLock)
        1    0.000    0.000    0.000    0.000 synchronize.py:186(__init__)
        1    0.000    0.000    0.000    0.000 synchronize.py:50(__init__)
        1    0.000    0.000    0.000    0.000 _monitor.py:30(__init__)
        1    0.000    0.000    0.000    0.000 std.py:1339(refresh)
        1    0.000    0.000    0.000    0.000 std.py:1478(display)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 __init__.py:8(_make_name)
        1    0.000    0.000    0.000    0.000 threading.py:829(start)
        1    0.000    0.000    0.000    0.000 tempfile.py:153(__next__)
        2    0.000    0.000    0.000    0.000 utils.py:282(_screen_shape_linux)
        1    0.000    0.000    0.000    0.000 std.py:348(print_status)
        1    0.000    0.000    0.000    0.000 utils.py:333(disp_len)
        1    0.000    0.000    0.000    0.000 threading.py:534(wait)
        1    0.000    0.000    0.000    0.000 tempfile.py:156(<listcomp>)
        6    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
        1    0.000    0.000    0.000    0.000 utils.py:329(_text_width)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.sum}
        8    0.000    0.000    0.000    0.000 random.py:256(choice)
        1    0.000    0.000    0.000    0.000 threading.py:264(wait)
        6    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 std.py:1164(__str__)
       29    0.000    0.000    0.000    0.000 utils.py:330(<genexpr>)
        4    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.lock' objects}
        6    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        6    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 {built-in method _thread.start_new_thread}
        1    0.000    0.000    0.000    0.000 tempfile.py:142(rng)
        8    0.000    0.000    0.000    0.000 random.py:224(_randbelow)
        1    0.000    0.000    0.000    0.000 std.py:1460(format_dict)
        1    0.000    0.000    0.000    0.000 threading.py:758(__init__)
       14    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        2    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
        1    0.000    0.000    0.000    0.000 std.py:355(format_meter)
       28    0.000    0.000    0.000    0.000 {built-in method unicodedata.east_asian_width}
        8    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:1009(_handle_fromlist)
        1    0.000    0.000    0.000    0.000 random.py:88(__init__)
        1    0.000    0.000    0.000    0.000 utils.py:162(__init__)
        8    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 random.py:97(seed)
        1    0.000    0.000    0.000    0.000 std.py:342(fp_write)
        1    0.000    0.000    0.000    0.000 gpu.py:48(on_train_start)
        1    0.000    0.000    0.000    0.000 util.py:136(register_after_fork)
       16    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        2    0.000    0.000    0.000    0.000 std.py:112(__enter__)
        2    0.000    0.000    0.000    0.000 threading.py:499(__init__)
        3    0.000    0.000    0.000    0.000 std.py:104(acquire)
        2    0.000    0.000    0.000    0.000 utils.py:143(inner)
        3    0.000    0.000    0.000    0.000 std.py:108(release)
        6    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        1    0.000    0.000    0.000    0.000 std.py:329(status_printer)
        1    0.000    0.000    0.000    0.000 {function Random.seed at 0x7f1bc329fbf8}
        3    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 std.py:115(__exit__)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        3    0.000    0.000    0.000    0.000 model_checkpoint.py:277(on_train_start)
        1    0.000    0.000    0.000    0.000 utils.py:215(_supports_unicode)
        1    0.000    0.000    0.000    0.000 weakref.py:165(__setitem__)
       17    0.000    0.000    0.000    0.000 {method 'getrandbits' of '_random.Random' objects}
        2    0.000    0.000    0.000    0.000 _weakrefset.py:81(add)
        1    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        1    0.000    0.000    0.000    0.000 memory.py:102(empty_cache)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 std.py:288(format_interval)
        4    0.000    0.000    0.000    0.000 utils.py:171(__eq__)
        2    0.000    0.000    0.000    0.000 threading.py:216(__init__)
        3    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        2    0.000    0.000    0.000    0.000 utils.py:136(disable_on_exception)
        6    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:132(is_disabled)
        3    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        3    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        8    0.000    0.000    0.000    0.000 {method 'bit_length' of 'int' objects}
        8    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        2    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        3    0.000    0.000    0.000    0.000 {built-in method time.monotonic}
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:128(is_enabled)
        3    0.000    0.000    0.000    0.000 utils.py:101(wrapper_setattr)
        1    0.000    0.000    0.000    0.000 utils.py:105(__init__)
        1    0.000    0.000    0.000    0.000 utils.py:201(_is_utf)
        1    0.000    0.000    0.000    0.000 __init__.py:146(is_initialized)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:416(parent)
        4    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        2    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
        1    0.000    0.000    0.000    0.000 context.py:232(get_context)
        1    0.000    0.000    0.000    0.000 threading.py:240(__enter__)
        1    0.000    0.000    0.000    0.000 threading.py:243(__exit__)
        1    0.000    0.000    0.000    0.000 threading.py:255(_is_owned)
        1    0.000    0.000    0.000    0.000 threading.py:1214(current_thread)
        3    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        4    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        3    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}
        1    0.000    0.000    0.000    0.000 accelerator.py:568(on_train_start)
        3    0.000    0.000    0.000    0.000 std.py:228(__init__)
        1    0.000    0.000    0.000    0.000 threading.py:249(_release_save)
        1    0.000    0.000    0.000    0.000 threading.py:252(_acquire_restore)
        1    0.000    0.000    0.000    0.000 threading.py:1120(daemon)
        1    0.000    0.000    0.000    0.000 weakref.py:336(__new__)
        1    0.000    0.000    0.000    0.000 {method 'sub' of 're.Pattern' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_emptyCache}
        1    0.000    0.000    0.000    0.000 synchronize.py:90(_make_methods)
        1    0.000    0.000    0.000    0.000 base.py:158(on_train_start)
        1    0.000    0.000    0.000    0.000 std.py:1171(__hash__)
        3    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        1    0.000    0.000    0.000    0.000 {built-in method utcfromtimestamp}
        1    0.000    0.000    0.000    0.000 {method '__enter__' of '_thread.lock' objects}
        1    0.000    0.000    0.000    0.000 {built-in method time.time}
        1    0.000    0.000    0.000    0.000 {built-in method atexit.register}
        1    0.000    0.000    0.000    0.000 {method 'append' of 'collections.deque' objects}
        2    0.000    0.000    0.000    0.000 {built-in method _weakref.proxy}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        1    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'join' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'rpartition' of 'str' objects}
        2    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x561a1dcdf3c0}
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_isInBadFork}
        1    0.000    0.000    0.000    0.000 std.py:233(__call__)
        1    0.000    0.000    0.000    0.000 utils.py:231(_screen_shape_wrapper)
        1    0.000    0.000    0.000    0.000 util.py:48(debug)
        2    0.000    0.000    0.000    0.000 base.py:230(on_train_start)
        1    0.000    0.000    0.000    0.000 context.py:196(get_start_method)
        2    0.000    0.000    0.000    0.000 threading.py:507(is_set)
        1    0.000    0.000    0.000    0.000 threading.py:728(_newname)
        1    0.000    0.000    0.000    0.000 threading.py:1104(daemon)
        1    0.000    0.000    0.000    0.000 weakref.py:341(__init__)
        1    0.000    0.000    0.000    0.000 {method 'release' of '_thread.lock' objects}
        1    0.000    0.000    0.000    0.000 {method '__exit__' of '_thread.lock' objects}
        1    0.000    0.000    0.000    0.000 {built-in method _thread.get_ident}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:331(on_train_start)
        1    0.000    0.000    0.000    0.000 base.py:61(train_batch_idx)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:120(refresh_rate)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:124(process_position)
        1    0.000    0.000    0.000    0.000 hooks.py:40(on_train_start)
        1    0.000    0.000    0.000    0.000 std.py:100(<listcomp>)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: run_training_epoch
         45 function calls in 362.748 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  362.748  362.748 base.py:109(run)
        1    0.000    0.000  362.748  362.748 training_epoch_loop.py:133(on_run_start)
        1    0.000    0.000  362.748  362.748 trainer.py:1477(call_hook)
        1    0.000    0.000  362.748  362.748 contextlib.py:107(__enter__)
        1    0.000    0.000  362.748  362.748 {built-in method builtins.next}
        1    0.000    0.000  362.748  362.748 base.py:68(profile)
        1    0.000    0.000  362.748  362.748 advanced.py:61(start)
        1  362.748  362.748  362.748  362.748 {method 'enable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 training_epoch_loop.py:118(reset)
        1    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
        1    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        4    0.000    0.000    0.000    0.000 progress.py:154(reset_on_run)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        1    0.000    0.000    0.000    0.000 progress.py:263(reset_on_run)
        1    0.000    0.000    0.000    0.000 progress.py:194(reset_on_run)
        1    0.000    0.000    0.000    0.000 module.py:1180(__setattr__)
        1    0.000    0.000    0.000    0.000 progress.py:230(reset_on_run)
        2    0.000    0.000    0.000    0.000 progress.py:77(reset)
        1    0.000    0.000    0.000    0.000 progress.py:101(reset)
        1    0.000    0.000    0.000    0.000 contextlib.py:237(helper)
        1    0.000    0.000    0.000    0.000 contextlib.py:81(__init__)
        4    0.000    0.000    0.000    0.000 progress.py:49(reset)
        1    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        3    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 base.py:54(trainer)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 base.py:84(skip)
        1    0.000    0.000    0.000    0.000 logger_connector.py:258(on_epoch_start)
        1    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)



Profile stats for: on_epoch_start
         150 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 callback_hook.py:125(on_epoch_start)
       12    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
       12    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
       12    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
       12    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       24    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       12    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        2    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 base.py:68(profile)
       14    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
       12    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        2    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       12    0.000    0.000    0.000    0.000 base.py:160(on_epoch_start)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 hooks.py:184(on_epoch_start)
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_epoch_start
         1957 function calls in 0.004 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.004    0.004 callback_hook.py:85(on_train_epoch_start)
        1    0.000    0.000    0.004    0.004 tqdm_progress.py:222(on_train_epoch_start)
        2    0.000    0.000    0.004    0.002 std.py:1339(refresh)
        2    0.000    0.000    0.004    0.002 std.py:1478(display)
        6    0.000    0.000    0.003    0.001 utils.py:333(disp_len)
        6    0.000    0.000    0.003    0.001 utils.py:329(_text_width)
        7    0.001    0.000    0.003    0.000 {built-in method builtins.sum}
      829    0.002    0.000    0.002    0.000 utils.py:330(<genexpr>)
        2    0.000    0.000    0.002    0.001 std.py:1164(__str__)
        2    0.000    0.000    0.002    0.001 std.py:355(format_meter)
        1    0.000    0.000    0.002    0.002 tqdm_progress.py:338(reset)
        1    0.000    0.000    0.002    0.002 std.py:1374(reset)
        1    0.000    0.000    0.002    0.002 std.py:1396(set_description)
        2    0.000    0.000    0.001    0.001 std.py:348(print_status)
        2    0.000    0.000    0.001    0.001 utils.py:341(disp_trim)
      823    0.001    0.000    0.001    0.000 {built-in method unicodedata.east_asian_width}
        7    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
        2    0.000    0.000    0.000    0.000 std.py:1460(format_dict)
        7    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        4    0.000    0.000    0.000    0.000 utils.py:222(_is_ascii)
        7    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        2    0.000    0.000    0.000    0.000 utils.py:282(_screen_shape_linux)
        7    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       10    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 base.py:102(total_val_batches)
        2    0.000    0.000    0.000    0.000 std.py:342(fp_write)
       21    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        4    0.000    0.000    0.000    0.000 utils.py:143(inner)
        1    0.000    0.000    0.000    0.000 trainer.py:1844(enable_validation)
       42    0.000    0.000    0.000    0.000 {built-in method builtins.ord}
        2    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        2    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
        2    0.000    0.000    0.000    0.000 std.py:288(format_interval)
        2    0.000    0.000    0.000    0.000 std.py:188(__format__)
        7    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        6    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:1009(_handle_fromlist)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        3    0.000    0.000    0.000    0.000 trainer.py:2037(current_epoch)
        1    0.000    0.000    0.000    0.000 model_helpers.py:22(is_overridden)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        2    0.000    0.000    0.000    0.000 std.py:104(acquire)
        2    0.000    0.000    0.000    0.000 std.py:108(release)
        1    0.000    0.000    0.000    0.000 gradient_accumulation_scheduler.py:102(on_train_epoch_start)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 std.py:155(__init__)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        6    0.000    0.000    0.000    0.000 {method 'sub' of 're.Pattern' objects}
        6    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:328(convert_inf)
        7    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        8    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        3    0.000    0.000    0.000    0.000 {built-in method time.time}
        6    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
        3    0.000    0.000    0.000    0.000 fit_loop.py:55(current_epoch)
        5    0.000    0.000    0.000    0.000 base.py:57(trainer)
        1    0.000    0.000    0.000    0.000 base.py:161(on_train_epoch_start)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        4    0.000    0.000    0.000    0.000 trainer.py:2061(fit_loop)
        1    0.000    0.000    0.000    0.000 base.py:93(total_train_batches)
        3    0.000    0.000    0.000    0.000 std.py:228(__init__)
        2    0.000    0.000    0.000    0.000 utils.py:57(__init__)
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        4    0.000    0.000    0.000    0.000 base.py:122(on_train_epoch_start)
        2    0.000    0.000    0.000    0.000 {built-in method utcfromtimestamp}
        2    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        1    0.000    0.000    0.000    0.000 gradient_accumulation_scheduler.py:94(get_accumulate_grad_batches)
        2    0.000    0.000    0.000    0.000 std.py:165(colour)
        2    0.000    0.000    0.000    0.000 std.py:169(colour)
        2    0.000    0.000    0.000    0.000 std.py:233(__call__)
        2    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 utils.py:61(__format__)
        2    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {built-in method math.isinf}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 hooks.py:190(on_train_epoch_start)
        1    0.000    0.000    0.000    0.000 base.py:61(train_batch_idx)
        1    0.000    0.000    0.000    0.000 {built-in method math.isnan}



Profile stats for: get_train_batch
         231 function calls (209 primitive calls) in 218.086 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    33/22    0.000    0.000  218.085    9.913 contextlib.py:107(__enter__)
    33/22    0.000    0.000  218.085    9.913 {built-in method builtins.next}
       11    0.000    0.000  218.085   19.826 fetching.py:287(apply_profiler)
       11    0.000    0.000  218.085   19.826 base.py:68(profile)
       11    0.000    0.000  218.085   19.826 advanced.py:61(start)
       11  218.085   19.826  218.085   19.826 {method 'enable' of '_lsprof.Profiler' objects}
       33    0.000    0.000    0.000    0.000 contextlib.py:237(helper)
       33    0.000    0.000    0.000    0.000 contextlib.py:81(__init__)
       33    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       11    0.000    0.000    0.000    0.000 fetching.py:243(on_fetch_start)
       11    0.000    0.000    0.000    0.000 fetching.py:238(fetching_context)



Profile stats for: fetch_next_train_batch
         2577 function calls (2522 primitive calls) in 218.085 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    66/22    0.000    0.000  218.085    9.913 {built-in method builtins.next}
       11    0.000    0.000  218.084   19.826 supporters.py:544(__next__)
       11    0.000    0.000  218.084   19.826 supporters.py:552(request_next_batch)
       11    0.000    0.000  218.084   19.826 apply_func.py:66(apply_to_collection)
       11    0.000    0.000  218.084   19.826 dataloader.py:517(__next__)
       11    0.000    0.000  218.082   19.826 dataloader.py:1156(_next_data)
       12    0.000    0.000  218.080   18.173 dataloader.py:1123(_get_data)
       49    0.001    0.000  218.079    4.451 dataloader.py:977(_try_get_data)
       49    0.002    0.000  218.075    4.451 queue.py:153(get)
       49    0.001    0.000  218.072    4.450 threading.py:264(wait)
      268  218.071    0.814  218.071    0.814 {method 'acquire' of '_thread.lock' objects}
       74    0.001    0.000    0.002    0.000 process.py:144(is_alive)
       11    0.000    0.000    0.001    0.000 dataloader.py:1225(_process_data)
       11    0.000    0.000    0.001    0.000 dataloader.py:1205(_try_put_index)
       11    0.000    0.000    0.001    0.000 profiler.py:438(__exit__)
       49    0.001    0.000    0.001    0.000 threading.py:1080(is_alive)
       74    0.000    0.000    0.001    0.000 popen_fork.py:25(poll)
       11    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_exit}
       74    0.001    0.000    0.001    0.000 {built-in method posix.waitpid}
       11    0.000    0.000    0.001    0.000 queues.py:80(put)
       98    0.000    0.000    0.000    0.000 queue.py:208(_qsize)
       11    0.000    0.000    0.000    0.000 profiler.py:434(__enter__)
       11    0.000    0.000    0.000    0.000 profiler.py:426(__init__)
       11    0.000    0.000    0.000    0.000 dataloader.py:511(_next_index)
       49    0.000    0.000    0.000    0.000 threading.py:252(_acquire_restore)
       11    0.000    0.000    0.000    0.000 {built-in method zeros}
       23    0.000    0.000    0.000    0.000 threading.py:335(notify)
      135    0.000    0.000    0.000    0.000 {built-in method time.monotonic}
       11    0.000    0.000    0.000    0.000 sampler.py:227(__iter__)
    22/11    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
       49    0.000    0.000    0.000    0.000 threading.py:1038(_wait_for_tstate_lock)
       11    0.000    0.000    0.000    0.000 {built-in method torch._ops.profiler._record_function_enter}
       72    0.000    0.000    0.000    0.000 threading.py:255(_is_owned)
      209    0.000    0.000    0.000    0.000 {built-in method builtins.len}
       11    0.000    0.000    0.000    0.000 fetching.py:287(apply_profiler)
       60    0.000    0.000    0.000    0.000 threading.py:243(__exit__)
       60    0.000    0.000    0.000    0.000 threading.py:240(__enter__)
       59    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       74    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
       49    0.000    0.000    0.000    0.000 threading.py:249(_release_save)
       60    0.000    0.000    0.000    0.000 {method 'release' of '_thread.lock' objects}
       11    0.000    0.000    0.000    0.000 base.py:68(profile)
       74    0.000    0.000    0.000    0.000 process.py:90(_check_closed)
       11    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       11    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
       48    0.000    0.000    0.000    0.000 {method 'remove' of 'collections.deque' objects}
       49    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}
       60    0.000    0.000    0.000    0.000 {method 'append' of 'collections.deque' objects}
       49    0.000    0.000    0.000    0.000 threading.py:507(is_set)
       60    0.000    0.000    0.000    0.000 {method '__enter__' of '_thread.lock' objects}
       11    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       60    0.000    0.000    0.000    0.000 {method '__exit__' of '_thread.lock' objects}
       12    0.000    0.000    0.000    0.000 queue.py:216(_get)
       44    0.000    0.000    0.000    0.000 sampler.py:112(__iter__)
       44    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        1    0.000    0.000    0.000    0.000 abc.py:141(__subclasscheck__)
        1    0.000    0.000    0.000    0.000 {built-in method _abc._abc_subclasscheck}
       11    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
       11    0.000    0.000    0.000    0.000 supporters.py:533(loader_iters)
       11    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       12    0.000    0.000    0.000    0.000 {method 'popleft' of 'collections.deque' objects}
        1    0.000    0.000    0.000    0.000 _collections_abc.py:271(__subclasshook__)
       11    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 _collections_abc.py:72(_check_methods)
        3    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}



Profile stats for: training_batch_to_device
         7112 function calls (6762 primitive calls) in 0.021 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.000    0.000    0.020    0.002 accelerator.py:192(batch_to_device)
       10    0.000    0.000    0.020    0.002 lightning.py:284(_apply_batch_transfer_handler)
       10    0.000    0.000    0.017    0.002 hooks.py:652(transfer_batch_to_device)
       10    0.000    0.000    0.017    0.002 apply_func.py:241(move_data_to_device)
   350/10    0.004    0.000    0.017    0.002 apply_func.py:66(apply_to_collection)
     1740    0.003    0.000    0.007    0.000 {built-in method builtins.isinstance}
      990    0.002    0.000    0.005    0.000 abc.py:137(__instancecheck__)
       30    0.000    0.000    0.004    0.000 apply_func.py:258(batch_to)
       30    0.004    0.000    0.004    0.000 {method 'to' of 'torch._C._TensorBase' objects}
      990    0.002    0.000    0.003    0.000 {built-in method _abc._abc_instancecheck}
       10    0.000    0.000    0.003    0.000 signature_utils.py:18(is_param_in_hook_signature)
       10    0.000    0.000    0.002    0.000 inspect.py:3081(signature)
       10    0.000    0.000    0.002    0.000 inspect.py:2829(from_callable)
    20/10    0.000    0.000    0.002    0.000 inspect.py:2198(_signature_from_callable)
      245    0.000    0.000    0.001    0.000 abc.py:141(__subclasscheck__)
      240    0.001    0.000    0.001    0.000 apply_func.py:61(_is_dataclass_instance)
       10    0.000    0.000    0.001    0.000 inspect.py:2117(_signature_from_function)
      245    0.001    0.000    0.001    0.000 {built-in method _abc._abc_subclasscheck}
      300    0.001    0.000    0.001    0.000 apply_func.py:56(_is_namedtuple)
      240    0.000    0.000    0.001    0.000 dataclasses.py:1017(is_dataclass)
       20    0.000    0.000    0.001    0.000 inspect.py:2750(__init__)
       40    0.000    0.000    0.000    0.000 inspect.py:2467(__init__)
       10    0.000    0.000    0.000    0.000 inspect.py:1799(_signature_bound_method)
       10    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
      380    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
       10    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
       10    0.000    0.000    0.000    0.000 inspect.py:2843(replace)
      240    0.000    0.000    0.000    0.000 _collections_abc.py:302(__subclasshook__)
      250    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       10    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       10    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
       40    0.000    0.000    0.000    0.000 enum.py:284(__call__)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       50    0.000    0.000    0.000    0.000 inspect.py:2799(<genexpr>)
       10    0.000    0.000    0.000    0.000 inspect.py:484(unwrap)
       10    0.000    0.000    0.000    0.000 base.py:68(profile)
       60    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       10    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       10    0.000    0.000    0.000    0.000 accelerator.py:180(root_device)
       20    0.000    0.000    0.000    0.000 inspect.py:158(isfunction)
       70    0.000    0.000    0.000    0.000 inspect.py:2517(name)
       50    0.000    0.000    0.000    0.000 inspect.py:2529(kind)
       40    0.000    0.000    0.000    0.000 enum.py:526(__new__)
       40    0.000    0.000    0.000    0.000 {method 'isidentifier' of 'str' objects}
       10    0.000    0.000    0.000    0.000 inspect.py:504(_is_wrapper)
        4    0.000    0.000    0.000    0.000 apply_func.py:233(__subclasshook__)
       10    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
       30    0.000    0.000    0.000    0.000 inspect.py:2521(default)
       10    0.000    0.000    0.000    0.000 {method 'values' of 'mappingproxy' objects}
       24    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        4    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       20    0.000    0.000    0.000    0.000 inspect.py:2835(parameters)
       20    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
       10    0.000    0.000    0.000    0.000 single_device.py:63(root_device)
       10    0.000    0.000    0.000    0.000 base.py:54(trainer)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.id}
       10    0.000    0.000    0.000    0.000 hooks.py:744(on_after_batch_transfer)
       10    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}
       10    0.000    0.000    0.000    0.000 hooks.py:709(on_before_batch_transfer)
       10    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_batch_start
         760 function calls in 0.002 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.000    0.000    0.001    0.000 callback_hook.py:155(on_batch_start)
       60    0.000    0.000    0.001    0.000 trainer.py:1682(lightning_module)
       60    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
       60    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
       60    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
      120    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       20    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       60    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
       10    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
       10    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       70    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
       10    0.000    0.000    0.000    0.000 base.py:68(profile)
       60    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       60    0.000    0.000    0.000    0.000 base.py:168(on_batch_start)
       10    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       10    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
       10    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
       20    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
       10    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       10    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       10    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_batch_start
         6910 function calls (6850 primitive calls) in 0.016 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.000    0.000    0.015    0.002 callback_hook.py:166(on_train_batch_start)
       60    0.000    0.000    0.014    0.000 signature_utils.py:18(is_param_in_hook_signature)
       60    0.000    0.000    0.013    0.000 inspect.py:3081(signature)
       60    0.000    0.000    0.013    0.000 inspect.py:2829(from_callable)
   120/60    0.001    0.000    0.013    0.000 inspect.py:2198(_signature_from_callable)
       60    0.002    0.000    0.008    0.000 inspect.py:2117(_signature_from_function)
      120    0.002    0.000    0.004    0.000 inspect.py:2750(__init__)
      360    0.002    0.000    0.003    0.000 inspect.py:2467(__init__)
       60    0.001    0.000    0.003    0.000 inspect.py:1799(_signature_bound_method)
       60    0.000    0.000    0.002    0.000 inspect.py:2843(replace)
       60    0.000    0.000    0.001    0.000 trainer.py:1682(lightning_module)
      360    0.001    0.000    0.001    0.000 enum.py:284(__call__)
      420    0.001    0.000    0.001    0.000 inspect.py:2799(<genexpr>)
      840    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
       60    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
       60    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
       60    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
       60    0.000    0.000    0.001    0.000 inspect.py:484(unwrap)
      660    0.001    0.000    0.001    0.000 inspect.py:2517(name)
      420    0.000    0.000    0.000    0.000 inspect.py:2529(kind)
      430    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      360    0.000    0.000    0.000    0.000 enum.py:526(__new__)
      360    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
      120    0.000    0.000    0.000    0.000 inspect.py:158(isfunction)
      360    0.000    0.000    0.000    0.000 {method 'isidentifier' of 'str' objects}
      300    0.000    0.000    0.000    0.000 inspect.py:2521(default)
       60    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
       60    0.000    0.000    0.000    0.000 inspect.py:504(_is_wrapper)
       10    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
      140    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
      120    0.000    0.000    0.000    0.000 inspect.py:2835(parameters)
       80    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       60    0.000    0.000    0.000    0.000 {built-in method builtins.len}
       10    0.000    0.000    0.000    0.000 base.py:68(profile)
       60    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       70    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       20    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
       60    0.000    0.000    0.000    0.000 {method 'values' of 'mappingproxy' objects}
       10    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       60    0.000    0.000    0.000    0.000 base.py:99(on_train_batch_start)
       60    0.000    0.000    0.000    0.000 {built-in method builtins.id}
       60    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}
       30    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       10    0.000    0.000    0.000    0.000 hooks.py:82(on_train_batch_start)
       10    0.000    0.000    0.000    0.000 training_type_plugin.py:363(on_train_batch_start)
       10    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: run_training_batch
         1414 function calls (1404 primitive calls) in 13.573 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    20/10    0.000    0.000   13.573    1.357 base.py:109(run)
       10    0.000    0.000   13.572    1.357 training_batch_loop.py:72(advance)
       10    0.000    0.000   13.571    1.357 optimizer_loop.py:214(advance)
       10    0.000    0.000   13.571    1.357 optimizer_loop.py:231(_run_optimization)
       10    0.000    0.000   13.570    1.357 optimizer_loop.py:353(_optimizer_step)
       10    0.000    0.000   13.568    1.357 lightning.py:1571(optimizer_step)
       10    0.000    0.000   13.568    1.357 optimizer.py:95(step)
       10    0.000    0.000   13.568    1.357 contextlib.py:107(__enter__)
       10    0.000    0.000   13.568    1.357 {built-in method builtins.next}
       10    0.000    0.000   13.568    1.357 base.py:68(profile)
       10    0.000    0.000   13.568    1.357 advanced.py:61(start)
       10   13.568    1.357   13.568    1.357 {method 'enable' of '_lsprof.Profiler' objects}
       10    0.000    0.000    0.001    0.000 optimizer.py:63(_to_lightning_optimizer)
       30    0.000    0.000    0.001    0.000 trainer.py:1682(lightning_module)
       10    0.000    0.000    0.001    0.000 optimizer_loop.py:283(_make_closure)
       30    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
       10    0.000    0.000    0.000    0.000 training_batch_loop.py:62(on_run_start)
       30    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
       10    0.000    0.000    0.000    0.000 trainer.py:1792(lightning_optimizers)
        1    0.000    0.000    0.000    0.000 optimizers.py:112(convert_to_lightning_optimizers)
       30    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
      121    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       10    0.000    0.000    0.000    0.000 training_batch_loop.py:108(_tbptt_split_batch)
       10    0.000    0.000    0.000    0.000 fit_loop.py:265(_should_accumulate)
       20    0.000    0.000    0.000    0.000 trainer.py:1715(amp_backend)
       10    0.000    0.000    0.000    0.000 training_epoch_loop.py:356(_should_accumulate)
       10    0.000    0.000    0.000    0.000 enums.py:30(__eq__)
      180    0.000    0.000    0.000    0.000 base.py:54(trainer)
       20    0.000    0.000    0.000    0.000 accelerator.py:369(amp_backend)
       30    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
      102    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        1    0.000    0.000    0.000    0.000 optimizers.py:119(<dictcomp>)
       10    0.000    0.000    0.000    0.000 optimizer_loop.py:206(on_run_start)
        1    0.000    0.000    0.000    0.000 optimizers.py:113(_convert_to_lightning_optimizer)
       10    0.000    0.000    0.000    0.000 optimizer_loop.py:127(__init__)
       10    0.000    0.000    0.000    0.000 optimizer_loop.py:335(_run_optimization_start)
        1    0.000    0.000    0.000    0.000 optimizer.py:33(__init__)
       10    0.000    0.000    0.000    0.000 typing.py:806(__new__)
       20    0.000    0.000    0.000    0.000 base.py:174(on_advance_start)
       10    0.000    0.000    0.000    0.000 contextlib.py:237(helper)
       20    0.000    0.000    0.000    0.000 types.py:164(__get__)
       10    0.000    0.000    0.000    0.000 trainer.py:2037(current_epoch)
       20    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
       22    0.000    0.000    0.000    0.000 trainer.py:1686(optimizers)
       10    0.000    0.000    0.000    0.000 training_epoch_loop.py:343(_num_ready_batches_reached)
       20    0.000    0.000    0.000    0.000 optimizer_loop.py:190(done)
       10    0.000    0.000    0.000    0.000 contextlib.py:81(__init__)
       10    0.000    0.000    0.000    0.000 optimizer_loop.py:298(_make_zero_grad_fn)
       30    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       10    0.000    0.000    0.000    0.000 closure.py:60(__init__)
       10    0.000    0.000    0.000    0.000 training_epoch_loop.py:339(_accumulated_batches_reached)
       40    0.000    0.000    0.000    0.000 {built-in method builtins.len}
       10    0.000    0.000    0.000    0.000 optimizer_loop.py:198(reset)
       40    0.000    0.000    0.000    0.000 utils.py:51(void)
       10    0.000    0.000    0.000    0.000 optimizer_loop.py:317(_make_backward_fn)
       10    0.000    0.000    0.000    0.000 training_batch_loop.py:45(done)
       20    0.000    0.000    0.000    0.000 enum.py:628(value)
       20    0.000    0.000    0.000    0.000 trainer.py:2061(fit_loop)
       10    0.000    0.000    0.000    0.000 trainer.py:1707(optimizer_frequencies)
       10    0.000    0.000    0.000    0.000 utilities.py:151(_get_active_optimizers)
       10    0.000    0.000    0.000    0.000 progress.py:126(increment_ready)
       10    0.000    0.000    0.000    0.000 logger_connector.py:214(on_train_split_start)
       10    0.000    0.000    0.000    0.000 training_batch_loop.py:58(reset)
       10    0.000    0.000    0.000    0.000 optimizer_loop.py:294(_make_step_fn)
       10    0.000    0.000    0.000    0.000 fit_loop.py:55(current_epoch)
       20    0.000    0.000    0.000    0.000 base.py:84(skip)
       10    0.000    0.000    0.000    0.000 {method 'pop' of 'list' objects}
       10    0.000    0.000    0.000    0.000 trainer.py:1646(_device_type)
        1    0.000    0.000    0.000    0.000 optimizer.py:36(<dictcomp>)
       20    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
       20    0.000    0.000    0.000    0.000 training_type_plugin.py:276(handles_gradient_accumulation)
       10    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x561a1dcdf3c0}
       10    0.000    0.000    0.000    0.000 lightning.py:265(truncated_bptt_steps)
       10    0.000    0.000    0.000    0.000 lightning.py:256(automatic_optimization)
       10    0.000    0.000    0.000    0.000 optimizer_loop.py:186(optimizer_idx)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       10    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 optimizer.py:56(_on_trainer_init)
        1    0.000    0.000    0.000    0.000 {built-in method _weakref.proxy}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}



Profile stats for: optimizer_step_with_closure_0
         400 function calls in 13.538 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.000    0.000   13.538    1.354 accelerator.py:318(optimizer_step)
       10    0.000    0.000   13.537    1.354 precision_plugin.py:152(optimizer_step)
       10    0.000    0.000   13.537    1.354 optimizer.py:83(wrapper)
       10    0.000    0.000   13.536    1.354 grad_mode.py:25(decorate_context)
       10    0.000    0.000   13.536    1.354 adam.py:81(step)
       10    0.000    0.000   13.536    1.354 precision_plugin.py:135(_wrap_closure)
       10    0.000    0.000   13.536    1.354 optimizer_loop.py:159(__call__)
       10    0.000    0.000   13.536    1.354 optimizer_loop.py:140(closure)
       10    0.000    0.000   13.536    1.354 contextlib.py:107(__enter__)
       10    0.000    0.000   13.536    1.354 {built-in method builtins.next}
       10    0.000    0.000   13.536    1.354 base.py:68(profile)
       10    0.000    0.000   13.536    1.354 advanced.py:61(start)
       10   13.536    1.354   13.536    1.354 {method 'enable' of '_lsprof.Profiler' objects}
       10    0.000    0.000    0.000    0.000 profiler.py:434(__enter__)
       10    0.000    0.000    0.000    0.000 profiler.py:426(__init__)
       10    0.000    0.000    0.000    0.000 {built-in method zeros}
       10    0.000    0.000    0.000    0.000 {built-in method torch._ops.profiler._record_function_enter}
       10    0.000    0.000    0.000    0.000 grad_mode.py:124(__enter__)
       10    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
       10    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
       10    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       10    0.000    0.000    0.000    0.000 grad_mode.py:119(__init__)
       10    0.000    0.000    0.000    0.000 grad_mode.py:213(__init__)
       30    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       10    0.000    0.000    0.000    0.000 contextlib.py:237(helper)
       10    0.000    0.000    0.000    0.000 grad_mode.py:167(__enter__)
       10    0.000    0.000    0.000    0.000 contextlib.py:81(__init__)
       30    0.000    0.000    0.000    0.000 {built-in method torch._C.is_grad_enabled}
       10    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
       20    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
       10    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
       10    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       10    0.000    0.000    0.000    0.000 _jit_internal.py:957(is_scripting)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       10    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)



Profile stats for: training_step_and_backward
         200 function calls in 13.513 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.000    0.000   13.513    1.351 optimizer_loop.py:412(_training_step)
       10    0.000    0.000   13.513    1.351 contextlib.py:107(__enter__)
       10    0.000    0.000   13.512    1.351 {built-in method builtins.next}
       10    0.000    0.000   13.512    1.351 base.py:68(profile)
       10    0.000    0.000   13.512    1.351 advanced.py:61(start)
       10   13.512    1.351   13.512    1.351 {method 'enable' of '_lsprof.Profiler' objects}
       10    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
       10    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
       10    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
       10    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       10    0.000    0.000    0.000    0.000 contextlib.py:237(helper)
       10    0.000    0.000    0.000    0.000 contextlib.py:81(__init__)
       10    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
       20    0.000    0.000    0.000    0.000 base.py:54(trainer)
       10    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       10    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}



Profile stats for: model_forward
         860 function calls (850 primitive calls) in 13.464 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.000    0.000   13.462    1.346 contextlib.py:107(__enter__)
       10    0.000    0.000   13.462    1.346 {built-in method builtins.next}
       10    0.000    0.000   13.462    1.346 base.py:68(profile)
       10    0.000    0.000   13.462    1.346 advanced.py:61(start)
       10   13.462    1.346   13.462    1.346 {method 'enable' of '_lsprof.Profiler' objects}
       10    0.000    0.000    0.002    0.000 utilities.py:65(_build_training_step_kwargs)
       10    0.000    0.000    0.002    0.000 signature_utils.py:18(is_param_in_hook_signature)
       10    0.000    0.000    0.002    0.000 inspect.py:3081(signature)
       10    0.000    0.000    0.002    0.000 inspect.py:2829(from_callable)
    20/10    0.000    0.000    0.002    0.000 inspect.py:2198(_signature_from_callable)
       10    0.000    0.000    0.001    0.000 inspect.py:2117(_signature_from_function)
       10    0.000    0.000    0.000    0.000 inspect.py:1799(_signature_bound_method)
       20    0.000    0.000    0.000    0.000 inspect.py:2750(__init__)
       30    0.000    0.000    0.000    0.000 inspect.py:2467(__init__)
       10    0.000    0.000    0.000    0.000 inspect.py:2843(replace)
       10    0.000    0.000    0.000    0.000 module.py:1180(__setattr__)
       30    0.000    0.000    0.000    0.000 enum.py:284(__call__)
       10    0.000    0.000    0.000    0.000 inspect.py:484(unwrap)
      100    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       40    0.000    0.000    0.000    0.000 inspect.py:2799(<genexpr>)
       70    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       10    0.000    0.000    0.000    0.000 contextlib.py:237(helper)
       20    0.000    0.000    0.000    0.000 inspect.py:158(isfunction)
       30    0.000    0.000    0.000    0.000 enum.py:526(__new__)
       10    0.000    0.000    0.000    0.000 contextlib.py:81(__init__)
       10    0.000    0.000    0.000    0.000 trainer.py:1686(optimizers)
       50    0.000    0.000    0.000    0.000 inspect.py:2517(name)
       40    0.000    0.000    0.000    0.000 inspect.py:2529(kind)
       20    0.000    0.000    0.000    0.000 inspect.py:2835(parameters)
       10    0.000    0.000    0.000    0.000 inspect.py:504(_is_wrapper)
       30    0.000    0.000    0.000    0.000 {method 'isidentifier' of 'str' objects}
       30    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
       20    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       20    0.000    0.000    0.000    0.000 base.py:54(trainer)
       10    0.000    0.000    0.000    0.000 {method 'values' of 'mappingproxy' objects}
       20    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
       20    0.000    0.000    0.000    0.000 inspect.py:2521(default)
       10    0.000    0.000    0.000    0.000 lightning.py:265(truncated_bptt_steps)
       10    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}
       10    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       10    0.000    0.000    0.000    0.000 {built-in method builtins.id}
       10    0.000    0.000    0.000    0.000 {built-in method builtins.len}
       10    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)



Profile stats for: training_step
         107946 function calls (95455 primitive calls) in 13.458 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.000    0.000   13.459    1.346 accelerator.py:210(training_step)
       10    0.000    0.000   13.458    1.346 training_type_plugin.py:212(training_step)
       10    0.000    0.000   13.458    1.346 deepmil.py:262(training_step)
       10    0.002    0.000   13.245    1.324 deepmil.py:222(_shared_step)
       10    0.004    0.000   12.284    1.228 deepmil.py:187(compute_bag_labels_logits_and_attn_maps)
  3420/60    0.025    0.000   12.280    0.205 module.py:1096(_call_impl)
       40    0.002    0.000   12.274    0.307 deepmil.py:172(forward)
       40    0.001    0.000   12.096    0.302 encoders.py:51(forward)
       40    0.000    0.000    9.346    0.234 resnet.py:248(forward)
       40    0.003    0.000    9.346    0.234 resnet.py:230(_forward_impl)
      800    0.006    0.000    9.080    0.011 conv.py:445(forward)
      800    0.004    0.000    9.071    0.011 conv.py:437(_conv_forward)
      800    9.067    0.011    9.067    0.011 {built-in method conv2d}
       40    0.001    0.000    2.747    0.069 transforms.py:218(forward)
       40    0.006    0.000    2.746    0.069 functional.py:311(normalize)
       80    2.710    0.034    2.710    0.034 {built-in method as_tensor}
  320/200    0.004    0.000    1.188    0.006 container.py:139(forward)
      320    0.023    0.000    1.029    0.003 resnet.py:67(forward)
      160    0.001    0.000    0.959    0.006 metric.py:251(wrapped_func)
       30    0.003    0.000    0.911    0.030 accuracy.py:218(update)
       80    0.007    0.000    0.881    0.011 checks.py:190(_check_classification_inputs)
       30    0.000    0.000    0.867    0.029 accuracy.py:29(_mode)
       80    0.860    0.011    0.863    0.011 checks.py:29(_basic_input_validation)
      110    0.004    0.000    0.205    0.002 lightning.py:324(log)
       10    0.002    0.000    0.168    0.017 deepmil.py:158(log_metrics)
      100    0.001    0.000    0.164    0.002 logging.py:307(log_on_epoch)
      120    0.001    0.000    0.162    0.001 linear.py:102(forward)
       40    0.001    0.000    0.161    0.004 attention_layers.py:60(forward)
      120    0.002    0.000    0.161    0.001 functional.py:1832(linear)
      100    0.001    0.000    0.160    0.002 lightning.py:501(log_dict)
      120    0.154    0.001    0.154    0.001 {built-in method torch._C._nn.linear}
      800    0.046    0.000    0.154    0.000 batchnorm.py:134(forward)
      110    0.003    0.000    0.134    0.001 result.py:424(log)
 1108/452    0.011    0.000    0.093    0.000 apply_func.py:66(apply_to_collection)
      800    0.009    0.000    0.078    0.000 functional.py:2251(batch_norm)
       11    0.000    0.000    0.074    0.007 result.py:488(register_key)
       11    0.000    0.000    0.074    0.007 result.py:494(fn)
       11    0.000    0.000    0.060    0.005 result.py:324(to)
      800    0.056    0.000    0.056    0.000 {built-in method batch_norm}
11648/11608    0.017    0.000    0.050    0.000 {built-in method builtins.isinstance}
       30    0.000    0.000    0.039    0.001 accuracy.py:64(_accuracy_update)
       50    0.002    0.000    0.037    0.001 checks.py:296(_input_format_classification)
       30    0.000    0.000    0.037    0.001 stat_scores.py:76(_stat_scores_update)
      680    0.003    0.000    0.034    0.000 activation.py:97(forward)
     3119    0.006    0.000    0.032    0.000 abc.py:137(__instancecheck__)
      680    0.003    0.000    0.032    0.000 functional.py:1288(relu)
      110    0.001    0.000    0.031    0.000 result.py:503(update_metrics)
      110    0.001    0.000    0.030    0.000 apply_func.py:153(apply_to_collections)
      110    0.001    0.000    0.029    0.000 result.py:504(fn)
      680    0.028    0.000    0.028    0.000 {built-in method relu_}
   850/36    0.005    0.000    0.027    0.001 copy.py:132(deepcopy)
       10    0.000    0.000    0.027    0.003 confusion_matrix.py:124(update)
     3119    0.004    0.000    0.026    0.000 {built-in method _abc._abc_instancecheck}
       10    0.002    0.000    0.026    0.003 confusion_matrix.py:24(_confusion_matrix_update)
     1294    0.018    0.000    0.026    0.000 module.py:1180(__setattr__)
      121    0.000    0.000    0.023    0.000 inspect.py:3081(signature)
      121    0.000    0.000    0.023    0.000 inspect.py:2829(from_callable)
  242/121    0.003    0.000    0.022    0.000 inspect.py:2198(_signature_from_callable)
 3389/141    0.006    0.000    0.022    0.000 abc.py:141(__subclasscheck__)
 3389/141    0.015    0.000    0.022    0.000 {built-in method _abc._abc_subclasscheck}
      110    0.001    0.000    0.021    0.000 signature_utils.py:18(is_param_in_hook_signature)
     9650    0.020    0.000    0.020    0.000 module.py:1164(__getattr__)
       40    0.018    0.000    0.018    0.000 {method 'div_' of 'torch._C._TensorBase' objects}
       10    0.016    0.002    0.016    0.002 {built-in method bincount}
      101    0.000    0.000    0.016    0.000 distributed.py:46(wrapped_fn)
        1    0.001    0.001    0.016    0.016 lightning.py:453(<dictcomp>)
       40    0.000    0.000    0.016    0.000 module.py:795(to)
      111    0.001    0.000    0.016    0.000 {built-in method _warnings.warn}
    33/22    0.000    0.000    0.016    0.001 copy.py:268(_reconstruct)
      101    0.000    0.000    0.015    0.000 warnings.py:25(rank_zero_warn)
       40    0.002    0.000    0.015    0.000 metric.py:466(_apply)
      110    0.000    0.000    0.015    0.000 result.py:405(_extract_batch_size)
      101    0.000    0.000    0.015    0.000 warnings.py:21(_warn)
       10    0.000    0.000    0.015    0.001 data.py:48(extract_batch_size)
        3    0.000    0.000    0.014    0.005 warnings.py:96(_showwarnmsg)
        3    0.000    0.000    0.014    0.005 warnings.py:20(_showwarnmsg_impl)
        3    0.000    0.000    0.014    0.005 warnings.py:117(_formatwarnmsg)
        3    0.000    0.000    0.014    0.005 warnings.py:35(_formatwarnmsg_impl)
    44/22    0.001    0.000    0.014    0.001 copy.py:236(_deepcopy_dict)
        3    0.000    0.000    0.014    0.005 linecache.py:15(getline)
        3    0.000    0.000    0.014    0.005 linecache.py:37(getlines)
        3    0.000    0.000    0.014    0.005 linecache.py:82(updatecache)
       11    0.000    0.000    0.014    0.001 result.py:205(__init__)
       10    0.000    0.000    0.013    0.001 warnings.py:41(warn)
        3    0.000    0.000    0.013    0.004 tokenize.py:443(open)
      121    0.004    0.000    0.013    0.000 inspect.py:2117(_signature_from_function)
        3    0.000    0.000    0.013    0.004 tokenize.py:350(detect_encoding)
        6    0.000    0.000    0.012    0.002 tokenize.py:374(read_or_stop)
        6    0.012    0.002    0.012    0.002 {method 'readline' of '_io.BufferedReader' objects}
      110    0.000    0.000    0.012    0.000 result.py:263(forward)
       30    0.007    0.000    0.012    0.000 stat_scores.py:28(_stat_scores)
      110    0.006    0.000    0.011    0.000 result.py:216(update)
       11    0.001    0.000    0.010    0.001 metric.py:75(__init__)
      493    0.002    0.000    0.009    0.000 metric.py:421(__setattr__)
       50    0.001    0.000    0.009    0.000 data.py:91(select_topk)
      495    0.008    0.000    0.008    0.000 copy.py:190(_deepcopy_atomic)
       33    0.000    0.000    0.008    0.000 {method '__reduce_ex__' of 'object' objects}
       11    0.000    0.000    0.008    0.001 result.py:182(__getstate__)
       50    0.001    0.000    0.008    0.000 data.py:57(to_onehot)
     3430    0.008    0.000    0.008    0.000 {built-in method torch._C._get_tracing_state}
      330    0.001    0.000    0.007    0.000 trainer.py:1959(training)
       10    0.000    0.000    0.007    0.001 auroc.py:159(update)
      110    0.001    0.000    0.007    0.000 trainer.py:2153(_results)
       10    0.000    0.000    0.006    0.001 auroc.py:27(_auroc_update)
       11    0.000    0.000    0.006    0.001 dataclasses.py:1023(asdict)
     5940    0.006    0.000    0.006    0.000 {method 'get' of 'dict' objects}
   198/11    0.002    0.000    0.006    0.001 dataclasses.py:1047(_asdict_inner)
      838    0.002    0.000    0.006    0.000 apply_func.py:61(_is_dataclass_instance)
      330    0.003    0.000    0.006    0.000 enums.py:30(__eq__)
   560/98    0.003    0.000    0.006    0.000 module.py:1653(named_modules)
      930    0.005    0.000    0.005    0.000 {built-in method torch._C._has_torch_function_variadic}
       40    0.005    0.000    0.005    0.000 {method 'any' of 'torch._C._TensorBase' objects}
       60    0.003    0.000    0.005    0.000 checks.py:127(_check_num_classes_mc)
      130    0.005    0.000    0.005    0.000 {method 'sum' of 'torch._C._TensorBase' objects}
      800    0.004    0.000    0.005    0.000 functional.py:2234(_verify_batch_size)
      280    0.002    0.000    0.005    0.000 enums.py:38(__eq__)
       40    0.000    0.000    0.005    0.000 pooling.py:1166(forward)
      140    0.005    0.000    0.005    0.000 {method 'max' of 'torch._C._TensorBase' objects}
      242    0.003    0.000    0.005    0.000 inspect.py:2750(__init__)
       50    0.000    0.000    0.005    0.000 functional.py:1650(softmax)
       40    0.000    0.000    0.005    0.000 functional.py:1117(adaptive_avg_pool2d)
      363    0.002    0.000    0.004    0.000 inspect.py:2467(__init__)
      121    0.001    0.000    0.004    0.000 inspect.py:1799(_signature_bound_method)
      510    0.002    0.000    0.004    0.000 module.py:893(convert)
      838    0.002    0.000    0.004    0.000 dataclasses.py:1017(is_dataclass)
      350    0.004    0.000    0.004    0.000 {method 'view' of 'torch._C._TensorBase' objects}
     1200    0.003    0.000    0.004    0.000 types.py:164(__get__)
      110    0.001    0.000    0.004    0.000 memory.py:41(recursive_detach)
      511    0.001    0.000    0.004    0.000 {built-in method builtins.setattr}
       11    0.000    0.000    0.004    0.000 imports.py:42(_compare_version)
      800    0.002    0.000    0.004    0.000 batchnorm.py:406(_check_input_dim)
       10    0.000    0.000    0.004    0.000 loss.py:1149(forward)
       10    0.000    0.000    0.003    0.000 functional.py:2767(cross_entropy)
      110    0.000    0.000    0.003    0.000 trainer.py:2128(_active_loop)
      800    0.002    0.000    0.003    0.000 __init__.py:31(__get__)
       14    0.000    0.000    0.003    0.000 metric.py:114(add_state)
       10    0.003    0.000    0.003    0.000 {built-in method torch._C._nn.cross_entropy_loss}
       40    0.000    0.000    0.003    0.000 pooling.py:161(forward)
       40    0.003    0.000    0.003    0.000 {method 'sub_' of 'torch._C._TensorBase' objects}
       50    0.003    0.000    0.003    0.000 {method 'softmax' of 'torch._C._TensorBase' objects}
       50    0.003    0.000    0.003    0.000 {method 'scatter' of 'torch._C._TensorBase' objects}
       90    0.003    0.000    0.003    0.000 {built-in method zeros}
       80    0.003    0.000    0.003    0.000 {method 'min' of 'torch._C._TensorBase' objects}
       40    0.003    0.000    0.003    0.000 {built-in method torch._C._nn.adaptive_avg_pool2d}
      200    0.003    0.000    0.003    0.000 {method 'int' of 'torch._C._TensorBase' objects}
       40    0.000    0.000    0.003    0.000 _jit_internal.py:412(fn)
     1370    0.002    0.000    0.003    0.000 {built-in method builtins.hasattr}
      121    0.001    0.000    0.003    0.000 <string>:1(__init__)
       40    0.003    0.000    0.003    0.000 {method 'float' of 'torch._C._TensorBase' objects}
      110    0.001    0.000    0.003    0.000 fit_loop.py:142(_results)
       70    0.003    0.000    0.003    0.000 {method 'mean' of 'torch._C._TensorBase' objects}
      320    0.002    0.000    0.003    0.000 container.py:131(__iter__)
      618    0.003    0.000    0.003    0.000 {method 'to' of 'torch._C._TensorBase' objects}
       40    0.000    0.000    0.003    0.000 activation.py:348(forward)
      864    0.003    0.000    0.003    0.000 {method 'size' of 'torch._C._TensorBase' objects}
      838    0.002    0.000    0.003    0.000 apply_func.py:56(_is_namedtuple)
       40    0.000    0.000    0.003    0.000 functional.py:697(_max_pool2d)
       14    0.001    0.000    0.003    0.000 _tensor.py:81(__deepcopy__)
       40    0.002    0.000    0.002    0.000 {built-in method mm}
      121    0.000    0.000    0.002    0.000 inspect.py:2843(replace)
       40    0.002    0.000    0.002    0.000 {built-in method tanh}
      242    0.002    0.000    0.002    0.000 result.py:90(_generate_sync_fn)
       40    0.002    0.000    0.002    0.000 {built-in method max_pool2d}
       10    0.002    0.000    0.002    0.000 {built-in method argmax}
      121    0.000    0.000    0.002    0.000 result.py:121(__post_init__)
       50    0.002    0.000    0.002    0.000 {method 'clone' of 'torch._C._TensorBase' objects}
       50    0.002    0.000    0.002    0.000 {method 'scatter_' of 'torch._C._TensorBase' objects}
       50    0.002    0.000    0.002    0.000 {built-in method zeros_like}
       70    0.002    0.000    0.002    0.000 {method 'argmax' of 'torch._C._TensorBase' objects}
       30    0.001    0.000    0.002    0.000 metric.py:560(__hash__)
      180    0.002    0.000    0.002    0.000 {method 'long' of 'torch._C._TensorBase' objects}
       22    0.001    0.000    0.002    0.000 version.py:261(__init__)
      260    0.002    0.000    0.002    0.000 {method 'squeeze' of 'torch._C._TensorBase' objects}
      121    0.001    0.000    0.002    0.000 result.py:126(_parse_reduce_fx)
       28    0.000    0.000    0.002    0.000 apply_func.py:241(move_data_to_device)
     1325    0.002    0.000    0.002    0.000 {built-in method builtins.getattr}
       20    0.002    0.000    0.002    0.000 {built-in method stack}
      132    0.000    0.000    0.002    0.000 result.py:57(__post_init__)
       10    0.000    0.000    0.002    0.000 activation.py:1225(forward)
      110    0.000    0.000    0.002    0.000 result.py:147(sync)
     1626    0.002    0.000    0.002    0.000 {built-in method builtins.id}
      959    0.002    0.000    0.002    0.000 result.py:291(__setattr__)
   210/70    0.001    0.000    0.002    0.000 data.py:30(_extract_batch_size)
       40    0.000    0.000    0.002    0.000 module.py:568(_apply)
       80    0.000    0.000    0.002    0.000 checks.py:284(_input_squeeze)
      363    0.001    0.000    0.002    0.000 enum.py:284(__call__)
      820    0.002    0.000    0.002    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
      840    0.001    0.000    0.001    0.000 {method 'is_floating_point' of 'torch._C._TensorBase' objects}
       11    0.000    0.000    0.001    0.000 __init__.py:109(import_module)
       44    0.001    0.000    0.001    0.000 dataclasses.py:994(fields)
       70    0.000    0.000    0.001    0.000 memory.py:56(detach_and_move)
      121    0.001    0.000    0.001    0.000 inspect.py:484(unwrap)
     1013    0.001    0.000    0.001    0.000 {built-in method builtins.len}
      484    0.001    0.000    0.001    0.000 inspect.py:2799(<genexpr>)
     1200    0.001    0.000    0.001    0.000 enum.py:628(value)
      100    0.000    0.000    0.001    0.000 logging.py:341(<dictcomp>)
       11    0.000    0.000    0.001    0.000 <frozen importlib._bootstrap>:994(_gcd_import)
       28    0.000    0.000    0.001    0.000 apply_func.py:258(batch_to)
     1300    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
      110    0.001    0.000    0.001    0.000 fx_validator.py:202(check_logging_and_get_default_levels)
       22    0.000    0.000    0.001    0.000 dataclasses.py:1205(replace)
     1230    0.001    0.000    0.001    0.000 {method 'lower' of 'str' objects}
       11    0.000    0.000    0.001    0.000 <frozen importlib._bootstrap>:978(_find_and_load)
       40    0.000    0.000    0.001    0.000 module.py:1597(children)
       70    0.001    0.000    0.001    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
      800    0.001    0.000    0.001    0.000 {built-in method torch._C._get_cudnn_enabled}
       10    0.000    0.000    0.001    0.000 functional.py:1611(_get_softmax_dim)
    22/11    0.000    0.000    0.001    0.000 copy.py:219(_deepcopy_tuple)
      231    0.001    0.000    0.001    0.000 dataclasses.py:1012(_is_dataclass_instance)
      110    0.000    0.000    0.001    0.000 result.py:74(op)
       98    0.000    0.000    0.001    0.000 {method 'add' of 'set' objects}
      966    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_unary}
       40    0.001    0.000    0.001    0.000 module.py:1606(named_children)
    22/11    0.000    0.000    0.001    0.000 copy.py:220(<listcomp>)
      220    0.001    0.000    0.001    0.000 trainer.py:1611(training_type_plugin)
       20    0.000    0.000    0.001    0.000 metric.py:481(<listcomp>)
       50    0.001    0.000    0.001    0.000 {method 'unsqueeze' of 'torch._C._TensorBase' objects}
      100    0.000    0.000    0.001    0.000 trainer.py:1633(world_size)
       10    0.000    0.000    0.001    0.000 metric.py:352(wrapped_func)
       80    0.001    0.000    0.001    0.000 checks.py:51(_check_shape_and_type_consistency)
       40    0.001    0.000    0.001    0.000 utils.py:30(_list_with_default)
       10    0.000    0.000    0.001    0.000 deepmil.py:335(update_results_with_data_specific_info)
       14    0.000    0.000    0.001    0.000 storage.py:44(__deepcopy__)
        3    0.001    0.000    0.001    0.000 {method 'readlines' of '_io._IOBase' objects}
    70/50    0.000    0.000    0.001    0.000 {built-in method builtins.next}
       11    0.000    0.000    0.001    0.000 device_dtype_mixin.py:26(__init__)
      110    0.001    0.000    0.001    0.000 {method 'reshape' of 'torch._C._TensorBase' objects}
       11    0.000    0.000    0.001    0.000 metric.py:250(_wrap_update)
       14    0.000    0.000    0.001    0.000 storage.py:60(clone)
       70    0.001    0.000    0.001    0.000 {built-in method is_floating_point}
       74    0.000    0.000    0.001    0.000 {built-in method builtins.hash}
      242    0.001    0.000    0.001    0.000 inspect.py:158(isfunction)
       99    0.000    0.000    0.001    0.000 <string>:1(__eq__)
       40    0.001    0.000    0.001    0.000 {built-in method flatten}
       22    0.000    0.000    0.001    0.000 functools.py:37(update_wrapper)
      102    0.000    0.000    0.001    0.000 copy.py:252(_keep_alive)
      320    0.001    0.000    0.001    0.000 {built-in method builtins.iter}
      605    0.001    0.000    0.001    0.000 inspect.py:2517(name)
       10    0.000    0.000    0.001    0.000 deepmil.py:343(<listcomp>)
       40    0.000    0.000    0.001    0.000 typing.py:707(__instancecheck__)
      118    0.000    0.000    0.001    0.000 _tensor.py:650(__hash__)
       11    0.000    0.000    0.001    0.000 module.py:250(__init__)
       40    0.001    0.000    0.001    0.000 {built-in method transpose}
      363    0.001    0.000    0.001    0.000 enum.py:526(__new__)
    30/20    0.000    0.000    0.001    0.000 contextlib.py:107(__enter__)
      510    0.001    0.000    0.001    0.000 _collections_abc.py:392(__subclasshook__)
       11    0.000    0.000    0.001    0.000 result.py:271(_wrap_compute)
    40/30    0.000    0.000    0.001    0.000 contextlib.py:116(__exit__)
       68    0.000    0.000    0.000    0.000 grad_mode.py:213(__init__)
      418    0.000    0.000    0.000    0.000 dataclasses.py:1009(<genexpr>)
      484    0.000    0.000    0.000    0.000 inspect.py:2529(kind)
       40    0.000    0.000    0.000    0.000 typing.py:710(__subclasscheck__)
      111    0.000    0.000    0.000    0.000 result.py:178(is_custom_reduction)
      415    0.000    0.000    0.000    0.000 {method 'is_complex' of 'torch._C._TensorBase' objects}
       11    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:147(__enter__)
       66    0.000    0.000    0.000    0.000 copy.py:273(<genexpr>)
       22    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:157(_get_module_lock)
      351    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
      340    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
      121    0.000    0.000    0.000    0.000 inspect.py:504(_is_wrapper)
      363    0.000    0.000    0.000    0.000 {method 'isidentifier' of 'str' objects}
       50    0.000    0.000    0.000    0.000 {method 'expand_as' of 'torch._C._TensorBase' objects}
      352    0.000    0.000    0.000    0.000 result.py:70(op)
      230    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
       14    0.000    0.000    0.000    0.000 __init__.py:265(__init__)
       20    0.000    0.000    0.000    0.000 deepmil.py:184(get_metrics_dict)
       40    0.000    0.000    0.000    0.000 flatten.py:41(forward)
      315    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
      170    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
       22    0.000    0.000    0.000    0.000 typing.py:245(inner)
       87    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}
       30    0.000    0.000    0.000    0.000 contextlib.py:237(helper)
       11    0.000    0.000    0.000    0.000 result.py:191(__setstate__)
       14    0.000    0.000    0.000    0.000 _utils.py:7(_get_device_index)
       20    0.000    0.000    0.000    0.000 precision_plugin.py:231(train_step_context)
      198    0.000    0.000    0.000    0.000 result.py:162(is_mean_reduction)
       11    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:194(_lock_unlock_module)
      110    0.000    0.000    0.000    0.000 logger_connector.py:296(should_reset_tensors)
       20    0.000    0.000    0.000    0.000 metric.py:317(sync_context)
      258    0.000    0.000    0.000    0.000 _collections_abc.py:302(__subclasshook__)
       22    0.000    0.000    0.000    0.000 version.py:444(_cmpkey)
      266    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
      242    0.000    0.000    0.000    0.000 result.py:80(group)
       10    0.000    0.000    0.000    0.000 distributed.py:139(distributed_available)
       14    0.000    0.000    0.000    0.000 {built-in method tensor}
      220    0.000    0.000    0.000    0.000 {method 'group' of 're.Match' objects}
      231    0.000    0.000    0.000    0.000 inspect.py:2835(parameters)
       40    0.000    0.000    0.000    0.000 enum.py:595(__format__)
       40    0.000    0.000    0.000    0.000 grad_mode.py:220(__exit__)
      242    0.000    0.000    0.000    0.000 inspect.py:2521(default)
      220    0.000    0.000    0.000    0.000 result.py:60(should)
      130    0.000    0.000    0.000    0.000 base.py:54(trainer)
      110    0.000    0.000    0.000    0.000 fx_validator.py:165(check_logging)
       10    0.000    0.000    0.000    0.000 _tensor.py:620(__len__)
       75    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
      110    0.000    0.000    0.000    0.000 fx_validator.py:188(check_logging_levels)
       30    0.000    0.000    0.000    0.000 contextlib.py:81(__init__)
      121    0.000    0.000    0.000    0.000 {method 'values' of 'mappingproxy' objects}
       40    0.000    0.000    0.000    0.000 {built-in method torch._C._nn._parse_to}
       14    0.000    0.000    0.000    0.000 grad_mode.py:124(__enter__)
       10    0.000    0.000    0.000    0.000 metric.py:259(sync)
       22    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
       40    0.000    0.000    0.000    0.000 {method 'flatten' of 'torch._C._TensorBase' objects}
       22    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:176(cb)
       22    0.000    0.000    0.000    0.000 {method 'search' of 're.Pattern' objects}
      110    0.000    0.000    0.000    0.000 fx_validator.py:177(get_default_logging_levels)
       22    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:58(__init__)
       44    0.000    0.000    0.000    0.000 typing.py:319(__hash__)
      100    0.000    0.000    0.000    0.000 {built-in method _operator.xor}
       11    0.000    0.000    0.000    0.000 imports.py:24(_module_available)
       14    0.000    0.000    0.000    0.000 grad_mode.py:128(__exit__)
      108    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
       10    0.000    0.000    0.000    0.000 base.py:68(profile)
      121    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}
       14    0.000    0.000    0.000    0.000 {method 'set_' of 'torch._C._TensorBase' objects}
       22    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:78(acquire)
       88    0.000    0.000    0.000    0.000 version.py:271(<genexpr>)
      110    0.000    0.000    0.000    0.000 trainer.py:2061(fit_loop)
       20    0.000    0.000    0.000    0.000 codecs.py:319(decode)
       50    0.000    0.000    0.000    0.000 {built-in method builtins.max}
       10    0.000    0.000    0.000    0.000 metric.py:34(jit_distributed_available)
       82    0.000    0.000    0.000    0.000 {built-in method torch._C.is_grad_enabled}
       14    0.000    0.000    0.000    0.000 {method 'new_empty' of 'torch._C._TensorBase' objects}
       14    0.000    0.000    0.000    0.000 _utils.py:476(_get_device_index)
        3    0.000    0.000    0.000    0.000 {built-in method io.open}
       11    0.000    0.000    0.000    0.000 {built-in method _operator.ge}
       22    0.000    0.000    0.000    0.000 <string>:1(__new__)
       22    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:103(release)
       22    0.000    0.000    0.000    0.000 copyreg.py:87(__newobj__)
       10    0.000    0.000    0.000    0.000 deepmil.py:340(<listcomp>)
       14    0.000    0.000    0.000    0.000 grad_mode.py:119(__init__)
       10    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       11    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:151(__exit__)
       11    0.000    0.000    0.000    0.000 util.py:73(find_spec)
       20    0.000    0.000    0.000    0.000 __init__.py:8(is_available)
       40    0.000    0.000    0.000    0.000 utils.py:38(<listcomp>)
        3    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
       76    0.000    0.000    0.000    0.000 {method 'values' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 result.py:587(reset)
       10    0.000    0.000    0.000    0.000 confusion_matrix.py:134(compute)
        3    0.000    0.000    0.000    0.000 {built-in method posix.stat}
       40    0.000    0.000    0.000    0.000 {method '__format__' of 'str' objects}
       66    0.000    0.000    0.000    0.000 version.py:393(_parse_letter_version)
        6    0.000    0.000    0.000    0.000 tokenize.py:380(find_cookie)
       44    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x561a1dcdf3c0}
       20    0.000    0.000    0.000    0.000 distributed_c10d.py:386(is_initialized)
       40    0.000    0.000    0.000    0.000 deepmil.py:330(get_bag_label)
       14    0.000    0.000    0.000    0.000 _tensor.py:1001(grad)
       44    0.000    0.000    0.000    0.000 {built-in method _imp.acquire_lock}
       10    0.000    0.000    0.000    0.000 deepmil.py:346(<listcomp>)
       40    0.000    0.000    0.000    0.000 metric.py:426(device)
       20    0.000    0.000    0.000    0.000 {built-in method _codecs.utf_8_decode}
       10    0.000    0.000    0.000    0.000 container.py:354(items)
       40    0.000    0.000    0.000    0.000 grad_mode.py:217(__enter__)
       10    0.000    0.000    0.000    0.000 container.py:360(values)
       44    0.000    0.000    0.000    0.000 {built-in method _thread.get_ident}
       44    0.000    0.000    0.000    0.000 {built-in method _imp.release_lock}
       11    0.000    0.000    0.000    0.000 version.py:87(__ge__)
       22    0.000    0.000    0.000    0.000 functools.py:67(wraps)
       44    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}
       11    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:929(_sanity_check)
       14    0.000    0.000    0.000    0.000 {method 'storage' of 'torch._C._TensorBase' objects}
       22    0.000    0.000    0.000    0.000 {method 'split' of 'str' objects}
       25    0.000    0.000    0.000    0.000 {method 'startswith' of 'str' objects}
       33    0.000    0.000    0.000    0.000 version.py:459(<lambda>)
       10    0.000    0.000    0.000    0.000 confusion_matrix.py:56(_confusion_matrix_compute)
       28    0.000    0.000    0.000    0.000 _jit_internal.py:957(is_scripting)
        9    0.000    0.000    0.000    0.000 {method 'match' of 're.Pattern' objects}
       21    0.000    0.000    0.000    0.000 result.py:142(sync)
       10    0.000    0.000    0.000    0.000 _reduction.py:7(get_enum)
       11    0.000    0.000    0.000    0.000 {built-in method torch._C.get_default_dtype}
        7    0.000    0.000    0.000    0.000 {method 'copy_' of 'torch._C.FloatStorageBase' objects}
       11    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:143(__init__)
       20    0.000    0.000    0.000    0.000 precision_plugin.py:226(forward_context)
       10    0.000    0.000    0.000    0.000 training_type_plugin.py:215(post_training_step)
       14    0.000    0.000    0.000    0.000 {method 'contiguous' of 'torch._C._TensorBase' objects}
       22    0.000    0.000    0.000    0.000 version.py:432(_parse_local_version)
        3    0.000    0.000    0.000    0.000 codecs.py:309(__init__)
       14    0.000    0.000    0.000    0.000 {method 'stride' of 'torch._C._TensorBase' objects}
       20    0.000    0.000    0.000    0.000 metric.py:475(<listcomp>)
       14    0.000    0.000    0.000    0.000 __init__.py:269(__enter__)
        7    0.000    0.000    0.000    0.000 {method 'copy_' of 'torch._C.LongStorageBase' objects}
       14    0.000    0.000    0.000    0.000 __init__.py:278(__exit__)
       11    0.000    0.000    0.000    0.000 {method '__setstate__' of 'functools.partial' objects}
       14    0.000    0.000    0.000    0.000 {method 'storage_offset' of 'torch._C._TensorBase' objects}
       14    0.000    0.000    0.000    0.000 {method 'is_conj' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 copyreg.py:96(_slotnames)
        3    0.000    0.000    0.000    0.000 warnings.py:419(__init__)
       14    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
       14    0.000    0.000    0.000    0.000 {method 'is_neg' of 'torch._C._TensorBase' objects}
       10    0.000    0.000    0.000    0.000 result.py:97(__call__)
       14    0.000    0.000    0.000    0.000 storage.py:13(__init__)
       10    0.000    0.000    0.000    0.000 training_type_plugin.py:162(model)
       10    0.000    0.000    0.000    0.000 distributed.py:359(tpu_distributed)
       12    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}
        7    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C.FloatStorageBase' objects}
       10    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        7    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C.LongStorageBase' objects}
       10    0.000    0.000    0.000    0.000 result.py:101(no_op)
       10    0.000    0.000    0.000    0.000 metric.py:295(unsync)
        6    0.000    0.000    0.000    0.000 {method 'decode' of 'bytes' objects}
        1    0.000    0.000    0.000    0.000 result.py:387(__init__)
        3    0.000    0.000    0.000    0.000 {method 'startswith' of 'bytes' objects}
        3    0.000    0.000    0.000    0.000 codecs.py:260(__init__)
        3    0.000    0.000    0.000    0.000 {method 'seek' of '_io.BufferedReader' objects}
        3    0.000    0.000    0.000    0.000 {method 'strip' of 'str' objects}
        3    0.000    0.000    0.000    0.000 {method 'endswith' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'mappingproxy' objects}



Profile stats for: training_step_end
         180 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       10    0.000    0.000    0.000    0.000 base.py:68(profile)
       20    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
       10    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       30    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       20    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
       10    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       10    0.000    0.000    0.000    0.000 lightning.py:696(training_step_end)
       10    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       10    0.000    0.000    0.000    0.000 training_type_plugin.py:227(training_step_end)
       10    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: zero_grad
         280 function calls in 0.005 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.000    0.000    0.005    0.000 optimizer_loop.py:311(zero_grad_fn)
       10    0.000    0.000    0.005    0.000 optimizer_loop.py:391(_on_before_zero_grad)
       10    0.000    0.000    0.004    0.000 trainer.py:1477(call_hook)
       10    0.000    0.000    0.004    0.000 contextlib.py:107(__enter__)
       10    0.000    0.000    0.004    0.000 {built-in method builtins.next}
       10    0.000    0.000    0.004    0.000 base.py:68(profile)
       10    0.000    0.000    0.004    0.000 advanced.py:61(start)
       10    0.004    0.000    0.004    0.000 {method 'enable' of '_lsprof.Profiler' objects}
       10    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
       10    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
       10    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
       10    0.000    0.000    0.000    0.000 module.py:1180(__setattr__)
       10    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       40    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       10    0.000    0.000    0.000    0.000 contextlib.py:237(helper)
       10    0.000    0.000    0.000    0.000 contextlib.py:81(__init__)
       10    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
       10    0.000    0.000    0.000    0.000 progress.py:126(increment_ready)
       30    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       10    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       10    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
       10    0.000    0.000    0.000    0.000 base.py:54(trainer)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}



Profile stats for: on_before_zero_grad
         750 function calls in 0.002 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.000    0.000    0.001    0.000 callback_hook.py:309(on_before_zero_grad)
       60    0.000    0.000    0.001    0.000 trainer.py:1682(lightning_module)
       60    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
       60    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
       60    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
      120    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       60    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
       10    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       10    0.000    0.000    0.000    0.000 base.py:68(profile)
       60    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       70    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
       60    0.000    0.000    0.000    0.000 base.py:329(on_before_zero_grad)
       10    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       10    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
       10    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       10    0.000    0.000    0.000    0.000 hooks.py:220(on_before_zero_grad)
       10    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       10    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: backward
         370 function calls in 0.043 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.000    0.000    0.043    0.004 optimizer_loop.py:326(backward_fn)
       10    0.000    0.000    0.043    0.004 accelerator.py:302(backward)
       10    0.000    0.000    0.043    0.004 precision_plugin.py:64(pre_backward)
       10    0.000    0.000    0.043    0.004 trainer.py:1477(call_hook)
       10    0.000    0.000    0.042    0.004 contextlib.py:107(__enter__)
       10    0.000    0.000    0.042    0.004 {built-in method builtins.next}
       10    0.000    0.000    0.042    0.004 base.py:68(profile)
       10    0.000    0.000    0.042    0.004 advanced.py:61(start)
       10    0.042    0.004    0.042    0.004 {method 'enable' of '_lsprof.Profiler' objects}
       20    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
       20    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
       20    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       10    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
       60    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       10    0.000    0.000    0.000    0.000 module.py:1180(__setattr__)
       20    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
       10    0.000    0.000    0.000    0.000 contextlib.py:237(helper)
       10    0.000    0.000    0.000    0.000 contextlib.py:81(__init__)
       20    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       30    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       20    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
       10    0.000    0.000    0.000    0.000 base.py:54(trainer)
       10    0.000    0.000    0.000    0.000 training_type_plugin.py:156(pre_backward)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}



Profile stats for: on_before_backward
         750 function calls in 0.001 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.000    0.000    0.001    0.000 callback_hook.py:294(on_before_backward)
       60    0.000    0.000    0.001    0.000 trainer.py:1682(lightning_module)
       60    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
       60    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
       60    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
      120    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       60    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
       10    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       10    0.000    0.000    0.000    0.000 base.py:68(profile)
       70    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
       10    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       60    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       60    0.000    0.000    0.000    0.000 base.py:315(on_before_backward)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       10    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
       10    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       10    0.000    0.000    0.000    0.000 hooks.py:240(on_before_backward)
       10    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
       10    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}



Profile stats for: on_after_backward
         750 function calls in 0.002 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.000    0.000    0.002    0.000 callback_hook.py:299(on_after_backward)
       60    0.000    0.000    0.001    0.000 trainer.py:1682(lightning_module)
       60    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
       60    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
       60    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
      120    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       60    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
       10    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       10    0.000    0.000    0.000    0.000 base.py:68(profile)
       70    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       60    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       10    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       60    0.000    0.000    0.000    0.000 base.py:319(on_after_backward)
       10    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
       10    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       10    0.000    0.000    0.000    0.000 hooks.py:248(on_after_backward)
       10    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
       10    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}



Profile stats for: on_before_optimizer_step
         750 function calls in 0.002 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.000    0.000    0.001    0.000 callback_hook.py:304(on_before_optimizer_step)
       60    0.000    0.000    0.001    0.000 trainer.py:1682(lightning_module)
       60    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
       60    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
       60    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
      120    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       60    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
       10    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       10    0.000    0.000    0.000    0.000 base.py:68(profile)
       60    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       10    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       60    0.000    0.000    0.000    0.000 base.py:323(on_before_optimizer_step)
       70    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       10    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
       10    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
       20    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
       10    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       10    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       10    0.000    0.000    0.000    0.000 hooks.py:256(on_before_optimizer_step)



Profile stats for: on_train_batch_end
         8010 function calls (7950 primitive calls) in 0.021 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.000    0.000    0.021    0.002 callback_hook.py:175(on_train_batch_end)
       60    0.001    0.000    0.016    0.000 signature_utils.py:18(is_param_in_hook_signature)
       60    0.000    0.000    0.015    0.000 inspect.py:3081(signature)
       60    0.000    0.000    0.015    0.000 inspect.py:2829(from_callable)
   120/60    0.001    0.000    0.015    0.000 inspect.py:2198(_signature_from_callable)
       60    0.002    0.000    0.009    0.000 inspect.py:2117(_signature_from_function)
      380    0.002    0.000    0.004    0.000 inspect.py:2467(__init__)
      120    0.002    0.000    0.004    0.000 inspect.py:2750(__init__)
       60    0.001    0.000    0.003    0.000 inspect.py:1799(_signature_bound_method)
       60    0.000    0.000    0.002    0.000 inspect.py:2843(replace)
       30    0.000    0.000    0.002    0.000 model_checkpoint.py:280(on_train_batch_end)
       70    0.000    0.000    0.001    0.000 trainer.py:1682(lightning_module)
      380    0.001    0.000    0.001    0.000 enum.py:284(__call__)
       30    0.000    0.000    0.001    0.000 model_checkpoint.py:398(_should_skip_saving_checkpoint)
      940    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
       10    0.000    0.000    0.001    0.000 tqdm_progress.py:234(on_train_batch_end)
      440    0.001    0.000    0.001    0.000 inspect.py:2799(<genexpr>)
       70    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
       70    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
       70    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
       10    0.000    0.000    0.001    0.000 base.py:102(total_val_batches)
       30    0.000    0.000    0.001    0.000 trainer.py:2018(sanity_checking)
      700    0.001    0.000    0.001    0.000 inspect.py:2517(name)
       60    0.000    0.000    0.001    0.000 inspect.py:484(unwrap)
      380    0.001    0.000    0.001    0.000 enum.py:526(__new__)
       30    0.000    0.000    0.001    0.000 enums.py:30(__eq__)
      450    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       10    0.000    0.000    0.000    0.000 trainer.py:1844(enable_validation)
      440    0.000    0.000    0.000    0.000 inspect.py:2529(kind)
      380    0.000    0.000    0.000    0.000 {method 'isidentifier' of 'str' objects}
      380    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
      120    0.000    0.000    0.000    0.000 inspect.py:158(isfunction)
       60    0.000    0.000    0.000    0.000 trainer.py:2033(global_step)
      320    0.000    0.000    0.000    0.000 inspect.py:2521(default)
       70    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
       60    0.000    0.000    0.000    0.000 types.py:164(__get__)
       10    0.000    0.000    0.000    0.000 model_helpers.py:22(is_overridden)
      110    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       60    0.000    0.000    0.000    0.000 inspect.py:504(_is_wrapper)
       30    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:1009(_handle_fromlist)
       10    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
      140    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
       10    0.000    0.000    0.000    0.000 tqdm_progress.py:312(_should_update)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      120    0.000    0.000    0.000    0.000 inspect.py:2835(parameters)
       70    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       80    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
       10    0.000    0.000    0.000    0.000 tqdm_progress.py:328(convert_inf)
       10    0.000    0.000    0.000    0.000 base.py:68(profile)
       60    0.000    0.000    0.000    0.000 {method 'values' of 'mappingproxy' objects}
       30    0.000    0.000    0.000    0.000 {built-in method time.monotonic}
       60    0.000    0.000    0.000    0.000 fit_loop.py:65(global_step)
       40    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       10    0.000    0.000    0.000    0.000 trainer.py:2037(current_epoch)
       70    0.000    0.000    0.000    0.000 trainer.py:2061(fit_loop)
       60    0.000    0.000    0.000    0.000 enum.py:628(value)
       10    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       60    0.000    0.000    0.000    0.000 {built-in method builtins.id}
       60    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
       60    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}
       10    0.000    0.000    0.000    0.000 tqdm_progress.py:128(is_enabled)
       50    0.000    0.000    0.000    0.000 base.py:57(trainer)
       10    0.000    0.000    0.000    0.000 base.py:93(total_train_batches)
       10    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
       10    0.000    0.000    0.000    0.000 {built-in method math.isinf}
       10    0.000    0.000    0.000    0.000 base.py:164(on_train_batch_end)
       10    0.000    0.000    0.000    0.000 {built-in method math.isnan}
       10    0.000    0.000    0.000    0.000 fit_loop.py:55(current_epoch)
       20    0.000    0.000    0.000    0.000 base.py:110(on_train_batch_end)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.len}
       20    0.000    0.000    0.000    0.000 tqdm_progress.py:120(refresh_rate)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.sum}
       10    0.000    0.000    0.000    0.000 hooks.py:93(on_train_batch_end)
       10    0.000    0.000    0.000    0.000 base.py:61(train_batch_idx)
       10    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_batch_end
         760 function calls in 0.002 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.000    0.000    0.001    0.000 callback_hook.py:160(on_batch_end)
       60    0.000    0.000    0.001    0.000 trainer.py:1682(lightning_module)
       60    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
       60    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
       60    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
      120    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       60    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       10    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       10    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
       10    0.000    0.000    0.000    0.000 base.py:68(profile)
       70    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
       60    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       60    0.000    0.000    0.000    0.000 base.py:226(on_batch_end)
       10    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       10    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
       10    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
       20    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
       10    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       10    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       10    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_validation_model_eval
         2445 function calls (2349 primitive calls) in 0.006 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.006    0.006 hooks.py:164(on_validation_model_eval)
        1    0.000    0.000    0.006    0.006 module.py:1720(eval)
     97/1    0.001    0.000    0.006    0.006 module.py:1698(train)
      193    0.000    0.000    0.003    0.000 module.py:1597(children)
      193    0.001    0.000    0.003    0.000 module.py:1606(named_children)
       30    0.001    0.000    0.002    0.000 metric.py:560(__hash__)
       97    0.001    0.000    0.002    0.000 module.py:1180(__setattr__)
       96    0.000    0.000    0.001    0.000 {method 'add' of 'set' objects}
       30    0.000    0.000    0.001    0.000 {built-in method builtins.hash}
      154    0.000    0.000    0.001    0.000 _tensor.py:650(__hash__)
      417    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
      292    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       15    0.000    0.000    0.000    0.000 metric.py:421(__setattr__)
      184    0.000    0.000    0.000    0.000 {built-in method builtins.id}
      154    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
      128    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      127    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      114    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
       97    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
       12    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 trainer.py:1731(model)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 accelerator.py:159(model)
        1    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        2    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:162(model)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_validation_start
         2196 function calls in 0.005 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.005    0.005 callback_hook.py:213(on_validation_start)
        1    0.000    0.000    0.005    0.005 tqdm_progress.py:242(on_validation_start)
        3    0.000    0.000    0.005    0.002 std.py:1339(refresh)
        3    0.000    0.000    0.004    0.001 std.py:1478(display)
        7    0.000    0.000    0.003    0.000 utils.py:333(disp_len)
        7    0.000    0.000    0.003    0.000 utils.py:329(_text_width)
        8    0.001    0.000    0.003    0.000 {built-in method builtins.sum}
        3    0.000    0.000    0.003    0.001 std.py:1164(__str__)
      870    0.002    0.000    0.002    0.000 utils.py:330(<genexpr>)
        1    0.000    0.000    0.002    0.002 tqdm_progress.py:315(_update_bar)
        1    0.000    0.000    0.002    0.002 std.py:1212(update)
        3    0.000    0.000    0.002    0.001 std.py:355(format_meter)
        1    0.000    0.000    0.002    0.002 tqdm_progress.py:338(reset)
        1    0.000    0.000    0.002    0.002 std.py:1374(reset)
        3    0.000    0.000    0.002    0.001 std.py:348(print_status)
        2    0.000    0.000    0.001    0.001 utils.py:341(disp_trim)
      863    0.001    0.000    0.001    0.000 {built-in method unicodedata.east_asian_width}
        1    0.000    0.000    0.001    0.001 tqdm_progress.py:182(init_validation_tqdm)
        1    0.000    0.000    0.001    0.001 tqdm_progress.py:34(__init__)
        1    0.000    0.000    0.001    0.001 asyncio.py:23(__init__)
        1    0.000    0.000    0.001    0.001 std.py:846(__init__)
        3    0.000    0.000    0.000    0.000 std.py:1460(format_dict)
        4    0.000    0.000    0.000    0.000 utils.py:282(_screen_shape_linux)
       14    0.000    0.000    0.000    0.000 utils.py:143(inner)
        7    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
        4    0.000    0.000    0.000    0.000 std.py:1455(moveto)
        7    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        7    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        3    0.000    0.000    0.000    0.000 std.py:342(fp_write)
        7    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 base.py:102(total_val_batches)
        4    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
        4    0.000    0.000    0.000    0.000 utils.py:222(_is_ascii)
       16    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        7    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 std.py:560(__new__)
       22    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        5    0.000    0.000    0.000    0.000 std.py:108(release)
        1    0.000    0.000    0.000    0.000 trainer.py:1844(enable_validation)
       12    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:1009(_handle_fromlist)
        4    0.000    0.000    0.000    0.000 std.py:288(format_interval)
        5    0.000    0.000    0.000    0.000 std.py:104(acquire)
       23    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       42    0.000    0.000    0.000    0.000 {built-in method builtins.ord}
        1    0.000    0.000    0.000    0.000 utils.py:162(__init__)
        2    0.000    0.000    0.000    0.000 std.py:115(__exit__)
        7    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        1    0.000    0.000    0.000    0.000 std.py:329(status_printer)
        2    0.000    0.000    0.000    0.000 std.py:188(__format__)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        9    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
       15    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 std.py:155(__init__)
        1    0.000    0.000    0.000    0.000 {built-in method now}
        1    0.000    0.000    0.000    0.000 trainer.py:2018(sanity_checking)
        7    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 model_helpers.py:22(is_overridden)
        1    0.000    0.000    0.000    0.000 utils.py:215(_supports_unicode)
        5    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 enums.py:30(__eq__)
        2    0.000    0.000    0.000    0.000 std.py:112(__enter__)
        5    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:81(add)
        7    0.000    0.000    0.000    0.000 {method 'sub' of 're.Pattern' objects}
        6    0.000    0.000    0.000    0.000 {built-in method time.time}
        2    0.000    0.000    0.000    0.000 utils.py:136(disable_on_exception)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
        4    0.000    0.000    0.000    0.000 utils.py:171(__eq__)
        1    0.000    0.000    0.000    0.000 trainer.py:2037(current_epoch)
        1    0.000    0.000    0.000    0.000 utils.py:201(_is_utf)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:328(convert_inf)
        3    0.000    0.000    0.000    0.000 std.py:233(__call__)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        9    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        1    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        6    0.000    0.000    0.000    0.000 std.py:228(__init__)
        5    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:132(is_disabled)
        1    0.000    0.000    0.000    0.000 _monitor.py:94(report)
        5    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        2    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        4    0.000    0.000    0.000    0.000 utils.py:319(_term_move_up)
        5    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        2    0.000    0.000    0.000    0.000 types.py:164(__get__)
        3    0.000    0.000    0.000    0.000 utils.py:101(wrapper_setattr)
        1    0.000    0.000    0.000    0.000 utils.py:105(__init__)
        5    0.000    0.000    0.000    0.000 base.py:246(on_validation_start)
        2    0.000    0.000    0.000    0.000 {built-in method utcfromtimestamp}
        4    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 fit_loop.py:55(current_epoch)
        4    0.000    0.000    0.000    0.000 base.py:57(trainer)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:128(is_enabled)
        2    0.000    0.000    0.000    0.000 std.py:169(colour)
        1    0.000    0.000    0.000    0.000 std.py:657(get_lock)
        1    0.000    0.000    0.000    0.000 std.py:1171(__hash__)
        2    0.000    0.000    0.000    0.000 utils.py:61(__format__)
        2    0.000    0.000    0.000    0.000 {built-in method _weakref.proxy}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        2    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 tqdm_progress.py:120(refresh_rate)
        2    0.000    0.000    0.000    0.000 utils.py:57(__init__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.min}
        1    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
        2    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x561a1dcdf3c0}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:2061(fit_loop)
        1    0.000    0.000    0.000    0.000 base.py:167(on_validation_start)
        2    0.000    0.000    0.000    0.000 std.py:165(colour)
        1    0.000    0.000    0.000    0.000 {built-in method math.isinf}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:335(on_validation_start)
        1    0.000    0.000    0.000    0.000 base.py:69(val_batch_idx)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:124(process_position)
        1    0.000    0.000    0.000    0.000 hooks.py:46(on_validation_start)
        1    0.000    0.000    0.000    0.000 utils.py:231(_screen_shape_wrapper)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 threading.py:507(is_set)
        2    0.000    0.000    0.000    0.000 enum.py:628(value)
        1    0.000    0.000    0.000    0.000 {built-in method math.isnan}



Profile stats for: on_validation_epoch_start
         75 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:95(on_validation_epoch_start)
        6    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
        6    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        6    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        6    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        6    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        6    0.000    0.000    0.000    0.000 base.py:136(on_validation_epoch_start)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        7    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        6    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 hooks.py:202(on_validation_epoch_start)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: get_validate_batch
         126 function calls (114 primitive calls) in 127.049 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    18/12    0.000    0.000  127.048   10.587 contextlib.py:107(__enter__)
    18/12    0.000    0.000  127.048   10.587 {built-in method builtins.next}
        6    0.000    0.000  127.048   21.175 fetching.py:287(apply_profiler)
        6    0.000    0.000  127.048   21.175 base.py:68(profile)
        6    0.000    0.000  127.048   21.175 advanced.py:61(start)
        6  127.048   21.175  127.048   21.175 {method 'enable' of '_lsprof.Profiler' objects}
       18    0.000    0.000    0.000    0.000 contextlib.py:237(helper)
       18    0.000    0.000    0.000    0.000 contextlib.py:81(__init__)
       18    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        6    0.000    0.000    0.000    0.000 fetching.py:238(fetching_context)
        6    0.000    0.000    0.000    0.000 fetching.py:243(on_fetch_start)



Profile stats for: fetch_next_validate_batch
         1382 function calls (1358 primitive calls) in 127.048 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    30/12    0.000    0.000  127.048   10.587 {built-in method builtins.next}
        6    0.000    0.000  127.048   21.175 dataloader.py:517(__next__)
        6    0.000    0.000  127.046   21.174 dataloader.py:1156(_next_data)
        6    0.000    0.000  127.045   21.174 dataloader.py:1123(_get_data)
       28    0.001    0.000  127.044    4.537 dataloader.py:977(_try_get_data)
       28    0.001    0.000  127.043    4.537 queue.py:153(get)
       28    0.001    0.000  127.041    4.537 threading.py:264(wait)
      152  127.040    0.836  127.040    0.836 {method 'acquire' of '_thread.lock' objects}
       44    0.000    0.000    0.001    0.000 process.py:144(is_alive)
        6    0.000    0.000    0.001    0.000 profiler.py:438(__exit__)
        6    0.000    0.000    0.001    0.000 dataloader.py:1225(_process_data)
        6    0.000    0.000    0.001    0.000 profiler.py:434(__enter__)
        6    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_exit}
        6    0.000    0.000    0.001    0.000 dataloader.py:1205(_try_put_index)
        6    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_enter}
       44    0.000    0.000    0.000    0.000 popen_fork.py:25(poll)
       28    0.000    0.000    0.000    0.000 threading.py:1080(is_alive)
        6    0.000    0.000    0.000    0.000 profiler.py:426(__init__)
        6    0.000    0.000    0.000    0.000 queues.py:80(put)
       44    0.000    0.000    0.000    0.000 {built-in method posix.waitpid}
        6    0.000    0.000    0.000    0.000 {built-in method zeros}
       56    0.000    0.000    0.000    0.000 queue.py:208(_qsize)
       12    0.000    0.000    0.000    0.000 threading.py:335(notify)
       28    0.000    0.000    0.000    0.000 threading.py:252(_acquire_restore)
     12/6    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
       78    0.000    0.000    0.000    0.000 {built-in method time.monotonic}
        6    0.000    0.000    0.000    0.000 dataloader.py:511(_next_index)
       28    0.000    0.000    0.000    0.000 threading.py:1038(_wait_for_tstate_lock)
        6    0.000    0.000    0.000    0.000 fetching.py:287(apply_profiler)
       40    0.000    0.000    0.000    0.000 threading.py:255(_is_owned)
      114    0.000    0.000    0.000    0.000 {built-in method builtins.len}
       34    0.000    0.000    0.000    0.000 threading.py:243(__exit__)
       34    0.000    0.000    0.000    0.000 {method 'release' of '_thread.lock' objects}
        6    0.000    0.000    0.000    0.000 sampler.py:227(__iter__)
       34    0.000    0.000    0.000    0.000 threading.py:240(__enter__)
       44    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
        6    0.000    0.000    0.000    0.000 base.py:68(profile)
       28    0.000    0.000    0.000    0.000 threading.py:249(_release_save)
       44    0.000    0.000    0.000    0.000 process.py:90(_check_closed)
        6    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       28    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}
       28    0.000    0.000    0.000    0.000 {method 'remove' of 'collections.deque' objects}
       34    0.000    0.000    0.000    0.000 {method 'append' of 'collections.deque' objects}
       34    0.000    0.000    0.000    0.000 {method '__enter__' of '_thread.lock' objects}
       28    0.000    0.000    0.000    0.000 threading.py:507(is_set)
       28    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       34    0.000    0.000    0.000    0.000 {method '__exit__' of '_thread.lock' objects}
        6    0.000    0.000    0.000    0.000 queue.py:216(_get)
       24    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        6    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        6    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        6    0.000    0.000    0.000    0.000 {method 'popleft' of 'collections.deque' objects}
        6    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: evaluation_batch_to_device
         3545 function calls (3370 primitive calls) in 0.011 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        5    0.000    0.000    0.010    0.002 accelerator.py:192(batch_to_device)
        5    0.000    0.000    0.010    0.002 lightning.py:284(_apply_batch_transfer_handler)
        5    0.000    0.000    0.008    0.002 hooks.py:652(transfer_batch_to_device)
        5    0.000    0.000    0.008    0.002 apply_func.py:241(move_data_to_device)
    175/5    0.002    0.000    0.008    0.002 apply_func.py:66(apply_to_collection)
      870    0.002    0.000    0.004    0.000 {built-in method builtins.isinstance}
      495    0.001    0.000    0.002    0.000 abc.py:137(__instancecheck__)
        5    0.000    0.000    0.002    0.000 signature_utils.py:18(is_param_in_hook_signature)
        5    0.000    0.000    0.002    0.000 inspect.py:3081(signature)
      495    0.001    0.000    0.001    0.000 {built-in method _abc._abc_instancecheck}
        5    0.000    0.000    0.001    0.000 inspect.py:2829(from_callable)
     10/5    0.000    0.000    0.001    0.000 inspect.py:2198(_signature_from_callable)
       15    0.000    0.000    0.001    0.000 apply_func.py:258(batch_to)
       15    0.001    0.000    0.001    0.000 {method 'to' of 'torch._C._TensorBase' objects}
        5    0.000    0.000    0.001    0.000 inspect.py:2117(_signature_from_function)
      120    0.000    0.000    0.001    0.000 abc.py:141(__subclasscheck__)
      120    0.000    0.000    0.001    0.000 apply_func.py:61(_is_dataclass_instance)
      150    0.000    0.000    0.000    0.000 apply_func.py:56(_is_namedtuple)
      120    0.000    0.000    0.000    0.000 {built-in method _abc._abc_subclasscheck}
      120    0.000    0.000    0.000    0.000 dataclasses.py:1017(is_dataclass)
       10    0.000    0.000    0.000    0.000 inspect.py:2750(__init__)
        5    0.000    0.000    0.000    0.000 inspect.py:1799(_signature_bound_method)
       20    0.000    0.000    0.000    0.000 inspect.py:2467(__init__)
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
      190    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        5    0.000    0.000    0.000    0.000 inspect.py:2843(replace)
      120    0.000    0.000    0.000    0.000 _collections_abc.py:302(__subclasshook__)
      125    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        5    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        5    0.000    0.000    0.000    0.000 inspect.py:484(unwrap)
       20    0.000    0.000    0.000    0.000 enum.py:284(__call__)
       25    0.000    0.000    0.000    0.000 inspect.py:2799(<genexpr>)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        5    0.000    0.000    0.000    0.000 base.py:68(profile)
        5    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        5    0.000    0.000    0.000    0.000 accelerator.py:180(root_device)
       30    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       35    0.000    0.000    0.000    0.000 inspect.py:2517(name)
       10    0.000    0.000    0.000    0.000 inspect.py:158(isfunction)
        5    0.000    0.000    0.000    0.000 inspect.py:504(_is_wrapper)
        5    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
       20    0.000    0.000    0.000    0.000 enum.py:526(__new__)
       20    0.000    0.000    0.000    0.000 {method 'isidentifier' of 'str' objects}
       25    0.000    0.000    0.000    0.000 inspect.py:2529(kind)
       15    0.000    0.000    0.000    0.000 inspect.py:2521(default)
        5    0.000    0.000    0.000    0.000 {method 'values' of 'mappingproxy' objects}
       10    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
       10    0.000    0.000    0.000    0.000 inspect.py:2835(parameters)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        5    0.000    0.000    0.000    0.000 base.py:54(trainer)
        5    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}
        5    0.000    0.000    0.000    0.000 single_device.py:63(root_device)
        5    0.000    0.000    0.000    0.000 hooks.py:709(on_before_batch_transfer)
        5    0.000    0.000    0.000    0.000 hooks.py:744(on_after_batch_transfer)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        5    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_validation_batch_start
         375 function calls in 0.001 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        5    0.000    0.000    0.001    0.000 callback_hook.py:183(on_validation_batch_start)
       30    0.000    0.000    0.001    0.000 trainer.py:1682(lightning_module)
       30    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
       30    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
       30    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       60    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       30    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        5    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       10    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        5    0.000    0.000    0.000    0.000 base.py:68(profile)
       35    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
       30    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       30    0.000    0.000    0.000    0.000 base.py:172(on_validation_batch_start)
        5    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        5    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        5    0.000    0.000    0.000    0.000 hooks.py:103(on_validation_batch_start)
        5    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        5    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: evaluation_step_and_end
         285 function calls in 2.155 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        5    0.000    0.000    2.155    0.431 evaluation_epoch_loop.py:196(_evaluation_step)
        5    0.000    0.000    2.154    0.431 contextlib.py:107(__enter__)
        5    0.000    0.000    2.154    0.431 {built-in method builtins.next}
        5    0.000    0.000    2.154    0.431 base.py:68(profile)
        5    0.000    0.000    2.154    0.431 advanced.py:61(start)
        5    2.154    0.431    2.154    0.431 {method 'enable' of '_lsprof.Profiler' objects}
        5    0.000    0.000    0.000    0.000 evaluation_epoch_loop.py:264(_build_kwargs)
       15    0.000    0.000    0.000    0.000 trainer.py:1970(testing)
       15    0.000    0.000    0.000    0.000 enums.py:30(__eq__)
        5    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
       30    0.000    0.000    0.000    0.000 types.py:164(__get__)
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        5    0.000    0.000    0.000    0.000 module.py:1180(__setattr__)
       35    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        5    0.000    0.000    0.000    0.000 contextlib.py:237(helper)
       30    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
       30    0.000    0.000    0.000    0.000 enum.py:628(value)
       25    0.000    0.000    0.000    0.000 base.py:54(trainer)
        5    0.000    0.000    0.000    0.000 contextlib.py:81(__init__)
        5    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
       15    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        5    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        5    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)



Profile stats for: validation_step
         51489 function calls (47916 primitive calls) in 2.152 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        5    0.000    0.000    2.154    0.431 accelerator.py:230(validation_step)
        5    0.000    0.000    2.153    0.431 training_type_plugin.py:218(validation_step)
        5    0.000    0.000    2.153    0.431 deepmil.py:271(validation_step)
        5    0.001    0.000    2.053    0.411 deepmil.py:222(_shared_step)
        5    0.001    0.000    1.594    0.319 deepmil.py:187(compute_bag_labels_logits_and_attn_maps)
  1710/30    0.013    0.000    1.592    0.053 module.py:1096(_call_impl)
       20    0.001    0.000    1.591    0.080 deepmil.py:172(forward)
       20    0.000    0.000    1.578    0.079 encoders.py:51(forward)
       20    0.000    0.000    1.410    0.071 transforms.py:218(forward)
       20    0.004    0.000    1.410    0.070 functional.py:311(normalize)
       40    1.402    0.035    1.402    0.035 {built-in method as_tensor}
       80    0.001    0.000    0.461    0.006 metric.py:251(wrapped_func)
       15    0.001    0.000    0.444    0.030 accuracy.py:218(update)
       40    0.003    0.000    0.429    0.011 checks.py:190(_check_classification_inputs)
       15    0.000    0.000    0.423    0.028 accuracy.py:29(_mode)
       40    0.419    0.010    0.421    0.011 checks.py:29(_basic_input_validation)
       20    0.000    0.000    0.167    0.008 resnet.py:248(forward)
       20    0.002    0.000    0.167    0.008 resnet.py:230(_forward_impl)
  160/100    0.002    0.000    0.156    0.002 container.py:139(forward)
      160    0.012    0.000    0.147    0.001 resnet.py:67(forward)
       55    0.002    0.000    0.095    0.002 lightning.py:324(log)
        5    0.001    0.000    0.087    0.017 deepmil.py:158(log_metrics)
       50    0.001    0.000    0.085    0.002 logging.py:307(log_on_epoch)
       50    0.000    0.000    0.083    0.002 lightning.py:501(log_dict)
       55    0.002    0.000    0.079    0.001 result.py:424(log)
      400    0.003    0.000    0.078    0.000 conv.py:445(forward)
      400    0.002    0.000    0.074    0.000 conv.py:437(_conv_forward)
      400    0.071    0.000    0.071    0.000 {built-in method conv2d}
  888/232    0.009    0.000    0.061    0.000 apply_func.py:66(apply_to_collection)
       11    0.000    0.000    0.054    0.005 result.py:488(register_key)
       11    0.000    0.000    0.053    0.005 result.py:494(fn)
       11    0.000    0.000    0.041    0.004 result.py:324(to)
      400    0.006    0.000    0.037    0.000 batchnorm.py:134(forward)
      400    0.003    0.000    0.026    0.000 functional.py:2251(batch_norm)
      400    0.021    0.000    0.021    0.000 {built-in method batch_norm}
   850/36    0.005    0.000    0.019    0.001 copy.py:132(deepcopy)
       15    0.000    0.000    0.019    0.001 accuracy.py:64(_accuracy_update)
       15    0.000    0.000    0.018    0.001 stat_scores.py:76(_stat_scores_update)
       25    0.001    0.000    0.018    0.001 checks.py:296(_input_format_classification)
5768/5748    0.009    0.000    0.017    0.000 {built-in method builtins.isinstance}
       55    0.000    0.000    0.016    0.000 result.py:503(update_metrics)
       55    0.000    0.000    0.016    0.000 apply_func.py:153(apply_to_collections)
       55    0.000    0.000    0.016    0.000 result.py:504(fn)
       11    0.000    0.000    0.013    0.001 result.py:205(__init__)
      340    0.001    0.000    0.011    0.000 activation.py:97(forward)
      340    0.002    0.000    0.010    0.000 functional.py:1288(relu)
     4425    0.010    0.000    0.010    0.000 module.py:1164(__getattr__)
       11    0.001    0.000    0.009    0.001 metric.py:75(__init__)
       20    0.000    0.000    0.009    0.000 attention_layers.py:60(forward)
       20    0.000    0.000    0.009    0.000 module.py:795(to)
       20    0.003    0.000    0.009    0.000 metric.py:466(_apply)
     2362    0.004    0.000    0.008    0.000 abc.py:137(__instancecheck__)
       33    0.000    0.000    0.008    0.000 {method '__reduce_ex__' of 'object' objects}
       11    0.000    0.000    0.008    0.001 result.py:182(__getstate__)
      340    0.008    0.000    0.008    0.000 {built-in method relu_}
    33/22    0.000    0.000    0.008    0.000 copy.py:268(_reconstruct)
       11    0.000    0.000    0.006    0.001 dataclasses.py:1023(asdict)
   198/11    0.002    0.000    0.006    0.001 dataclasses.py:1047(_asdict_inner)
    44/22    0.001    0.000    0.006    0.000 copy.py:236(_deepcopy_dict)
       55    0.000    0.000    0.006    0.000 result.py:263(forward)
        5    0.000    0.000    0.006    0.001 confusion_matrix.py:124(update)
       15    0.003    0.000    0.006    0.000 stat_scores.py:28(_stat_scores)
        5    0.001    0.000    0.006    0.001 confusion_matrix.py:24(_confusion_matrix_update)
       60    0.000    0.000    0.006    0.000 linear.py:102(forward)
       55    0.003    0.000    0.005    0.000 result.py:216(update)
       60    0.000    0.000    0.005    0.000 functional.py:1832(linear)
      248    0.001    0.000    0.005    0.000 metric.py:421(__setattr__)
       25    0.000    0.000    0.005    0.000 data.py:91(select_topk)
       60    0.004    0.000    0.004    0.000 {built-in method torch._C._nn.linear}
      653    0.001    0.000    0.004    0.000 apply_func.py:61(_is_dataclass_instance)
     1715    0.004    0.000    0.004    0.000 {built-in method torch._C._get_tracing_state}
     2362    0.003    0.000    0.004    0.000 {built-in method _abc._abc_instancecheck}
       55    0.000    0.000    0.004    0.000 trainer.py:2153(_results)
       11    0.000    0.000    0.004    0.000 imports.py:42(_compare_version)
      248    0.002    0.000    0.004    0.000 module.py:1180(__setattr__)
       55    0.000    0.000    0.003    0.000 trainer.py:2128(_active_loop)
       14    0.000    0.000    0.003    0.000 metric.py:114(add_state)
        5    0.000    0.000    0.003    0.001 auroc.py:159(update)
        5    0.000    0.000    0.003    0.001 auroc.py:27(_auroc_update)
      165    0.001    0.000    0.003    0.000 enums.py:30(__eq__)
     2337    0.003    0.000    0.003    0.000 {method 'get' of 'dict' objects}
       25    0.000    0.000    0.003    0.000 data.py:57(to_onehot)
      653    0.001    0.000    0.003    0.000 dataclasses.py:1017(is_dataclass)
       65    0.003    0.000    0.003    0.000 {method 'sum' of 'torch._C._TensorBase' objects}
      140    0.001    0.000    0.003    0.000 enums.py:38(__eq__)
       14    0.001    0.000    0.003    0.000 _tensor.py:81(__deepcopy__)
      110    0.000    0.000    0.003    0.000 trainer.py:1959(training)
       30    0.002    0.000    0.003    0.000 checks.py:127(_check_num_classes_mc)
       11    0.000    0.000    0.002    0.000 inspect.py:3081(signature)
       11    0.000    0.000    0.002    0.000 inspect.py:2829(from_callable)
      160    0.002    0.000    0.002    0.000 container.py:131(__iter__)
    22/11    0.000    0.000    0.002    0.000 inspect.py:2198(_signature_from_callable)
       70    0.002    0.000    0.002    0.000 {method 'max' of 'torch._C._TensorBase' objects}
      411    0.001    0.000    0.002    0.000 {built-in method builtins.setattr}
      600    0.001    0.000    0.002    0.000 types.py:164(__get__)
       25    0.002    0.000    0.002    0.000 {method 'scatter' of 'torch._C._TensorBase' objects}
      230    0.001    0.000    0.002    0.000 module.py:893(convert)
      653    0.001    0.000    0.002    0.000 apply_func.py:56(_is_namedtuple)
       20    0.000    0.000    0.002    0.000 pooling.py:1166(forward)
      400    0.001    0.000    0.002    0.000 batchnorm.py:406(_check_input_dim)
       22    0.001    0.000    0.002    0.000 version.py:261(__init__)
       20    0.000    0.000    0.002    0.000 functional.py:1117(adaptive_avg_pool2d)
      298    0.002    0.000    0.002    0.000 {method 'to' of 'torch._C._TensorBase' objects}
      400    0.001    0.000    0.002    0.000 __init__.py:31(__get__)
      938    0.001    0.000    0.002    0.000 {built-in method builtins.hasattr}
       28    0.000    0.000    0.002    0.000 apply_func.py:241(move_data_to_device)
       55    0.000    0.000    0.002    0.000 memory.py:41(recursive_detach)
       20    0.000    0.000    0.002    0.000 activation.py:348(forward)
       66    0.000    0.000    0.002    0.000 <string>:1(__init__)
       20    0.001    0.000    0.001    0.000 {built-in method tanh}
       44    0.001    0.000    0.001    0.000 dataclasses.py:994(fields)
       45    0.001    0.000    0.001    0.000 {built-in method zeros}
       20    0.000    0.000    0.001    0.000 pooling.py:161(forward)
       11    0.000    0.000    0.001    0.000 __init__.py:109(import_module)
      100    0.001    0.000    0.001    0.000 {method 'int' of 'torch._C._TensorBase' objects}
        5    0.001    0.000    0.001    0.000 {built-in method bincount}
       35    0.001    0.000    0.001    0.000 {method 'mean' of 'torch._C._TensorBase' objects}
     1019    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
      175    0.001    0.000    0.001    0.000 {method 'view' of 'torch._C._TensorBase' objects}
       11    0.000    0.000    0.001    0.000 inspect.py:2117(_signature_from_function)
       11    0.000    0.000    0.001    0.000 <frozen importlib._bootstrap>:994(_gcd_import)
     1333    0.001    0.000    0.001    0.000 {built-in method builtins.id}
       40    0.001    0.000    0.001    0.000 {method 'min' of 'torch._C._TensorBase' objects}
       28    0.000    0.000    0.001    0.000 apply_func.py:258(batch_to)
       20    0.000    0.000    0.001    0.000 _jit_internal.py:412(fn)
      132    0.001    0.000    0.001    0.000 result.py:90(_generate_sync_fn)
       35    0.001    0.000    0.001    0.000 {method 'argmax' of 'torch._C._TensorBase' objects}
       11    0.000    0.000    0.001    0.000 <frozen importlib._bootstrap>:978(_find_and_load)
       55    0.000    0.000    0.001    0.000 result.py:405(_extract_batch_size)
       66    0.000    0.000    0.001    0.000 result.py:121(__post_init__)
       22    0.000    0.000    0.001    0.000 dataclasses.py:1205(replace)
      231    0.001    0.000    0.001    0.000 dataclasses.py:1012(_is_dataclass_instance)
      679    0.001    0.000    0.001    0.000 result.py:291(__setattr__)
    22/11    0.000    0.000    0.001    0.000 copy.py:219(_deepcopy_tuple)
       25    0.000    0.000    0.001    0.000 functional.py:1650(softmax)
       50    0.000    0.000    0.001    0.000 distributed.py:46(wrapped_fn)
       55    0.000    0.000    0.001    0.000 trainer.py:2018(sanity_checking)
       20    0.000    0.000    0.001    0.000 functional.py:697(_max_pool2d)
        5    0.000    0.000    0.001    0.000 data.py:48(extract_batch_size)
      786    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
    22/11    0.000    0.000    0.001    0.000 copy.py:220(<listcomp>)
       25    0.001    0.000    0.001    0.000 {method 'clone' of 'torch._C._TensorBase' objects}
       20    0.001    0.000    0.001    0.000 {built-in method torch._C._nn.adaptive_avg_pool2d}
       66    0.001    0.000    0.001    0.000 result.py:126(_parse_reduce_fx)
       77    0.000    0.000    0.001    0.000 result.py:57(__post_init__)
       55    0.000    0.000    0.001    0.000 result.py:147(sync)
       44    0.000    0.000    0.001    0.000 <string>:1(__eq__)
        5    0.000    0.000    0.001    0.000 deepmil.py:335(update_results_with_data_specific_info)
       20    0.001    0.000    0.001    0.000 {built-in method max_pool2d}
   105/35    0.000    0.000    0.001    0.000 data.py:30(_extract_batch_size)
       20    0.001    0.000    0.001    0.000 {method 'any' of 'torch._C._TensorBase' objects}
       20    0.001    0.000    0.001    0.000 {method 'float' of 'torch._C._TensorBase' objects}
       14    0.000    0.000    0.001    0.000 storage.py:44(__deepcopy__)
       50    0.000    0.000    0.001    0.000 warnings.py:25(rank_zero_warn)
       25    0.001    0.000    0.001    0.000 {built-in method zeros_like}
       55    0.000    0.000    0.001    0.000 fx_validator.py:202(check_logging_and_get_default_levels)
       11    0.000    0.000    0.001    0.000 metric.py:250(_wrap_update)
      410    0.001    0.000    0.001    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
       11    0.000    0.000    0.001    0.000 device_dtype_mixin.py:26(__init__)
       14    0.000    0.000    0.001    0.000 storage.py:60(clone)
       25    0.001    0.000    0.001    0.000 {method 'scatter_' of 'torch._C._TensorBase' objects}
       20    0.001    0.000    0.001    0.000 {method 'sub_' of 'torch._C._TensorBase' objects}
      600    0.001    0.000    0.001    0.000 enum.py:628(value)
       25    0.001    0.000    0.001    0.000 {method 'softmax' of 'torch._C._TensorBase' objects}
       90    0.001    0.000    0.001    0.000 {method 'long' of 'torch._C._TensorBase' objects}
       22    0.000    0.000    0.001    0.000 functools.py:37(update_wrapper)
      615    0.001    0.000    0.001    0.000 {method 'lower' of 'str' objects}
        5    0.000    0.000    0.001    0.000 deepmil.py:343(<listcomp>)
      395    0.001    0.000    0.001    0.000 {method 'is_floating_point' of 'torch._C._TensorBase' objects}
      130    0.001    0.000    0.001    0.000 {method 'squeeze' of 'torch._C._TensorBase' objects}
      102    0.000    0.000    0.001    0.000 copy.py:252(_keep_alive)
       40    0.000    0.000    0.001    0.000 checks.py:284(_input_squeeze)
       20    0.001    0.000    0.001    0.000 {built-in method mm}
       50    0.000    0.000    0.001    0.000 trainer.py:1633(world_size)
       50    0.000    0.000    0.001    0.000 warnings.py:21(_warn)
      400    0.001    0.000    0.001    0.000 {built-in method torch._C._get_cudnn_enabled}
       50    0.000    0.000    0.001    0.000 logging.py:341(<dictcomp>)
        5    0.000    0.000    0.001    0.000 loss.py:1149(forward)
       20    0.001    0.000    0.001    0.000 {method 'div_' of 'torch._C._TensorBase' objects}
      465    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_variadic}
       55    0.000    0.000    0.001    0.000 result.py:74(op)
        5    0.000    0.000    0.001    0.000 metric.py:352(wrapped_func)
       11    0.000    0.000    0.001    0.000 result.py:271(_wrap_compute)
      438    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_unary}
       55    0.001    0.000    0.001    0.000 {built-in method _warnings.warn}
      105    0.000    0.000    0.001    0.000 trainer.py:1611(training_type_plugin)
       11    0.000    0.000    0.001    0.000 module.py:250(__init__)
       10    0.000    0.000    0.000    0.000 {built-in method stack}
      418    0.000    0.000    0.000    0.000 dataclasses.py:1009(<genexpr>)
       20    0.000    0.000    0.000    0.000 utils.py:30(_list_with_default)
        5    0.000    0.000    0.000    0.000 functional.py:2767(cross_entropy)
      495    0.000    0.000    0.000    0.000 copy.py:190(_deepcopy_atomic)
       22    0.000    0.000    0.000    0.000 inspect.py:2750(__init__)
       11    0.000    0.000    0.000    0.000 inspect.py:1799(_signature_bound_method)
    35/25    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       35    0.000    0.000    0.000    0.000 memory.py:56(detach_and_move)
       40    0.000    0.000    0.000    0.000 checks.py:51(_check_shape_and_type_consistency)
       66    0.000    0.000    0.000    0.000 copy.py:273(<genexpr>)
       33    0.000    0.000    0.000    0.000 inspect.py:2467(__init__)
       22    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:157(_get_module_lock)
        5    0.000    0.000    0.000    0.000 {built-in method torch._C._nn.cross_entropy_loss}
        5    0.000    0.000    0.000    0.000 activation.py:1225(forward)
       55    0.000    0.000    0.000    0.000 {method 'reshape' of 'torch._C._TensorBase' objects}
       48    0.000    0.000    0.000    0.000 grad_mode.py:213(__init__)
       11    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:147(__enter__)
       57    0.000    0.000    0.000    0.000 abc.py:141(__subclasscheck__)
      160    0.000    0.000    0.000    0.000 {built-in method builtins.iter}
       20    0.000    0.000    0.000    0.000 module.py:568(_apply)
       20    0.000    0.000    0.000    0.000 typing.py:707(__instancecheck__)
       55    0.000    0.000    0.000    0.000 trainer.py:2118(_evaluation_loop)
       20    0.000    0.000    0.000    0.000 {built-in method flatten}
       35    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       14    0.000    0.000    0.000    0.000 __init__.py:265(__init__)
      105    0.000    0.000    0.000    0.000 {built-in method builtins.len}
       11    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:194(_lock_unlock_module)
       22    0.000    0.000    0.000    0.000 typing.py:245(inner)
       10    0.000    0.000    0.000    0.000 metric.py:481(<listcomp>)
    15/10    0.000    0.000    0.000    0.000 contextlib.py:107(__enter__)
       20    0.000    0.000    0.000    0.000 typing.py:710(__subclasscheck__)
       55    0.000    0.000    0.000    0.000 trainer.py:2014(evaluating)
       14    0.000    0.000    0.000    0.000 _utils.py:7(_get_device_index)
    20/15    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
      231    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
       11    0.000    0.000    0.000    0.000 result.py:191(__setstate__)
       61    0.000    0.000    0.000    0.000 result.py:178(is_custom_reduction)
       11    0.000    0.000    0.000    0.000 inspect.py:2843(replace)
       14    0.000    0.000    0.000    0.000 {built-in method tensor}
      220    0.000    0.000    0.000    0.000 {method 'group' of 're.Match' objects}
       67    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}
       57    0.000    0.000    0.000    0.000 {built-in method _abc._abc_subclasscheck}
       25    0.000    0.000    0.000    0.000 {method 'unsqueeze' of 'torch._C._TensorBase' objects}
       22    0.000    0.000    0.000    0.000 version.py:444(_cmpkey)
      170    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
      195    0.000    0.000    0.000    0.000 {method 'is_complex' of 'torch._C._TensorBase' objects}
      187    0.000    0.000    0.000    0.000 result.py:70(op)
      110    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        5    0.000    0.000    0.000    0.000 {built-in method argmax}
       15    0.000    0.000    0.000    0.000 contextlib.py:237(helper)
       14    0.000    0.000    0.000    0.000 grad_mode.py:124(__enter__)
       22    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:176(cb)
       20    0.000    0.000    0.000    0.000 flatten.py:41(forward)
       20    0.000    0.000    0.000    0.000 {built-in method transpose}
       55    0.000    0.000    0.000    0.000 logger_connector.py:296(should_reset_tensors)
        5    0.000    0.000    0.000    0.000 _tensor.py:620(__len__)
       10    0.000    0.000    0.000    0.000 deepmil.py:184(get_metrics_dict)
       20    0.000    0.000    0.000    0.000 module.py:1597(children)
       25    0.000    0.000    0.000    0.000 {method 'expand_as' of 'torch._C._TensorBase' objects}
       65    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        5    0.000    0.000    0.000    0.000 functional.py:1611(_get_softmax_dim)
       22    0.000    0.000    0.000    0.000 {method 'search' of 're.Pattern' objects}
      108    0.000    0.000    0.000    0.000 result.py:162(is_mean_reduction)
       10    0.000    0.000    0.000    0.000 precision_plugin.py:237(val_step_context)
       22    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:58(__init__)
       14    0.000    0.000    0.000    0.000 grad_mode.py:128(__exit__)
        5    0.000    0.000    0.000    0.000 distributed.py:139(distributed_available)
      153    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
       10    0.000    0.000    0.000    0.000 metric.py:317(sync_context)
       11    0.000    0.000    0.000    0.000 inspect.py:484(unwrap)
       44    0.000    0.000    0.000    0.000 typing.py:319(__hash__)
       85    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
       15    0.000    0.000    0.000    0.000 contextlib.py:81(__init__)
       44    0.000    0.000    0.000    0.000 inspect.py:2799(<genexpr>)
       20    0.000    0.000    0.000    0.000 enum.py:595(__format__)
       11    0.000    0.000    0.000    0.000 imports.py:24(_module_available)
       88    0.000    0.000    0.000    0.000 version.py:271(<genexpr>)
       33    0.000    0.000    0.000    0.000 enum.py:284(__call__)
      132    0.000    0.000    0.000    0.000 result.py:80(group)
       22    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:78(acquire)
       39    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C._TensorBase' objects}
      110    0.000    0.000    0.000    0.000 result.py:60(should)
       14    0.000    0.000    0.000    0.000 {method 'set_' of 'torch._C._TensorBase' objects}
       20    0.000    0.000    0.000    0.000 grad_mode.py:220(__exit__)
        5    0.000    0.000    0.000    0.000 metric.py:259(sync)
       55    0.000    0.000    0.000    0.000 fx_validator.py:165(check_logging)
       14    0.000    0.000    0.000    0.000 grad_mode.py:119(__init__)
       14    0.000    0.000    0.000    0.000 _utils.py:476(_get_device_index)
       55    0.000    0.000    0.000    0.000 fx_validator.py:188(check_logging_levels)
       68    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
       22    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        1    0.000    0.000    0.000    0.000 result.py:587(reset)
       22    0.000    0.000    0.000    0.000 <string>:1(__new__)
       22    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:103(release)
       20    0.000    0.000    0.000    0.000 module.py:1606(named_children)
       62    0.000    0.000    0.000    0.000 {built-in method torch._C.is_grad_enabled}
       55    0.000    0.000    0.000    0.000 states.py:75(evaluating)
       20    0.000    0.000    0.000    0.000 {built-in method torch._C._nn._parse_to}
       14    0.000    0.000    0.000    0.000 {method 'new_empty' of 'torch._C._TensorBase' objects}
       11    0.000    0.000    0.000    0.000 {built-in method _operator.ge}
       22    0.000    0.000    0.000    0.000 copyreg.py:87(__newobj__)
       11    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:151(__exit__)
       11    0.000    0.000    0.000    0.000 util.py:73(find_spec)
       50    0.000    0.000    0.000    0.000 {built-in method _operator.xor}
       35    0.000    0.000    0.000    0.000 {built-in method is_floating_point}
        5    0.000    0.000    0.000    0.000 deepmil.py:340(<listcomp>)
       55    0.000    0.000    0.000    0.000 fx_validator.py:177(get_default_logging_levels)
       20    0.000    0.000    0.000    0.000 {method 'flatten' of 'torch._C._TensorBase' objects}
        5    0.000    0.000    0.000    0.000 metric.py:34(jit_distributed_available)
       71    0.000    0.000    0.000    0.000 {method 'values' of 'dict' objects}
        5    0.000    0.000    0.000    0.000 base.py:68(profile)
       22    0.000    0.000    0.000    0.000 inspect.py:158(isfunction)
       25    0.000    0.000    0.000    0.000 {built-in method builtins.max}
       55    0.000    0.000    0.000    0.000 inspect.py:2517(name)
       66    0.000    0.000    0.000    0.000 version.py:393(_parse_letter_version)
       55    0.000    0.000    0.000    0.000 trainer.py:2061(fit_loop)
       14    0.000    0.000    0.000    0.000 _tensor.py:1001(grad)
       44    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x561a1dcdf3c0}
       37    0.000    0.000    0.000    0.000 _collections_abc.py:302(__subclasshook__)
       44    0.000    0.000    0.000    0.000 {built-in method builtins.hash}
       44    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}
       44    0.000    0.000    0.000    0.000 {built-in method _imp.acquire_lock}
       22    0.000    0.000    0.000    0.000 functools.py:67(wraps)
       14    0.000    0.000    0.000    0.000 {method 'storage' of 'torch._C._TensorBase' objects}
       44    0.000    0.000    0.000    0.000 {built-in method _imp.release_lock}
       20    0.000    0.000    0.000    0.000 utils.py:38(<listcomp>)
       44    0.000    0.000    0.000    0.000 {built-in method _thread.get_ident}
        5    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       11    0.000    0.000    0.000    0.000 version.py:87(__ge__)
       10    0.000    0.000    0.000    0.000 __init__.py:8(is_available)
       44    0.000    0.000    0.000    0.000 inspect.py:2529(kind)
        5    0.000    0.000    0.000    0.000 deepmil.py:346(<listcomp>)
        5    0.000    0.000    0.000    0.000 confusion_matrix.py:134(compute)
       11    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:929(_sanity_check)
       10    0.000    0.000    0.000    0.000 distributed_c10d.py:386(is_initialized)
       11    0.000    0.000    0.000    0.000 inspect.py:504(_is_wrapper)
       41    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
       33    0.000    0.000    0.000    0.000 {method 'isidentifier' of 'str' objects}
       33    0.000    0.000    0.000    0.000 enum.py:526(__new__)
       22    0.000    0.000    0.000    0.000 {method 'split' of 'str' objects}
       20    0.000    0.000    0.000    0.000 {method '__format__' of 'str' objects}
       33    0.000    0.000    0.000    0.000 version.py:459(<lambda>)
       22    0.000    0.000    0.000    0.000 {method 'startswith' of 'str' objects}
       11    0.000    0.000    0.000    0.000 {method 'values' of 'mappingproxy' objects}
       20    0.000    0.000    0.000    0.000 deepmil.py:330(get_bag_label)
       20    0.000    0.000    0.000    0.000 metric.py:426(device)
        5    0.000    0.000    0.000    0.000 container.py:360(values)
       28    0.000    0.000    0.000    0.000 _jit_internal.py:957(is_scripting)
       14    0.000    0.000    0.000    0.000 {method 'contiguous' of 'torch._C._TensorBase' objects}
       22    0.000    0.000    0.000    0.000 version.py:432(_parse_local_version)
        5    0.000    0.000    0.000    0.000 container.py:354(items)
       20    0.000    0.000    0.000    0.000 grad_mode.py:217(__enter__)
       11    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:143(__init__)
       11    0.000    0.000    0.000    0.000 {built-in method torch._C.get_default_dtype}
        7    0.000    0.000    0.000    0.000 {method 'copy_' of 'torch._C.FloatStorageBase' objects}
       22    0.000    0.000    0.000    0.000 inspect.py:2521(default)
       14    0.000    0.000    0.000    0.000 {method 'is_neg' of 'torch._C._TensorBase' objects}
       16    0.000    0.000    0.000    0.000 result.py:142(sync)
        7    0.000    0.000    0.000    0.000 {method 'copy_' of 'torch._C.LongStorageBase' objects}
        5    0.000    0.000    0.000    0.000 confusion_matrix.py:56(_confusion_matrix_compute)
       11    0.000    0.000    0.000    0.000 {method '__setstate__' of 'functools.partial' objects}
       14    0.000    0.000    0.000    0.000 {method 'stride' of 'torch._C._TensorBase' objects}
       14    0.000    0.000    0.000    0.000 __init__.py:269(__enter__)
       14    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
       14    0.000    0.000    0.000    0.000 {method 'storage_offset' of 'torch._C._TensorBase' objects}
       14    0.000    0.000    0.000    0.000 {method 'is_conj' of 'torch._C._TensorBase' objects}
        5    0.000    0.000    0.000    0.000 warnings.py:41(warn)
       14    0.000    0.000    0.000    0.000 __init__.py:278(__exit__)
       14    0.000    0.000    0.000    0.000 storage.py:13(__init__)
        5    0.000    0.000    0.000    0.000 _reduction.py:7(get_enum)
       11    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}
        7    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C.FloatStorageBase' objects}
       10    0.000    0.000    0.000    0.000 metric.py:475(<listcomp>)
       11    0.000    0.000    0.000    0.000 inspect.py:2835(parameters)
       10    0.000    0.000    0.000    0.000 precision_plugin.py:226(forward_context)
        7    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C.LongStorageBase' objects}
        1    0.000    0.000    0.000    0.000 result.py:387(__init__)
        5    0.000    0.000    0.000    0.000 result.py:97(__call__)
        5    0.000    0.000    0.000    0.000 base.py:54(trainer)
        5    0.000    0.000    0.000    0.000 distributed.py:359(tpu_distributed)
        5    0.000    0.000    0.000    0.000 result.py:101(no_op)
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:162(model)
        5    0.000    0.000    0.000    0.000 metric.py:295(unsync)
        5    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: validation_step_end
         90 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        5    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        5    0.000    0.000    0.000    0.000 base.py:68(profile)
       10    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        5    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       15    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       10    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        5    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:230(validation_step_end)
        5    0.000    0.000    0.000    0.000 lightning.py:879(validation_step_end)
        5    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_validation_batch_end
         1517 function calls in 0.004 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        5    0.000    0.000    0.004    0.001 callback_hook.py:188(on_validation_batch_end)
        5    0.000    0.000    0.004    0.001 tqdm_progress.py:251(on_validation_batch_end)
        2    0.000    0.000    0.003    0.001 tqdm_progress.py:315(_update_bar)
        1    0.000    0.000    0.003    0.003 std.py:1212(update)
        1    0.000    0.000    0.003    0.003 std.py:1339(refresh)
        1    0.000    0.000    0.003    0.003 std.py:1478(display)
        3    0.000    0.000    0.002    0.001 utils.py:333(disp_len)
        3    0.000    0.000    0.002    0.001 utils.py:329(_text_width)
        8    0.000    0.000    0.002    0.000 {built-in method builtins.sum}
        1    0.000    0.000    0.002    0.002 std.py:1164(__str__)
        1    0.000    0.000    0.001    0.001 std.py:355(format_meter)
      424    0.001    0.000    0.001    0.000 utils.py:330(<genexpr>)
        1    0.000    0.000    0.001    0.001 std.py:348(print_status)
        1    0.000    0.000    0.001    0.001 utils.py:341(disp_trim)
       35    0.000    0.000    0.001    0.000 trainer.py:1682(lightning_module)
       35    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
       35    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
      421    0.000    0.000    0.000    0.000 {built-in method unicodedata.east_asian_width}
        5    0.000    0.000    0.000    0.000 base.py:102(total_val_batches)
       35    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       87    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        5    0.000    0.000    0.000    0.000 trainer.py:1844(enable_validation)
        1    0.000    0.000    0.000    0.000 std.py:1460(format_dict)
        2    0.000    0.000    0.000    0.000 std.py:1455(moveto)
        6    0.000    0.000    0.000    0.000 utils.py:143(inner)
        1    0.000    0.000    0.000    0.000 utils.py:282(_screen_shape_linux)
       35    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        5    0.000    0.000    0.000    0.000 model_helpers.py:22(is_overridden)
        3    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        5    0.000    0.000    0.000    0.000 tqdm_progress.py:312(_should_update)
        5    0.000    0.000    0.000    0.000 trainer.py:2037(current_epoch)
        5    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        5    0.000    0.000    0.000    0.000 tqdm_progress.py:328(convert_inf)
        2    0.000    0.000    0.000    0.000 utils.py:222(_is_ascii)
        8    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       21    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        5    0.000    0.000    0.000    0.000 base.py:68(profile)
       35    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        1    0.000    0.000    0.000    0.000 std.py:342(fp_write)
       40    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        1    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
        5    0.000    0.000    0.000    0.000 tqdm_progress.py:128(is_enabled)
        2    0.000    0.000    0.000    0.000 std.py:288(format_interval)
        5    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 std.py:155(__init__)
        1    0.000    0.000    0.000    0.000 std.py:104(acquire)
       15    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       21    0.000    0.000    0.000    0.000 {built-in method builtins.ord}
       25    0.000    0.000    0.000    0.000 base.py:178(on_validation_batch_end)
        5    0.000    0.000    0.000    0.000 std.py:233(__call__)
        1    0.000    0.000    0.000    0.000 {built-in method now}
        5    0.000    0.000    0.000    0.000 fit_loop.py:55(current_epoch)
       20    0.000    0.000    0.000    0.000 base.py:57(trainer)
        1    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        1    0.000    0.000    0.000    0.000 std.py:188(__format__)
        5    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        5    0.000    0.000    0.000    0.000 {built-in method math.isinf}
        1    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        3    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:1009(_handle_fromlist)
        1    0.000    0.000    0.000    0.000 std.py:108(release)
        3    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        5    0.000    0.000    0.000    0.000 base.py:170(on_validation_batch_end)
       12    0.000    0.000    0.000    0.000 tqdm_progress.py:120(refresh_rate)
        3    0.000    0.000    0.000    0.000 {method 'sub' of 're.Pattern' objects}
       10    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        3    0.000    0.000    0.000    0.000 {built-in method time.time}
        5    0.000    0.000    0.000    0.000 hooks.py:112(on_validation_batch_end)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
        5    0.000    0.000    0.000    0.000 base.py:69(val_batch_idx)
        5    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        5    0.000    0.000    0.000    0.000 trainer.py:2061(fit_loop)
        5    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        5    0.000    0.000    0.000    0.000 {built-in method math.isnan}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.min}
        1    0.000    0.000    0.000    0.000 std.py:169(colour)
        2    0.000    0.000    0.000    0.000 utils.py:319(_term_move_up)
        1    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 utils.py:57(__init__)
        1    0.000    0.000    0.000    0.000 utils.py:61(__format__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        1    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 std.py:165(colour)
        1    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}



Profile stats for: on_validation_epoch_end
         75 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:100(on_validation_epoch_end)
        6    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
        6    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        6    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        6    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        6    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        7    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        6    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        6    0.000    0.000    0.000    0.000 base.py:140(on_validation_epoch_end)
        1    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 hooks.py:205(on_validation_epoch_end)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_epoch_end
         150 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.000    0.000    0.000    0.000 callback_hook.py:130(on_epoch_end)
       12    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
       12    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
       12    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
       12    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       24    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       12    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        2    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 base.py:68(profile)
        2    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       14    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
       12    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       12    0.000    0.000    0.000    0.000 base.py:164(on_epoch_end)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        2    0.000    0.000    0.000    0.000 hooks.py:187(on_epoch_end)
        2    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_validation_end
         1469 function calls (1455 primitive calls) in 0.004 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.004    0.004 callback_hook.py:218(on_validation_end)
        1    0.000    0.000    0.004    0.004 tqdm_progress.py:257(on_validation_end)
        1    0.000    0.000    0.002    0.002 std.py:1416(set_postfix)
        2    0.000    0.000    0.002    0.001 std.py:1478(display)
        1    0.000    0.000    0.002    0.002 std.py:1339(refresh)
        4    0.000    0.000    0.002    0.000 utils.py:333(disp_len)
        4    0.000    0.000    0.002    0.000 utils.py:329(_text_width)
        4    0.000    0.000    0.002    0.000 {built-in method builtins.sum}
        1    0.000    0.000    0.001    0.001 std.py:1164(__str__)
        1    0.000    0.000    0.001    0.001 base.py:185(get_metrics)
      447    0.001    0.000    0.001    0.000 utils.py:330(<genexpr>)
        1    0.000    0.000    0.001    0.001 std.py:355(format_meter)
        2    0.000    0.000    0.001    0.000 std.py:348(print_status)
        1    0.000    0.000    0.001    0.001 utils.py:341(disp_trim)
        1    0.000    0.000    0.001    0.001 trainer.py:2149(progress_bar_metrics)
        1    0.000    0.000    0.001    0.001 logger_connector.py:349(progress_bar_metrics)
        1    0.000    0.000    0.001    0.001 lightning.py:1791(get_progress_bar_dict)
        1    0.000    0.000    0.001    0.001 base.py:217(get_standard_metrics)
        1    0.000    0.000    0.001    0.001 logger_connector.py:317(metrics)
        1    0.000    0.000    0.000    0.000 result.py:547(metrics)
        1    0.000    0.000    0.000    0.000 std.py:1279(close)
      443    0.000    0.000    0.000    0.000 {built-in method unicodedata.east_asian_width}
        1    0.000    0.000    0.000    0.000 supporters.py:93(mean)
        1    0.000    0.000    0.000    0.000 supporters.py:105(_agg_memory)
       72    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 {method 'mean' of 'torch._C._TensorBase' objects}
        9    0.000    0.000    0.000    0.000 utils.py:143(inner)
       22    0.000    0.000    0.000    0.000 apply_func.py:66(apply_to_collection)
        8    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        8    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        5    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
      8/1    0.000    0.000    0.000    0.000 abc.py:141(__subclasscheck__)
      8/1    0.000    0.000    0.000    0.000 {built-in method _abc._abc_subclasscheck}
        2    0.000    0.000    0.000    0.000 std.py:342(fp_write)
        3    0.000    0.000    0.000    0.000 trainer.py:2153(_results)
        3    0.000    0.000    0.000    0.000 trainer.py:2128(_active_loop)
        3    0.000    0.000    0.000    0.000 model_checkpoint.py:324(on_validation_end)
        9    0.000    0.000    0.000    0.000 enums.py:30(__eq__)
        3    0.000    0.000    0.000    0.000 model_checkpoint.py:398(_should_skip_saving_checkpoint)
       11    0.000    0.000    0.000    0.000 result.py:511(_get_cache)
        6    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
        6    0.000    0.000    0.000    0.000 trainer.py:2018(sanity_checking)
        1    0.000    0.000    0.000    0.000 std.py:1460(format_dict)
        1    0.000    0.000    0.000    0.000 std.py:583(_decr_instances)
        6    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
       11    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 std.py:1455(moveto)
        2    0.000    0.000    0.000    0.000 base.py:458(version)
        3    0.000    0.000    0.000    0.000 {method 'join' of 'str' objects}
        6    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 utils.py:282(_screen_shape_linux)
       11    0.000    0.000    0.000    0.000 result.py:536(_forked_name)
        6    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        3    0.000    0.000    0.000    0.000 trainer.py:1959(training)
       18    0.000    0.000    0.000    0.000 types.py:164(__get__)
        2    0.000    0.000    0.000    0.000 utils.py:222(_is_ascii)
        8    0.000    0.000    0.000    0.000 base.py:461(<genexpr>)
        8    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
       12    0.000    0.000    0.000    0.000 result.py:531(<genexpr>)
       11    0.000    0.000    0.000    0.000 result.py:157(forked_name)
        1    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
        1    0.000    0.000    0.000    0.000 _weakrefset.py:106(remove)
       11    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        3    0.000    0.000    0.000    0.000 std.py:104(acquire)
        2    0.000    0.000    0.000    0.000 {method 'remove' of 'set' objects}
        2    0.000    0.000    0.000    0.000 _weakrefset.py:58(__iter__)
        3    0.000    0.000    0.000    0.000 std.py:108(release)
        2    0.000    0.000    0.000    0.000 std.py:288(format_interval)
        6    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:1009(_handle_fromlist)
        4    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
       21    0.000    0.000    0.000    0.000 {built-in method builtins.ord}
       18    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        3    0.000    0.000    0.000    0.000 trainer.py:2033(global_step)
       18    0.000    0.000    0.000    0.000 enum.py:628(value)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 std.py:112(__enter__)
        2    0.000    0.000    0.000    0.000 std.py:115(__exit__)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 utils.py:74(__eq__)
        8    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 std.py:188(__format__)
        1    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       11    0.000    0.000    0.000    0.000 result.py:153(forked)
        1    0.000    0.000    0.000    0.000 {built-in method now}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        3    0.000    0.000    0.000    0.000 trainer.py:2014(evaluating)
        3    0.000    0.000    0.000    0.000 trainer.py:2118(_evaluation_loop)
        3    0.000    0.000    0.000    0.000 std.py:1442(<genexpr>)
        4    0.000    0.000    0.000    0.000 {method 'sub' of 're.Pattern' objects}
       11    0.000    0.000    0.000    0.000 result.py:562(any_tensor)
        2    0.000    0.000    0.000    0.000 std.py:1167(_comparable)
        1    0.000    0.000    0.000    0.000 std.py:1300(fp_write)
        8    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        7    0.000    0.000    0.000    0.000 trainer.py:2061(fit_loop)
        1    0.000    0.000    0.000    0.000 std.py:155(__init__)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:26(__exit__)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
        1    0.000    0.000    0.000    0.000 result.py:528(valid_items)
        2    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        3    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        1    0.000    0.000    0.000    0.000 _weakrefset.py:20(__enter__)
        3    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        1    0.000    0.000    0.000    0.000 fit_loop.py:123(running_loss)
        1    0.000    0.000    0.000    0.000 std.py:1171(__hash__)
        3    0.000    0.000    0.000    0.000 base.py:250(on_validation_end)
        3    0.000    0.000    0.000    0.000 fit_loop.py:65(global_step)
        3    0.000    0.000    0.000    0.000 states.py:75(evaluating)
        1    0.000    0.000    0.000    0.000 std.py:233(__call__)
        1    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        3    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        4    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.sorted}
        3    0.000    0.000    0.000    0.000 {method 'keys' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 tensorboard.py:281(version)
        1    0.000    0.000    0.000    0.000 std.py:605(<lambda>)
        2    0.000    0.000    0.000    0.000 utils.py:319(_term_move_up)
        3    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        2    0.000    0.000    0.000    0.000 {method 'keys' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {built-in method time.time}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        2    0.000    0.000    0.000    0.000 {method 'strip' of 'str' objects}
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:351(on_validation_end)
        1    0.000    0.000    0.000    0.000 lightning.py:265(truncated_bptt_steps)
        1    0.000    0.000    0.000    0.000 hooks.py:49(on_validation_end)
        1    0.000    0.000    0.000    0.000 std.py:169(colour)
        1    0.000    0.000    0.000    0.000 utils.py:57(__init__)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 typing_extensions.py:1067(_dict_new)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:16(__init__)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:52(_commit_removals)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        1    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 std.py:165(colour)
        1    0.000    0.000    0.000    0.000 utils.py:61(__format__)



Profile stats for: on_train_epoch_end
         531922 function calls (519257 primitive calls) in 1.510 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.510    1.510 callback_hook.py:90(on_train_epoch_end)
        3    0.000    0.000    1.510    0.503 model_checkpoint.py:311(on_train_epoch_end)
        3    0.000    0.000    1.510    0.503 model_checkpoint.py:368(save_checkpoint)
        3    0.000    0.000    1.474    0.491 trainer.py:1914(save_checkpoint)
        3    0.000    0.000    1.473    0.491 checkpoint_connector.py:464(save_checkpoint)
        3    0.000    0.000    1.256    0.419 training_type_plugin.py:286(save_checkpoint)
        3    0.003    0.001    1.256    0.419 torch_plugin.py:32(save_checkpoint)
        3    0.000    0.000    1.252    0.417 cloud_io.py:50(atomic_save)
        3    0.004    0.001    1.139    0.380 serialization.py:333(save)
        3    0.218    0.073    1.134    0.378 serialization.py:457(_save)
        3    0.240    0.080    0.831    0.277 {method 'dump' of '_pickle.Pickler' objects}
   192528    0.365    0.000    0.567    0.000 serialization.py:461(persistent_id)
        3    0.000    0.000    0.514    0.171 model_checkpoint.py:669(_save_top_k_checkpoint)
        1    0.000    0.000    0.514    0.514 model_checkpoint.py:697(_update_best_and_save)
        3    0.000    0.000    0.502    0.167 model_checkpoint.py:657(_save_last_checkpoint)
        3    0.000    0.000    0.459    0.153 model_checkpoint.py:682(_save_none_monitor_checkpoint)
        3    0.000    0.000    0.217    0.072 checkpoint_connector.py:335(dump_checkpoint)
        3    0.000    0.000    0.215    0.072 checkpoint_connector.py:474(_get_lightning_module_state_dict)
        3    0.000    0.000    0.215    0.072 training_type_plugin.py:281(lightning_module_state_dict)
    291/3    0.003    0.000    0.214    0.071 module.py:1286(state_dict)
        3    0.000    0.000    0.206    0.069 __init__.py:328(state_dict_hook)
   3123/3    0.074    0.000    0.206    0.069 __init__.py:355(_recurse_update_dict)
   192528    0.192    0.000    0.192    0.000 __init__.py:291(is_storage)
        3    0.000    0.000    0.105    0.035 local.py:316(write)
        3    0.105    0.035    0.105    0.035 {method 'write' of '_io.BufferedWriter' objects}
      418    0.002    0.000    0.083    0.000 storage.py:70(cpu)
      418    0.005    0.000    0.080    0.000 __init__.py:613(type)
18438/9366    0.043    0.000    0.077    0.000 module.py:1653(named_modules)
    60732    0.056    0.000    0.057    0.000 {built-in method builtins.isinstance}
      418    0.006    0.000    0.054    0.000 _utils.py:10(_type)
      358    0.043    0.000    0.043    0.000 {method 'copy_' of 'torch._C.FloatStorageBase' objects}
      360    0.007    0.000    0.022    0.000 metric.py:560(__hash__)
        3    0.000    0.000    0.021    0.007 model_checkpoint.py:652(_monitor_candidates)
      793    0.002    0.000    0.020    0.000 _tensor.py:131(__reduce_ex__)
    153/3    0.002    0.000    0.019    0.006 copy.py:132(deepcopy)
        3    0.000    0.000    0.019    0.006 copy.py:236(_deepcopy_dict)
      793    0.010    0.000    0.018    0.000 _tensor.py:152(_reduce_ex_internal)
     6243    0.006    0.000    0.017    0.000 {method 'add' of 'set' objects}
       69    0.003    0.000    0.016    0.000 _tensor.py:81(__deepcopy__)
        6    0.000    0.000    0.015    0.002 trainer.py:2141(callback_metrics)
        6    0.000    0.000    0.015    0.002 logger_connector.py:335(callback_metrics)
        6    0.000    0.000    0.014    0.002 logger_connector.py:317(metrics)
        6    0.001    0.000    0.013    0.002 result.py:547(metrics)
        3    0.000    0.000    0.013    0.004 model_checkpoint.py:625(_validate_monitor_key)
      132    0.000    0.000    0.012    0.000 apply_func.py:66(apply_to_collection)
      487    0.003    0.000    0.011    0.000 __init__.py:269(__enter__)
       66    0.000    0.000    0.011    0.000 result.py:511(_get_cache)
      487    0.002    0.000    0.011    0.000 __init__.py:265(__init__)
       11    0.000    0.000    0.010    0.001 result.py:273(wrapped_func)
       11    0.000    0.000    0.010    0.001 result.py:247(compute)
        4    0.000    0.000    0.010    0.002 metric.py:352(wrapped_func)
      360    0.002    0.000    0.010    0.000 {built-in method builtins.hash}
      487    0.004    0.000    0.010    0.000 _utils.py:7(_get_device_index)
       69    0.000    0.000    0.009    0.000 storage.py:44(__deepcopy__)
       69    0.001    0.000    0.009    0.000 storage.py:60(clone)
     1848    0.005    0.000    0.008    0.000 _tensor.py:650(__hash__)
        1    0.000    0.000    0.007    0.007 auroc.py:178(compute)
        1    0.000    0.000    0.007    0.007 auroc.py:51(_auroc_compute)
      793    0.003    0.000    0.007    0.000 serialization.py:164(location_tag)
     7116    0.006    0.000    0.006    0.000 {method 'items' of 'collections.OrderedDict' objects}
      487    0.002    0.000    0.006    0.000 __init__.py:477(current_device)
      7/1    0.000    0.000    0.006    0.006 roc.py:202(roc)
      7/1    0.000    0.000    0.006    0.006 roc.py:140(_roc_compute)
     1043    0.002    0.000    0.005    0.000 __init__.py:188(_lazy_init)
        1    0.000    0.000    0.005    0.005 roc.py:99(_roc_compute_multi_class)
      291    0.003    0.000    0.005    0.000 module.py:1249(_save_to_state_dict)
        6    0.001    0.000    0.005    0.001 roc.py:48(_roc_compute_single_class)
        3    0.000    0.000    0.004    0.001 core.py:100(__enter__)
        3    0.000    0.000    0.004    0.001 spec.py:954(open)
        3    0.000    0.000    0.004    0.001 local.py:151(_open)
        3    0.000    0.000    0.004    0.001 local.py:240(__init__)
        3    0.000    0.000    0.004    0.001 local.py:252(_open)
        3    0.004    0.001    0.004    0.001 {built-in method io.open}
      487    0.002    0.000    0.003    0.000 _utils.py:476(_get_device_index)
     1043    0.002    0.000    0.003    0.000 __init__.py:146(is_initialized)
     3114    0.003    0.000    0.003    0.000 {built-in method builtins.getattr}
      790    0.002    0.000    0.003    0.000 serialization.py:121(_cuda_tag)
        6    0.001    0.000    0.003    0.000 precision_recall_curve.py:23(_binary_clf_curve)
     3140    0.003    0.000    0.003    0.000 {method 'items' of 'dict' objects}
        3    0.000    0.000    0.003    0.001 accuracy.py:270(compute)
        3    0.000    0.000    0.003    0.001 accuracy.py:115(_accuracy_compute)
     3189    0.003    0.000    0.003    0.000 {built-in method builtins.id}
        3    0.000    0.000    0.002    0.001 core.py:412(open)
      793    0.001    0.000    0.002    0.000 _namedtensor_internals.py:10(check_serializing_named_tensor)
        3    0.000    0.000    0.002    0.001 core.py:225(open_files)
       60    0.002    0.000    0.002    0.000 {method 'copy_' of 'torch._C.LongStorageBase' objects}
      793    0.002    0.000    0.002    0.000 serialization.py:183(normalize_storage_type)
     1097    0.002    0.000    0.002    0.000 {method 'get_device' of 'torch._C.CudaFloatStorageBase' objects}
       69    0.002    0.000    0.002    0.000 {method 'copy_' of 'torch._C.CudaFloatStorageBase' objects}
        3    0.001    0.000    0.002    0.001 stat_scores.py:183(_reduce_stat_scores)
      447    0.002    0.000    0.002    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.002    0.001 core.py:567(get_fs_token_paths)
     1992    0.002    0.000    0.002    0.000 {built-in method torch._C._has_torch_function_unary}
      862    0.002    0.000    0.002    0.000 {method 'storage' of 'torch._C._TensorBase' objects}
      868    0.002    0.000    0.002    0.000 {method 'size' of 'torch._C._TensorBase' objects}
     1562    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
      225    0.001    0.000    0.001    0.000 module.py:1164(__getattr__)
        6    0.000    0.000    0.001    0.000 re.py:271(_compile)
        3    0.000    0.000    0.001    0.000 accelerator.py:385(optimizer_state)
      487    0.001    0.000    0.001    0.000 {built-in method torch._C._cuda_getDevice}
        3    0.000    0.000    0.001    0.000 accelerator.py:390(<lambda>)
     1540    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
     1097    0.001    0.000    0.001    0.000 {method 'size' of 'torch._C.CudaFloatStorageBase' objects}
        3    0.000    0.000    0.001    0.000 optimizer.py:96(state_dict)
        2    0.000    0.000    0.001    0.001 sre_compile.py:759(compile)
     1043    0.001    0.000    0.001    0.000 {built-in method torch._C._cuda_isInBadFork}
        3    0.000    0.000    0.001    0.000 optimizer.py:118(<listcomp>)
        3    0.000    0.000    0.001    0.000 optimizer.py:110(pack_group)
      192    0.001    0.000    0.001    0.000 parameter.py:39(__reduce_ex__)
      793    0.001    0.000    0.001    0.000 hooks.py:54(warn_if_has_hooks)
      862    0.001    0.000    0.001    0.000 {method 'stride' of 'torch._C._TensorBase' objects}
     1056    0.001    0.000    0.001    0.000 _jit_internal.py:957(is_scripting)
       69    0.000    0.000    0.001    0.000 __init__.py:601(_lazy_new)
       60    0.001    0.000    0.001    0.000 {method 'data_ptr' of 'torch._C.LongStorageBase' objects}
      164    0.001    0.000    0.001    0.000 grad_mode.py:213(__init__)
      862    0.001    0.000    0.001    0.000 {method 'setdefault' of 'dict' objects}
       18    0.000    0.000    0.001    0.000 trainer.py:2153(_results)
      793    0.001    0.000    0.001    0.000 {method 'has_names' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.001    0.000 model_checkpoint.py:542(format_checkpoint_name)
      793    0.001    0.000    0.001    0.000 serialization.py:116(_cpu_tag)
       82    0.000    0.000    0.001    0.000 grad_mode.py:124(__enter__)
       45    0.000    0.000    0.001    0.000 metric.py:504(state_dict)
  932/925    0.001    0.000    0.001    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.001    0.001 auroc.py:158(<listcomp>)
       82    0.000    0.000    0.001    0.000 grad_mode.py:128(__exit__)
        6    0.000    0.000    0.001    0.000 auc.py:46(_auc_compute_without_check)
      862    0.001    0.000    0.001    0.000 {method 'storage_offset' of 'torch._C._TensorBase' objects}
      487    0.001    0.000    0.001    0.000 __init__.py:278(__exit__)
      6/3    0.000    0.000    0.001    0.000 core.py:324(_un_chain)
        3    0.000    0.000    0.001    0.000 model_checkpoint.py:512(_format_checkpoint_name)
        3    0.000    0.000    0.001    0.000 core.py:326(<listcomp>)
       18    0.001    0.000    0.001    0.000 {built-in method where}
        3    0.000    0.000    0.001    0.000 re.py:215(findall)
        6    0.000    0.000    0.001    0.000 local.py:45(makedirs)
        3    0.000    0.000    0.001    0.000 re.py:232(compile)
       36    0.000    0.000    0.001    0.000 trainer.py:1959(training)
        3    0.000    0.000    0.001    0.000 optimizer.py:113(<dictcomp>)
       69    0.001    0.000    0.001    0.000 {method 'new_empty' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.001    0.000 sre_parse.py:919(parse)
       39    0.000    0.000    0.001    0.000 enums.py:30(__eq__)
        3    0.000    0.000    0.001    0.000 callback_hook.py:258(on_save_checkpoint)
      3/2    0.000    0.000    0.001    0.000 sre_parse.py:417(_parse_sub)
       27    0.000    0.000    0.001    0.000 trainer.py:1682(lightning_module)
        6    0.000    0.000    0.001    0.000 os.py:196(makedirs)
      3/2    0.000    0.000    0.001    0.000 sre_parse.py:475(_parse)
       69    0.001    0.000    0.001    0.000 {method 'set_' of 'torch._C._TensorBase' objects}
       12    0.001    0.000    0.001    0.000 {built-in method tensor}
      358    0.001    0.000    0.001    0.000 {method 'element_size' of 'torch._C.FloatStorageBase' objects}
      487    0.001    0.000    0.001    0.000 storage.py:13(__init__)
        6    0.001    0.000    0.001    0.000 {built-in method trapz}
      321    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       20    0.000    0.000    0.000    0.000 {built-in method cat}
        6    0.000    0.000    0.000    0.000 spec.py:53(__call__)
        2    0.000    0.000    0.000    0.000 sre_compile.py:598(_code)
        6    0.000    0.000    0.000    0.000 {built-in method argsort}
       27    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
      358    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C.FloatStorageBase' objects}
       82    0.000    0.000    0.000    0.000 grad_mode.py:119(__init__)
      418    0.000    0.000    0.000    0.000 _utils.py:82(_get_async_or_non_blocking)
       18    0.000    0.000    0.000    0.000 trainer.py:2128(_active_loop)
       18    0.000    0.000    0.000    0.000 fit_loop.py:142(_results)
       30    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
      358    0.000    0.000    0.000    0.000 {method 'data_ptr' of 'torch._C.FloatStorageBase' objects}
       72    0.000    0.000    0.000    0.000 copy.py:252(_keep_alive)
       29    0.000    0.000    0.000    0.000 enums.py:38(__eq__)
       66    0.000    0.000    0.000    0.000 result.py:536(_forked_name)
        6    0.000    0.000    0.000    0.000 functional.py:4111(_pad)
      116    0.000    0.000    0.000    0.000 types.py:164(__get__)
       20    0.000    0.000    0.000    0.000 local.py:182(_strip_protocol)
       72    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x561a1dcdf3c0}
        3    0.000    0.000    0.000    0.000 core.py:305(<listcomp>)
        2    0.000    0.000    0.000    0.000 model_checkpoint.py:640(_get_metric_interpolated_filepath_name)
       30    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
      228    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        3    0.000    0.000    0.000    0.000 optimizer.py:115(<listcomp>)
        3    0.000    0.000    0.000    0.000 cloud_io.py:41(get_filesystem)
       72    0.000    0.000    0.000    0.000 result.py:531(<genexpr>)
        3    0.000    0.000    0.000    0.000 version.py:261(__init__)
      7/2    0.000    0.000    0.000    0.000 sre_compile.py:71(_compile)
       22    0.000    0.000    0.000    0.000 result.py:64(should)
        3    0.000    0.000    0.000    0.000 core.py:121(__exit__)
       69    0.000    0.000    0.000    0.000 _tensor.py:1001(grad)
      291    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
      246    0.000    0.000    0.000    0.000 {built-in method torch._C.is_grad_enabled}
      180    0.000    0.000    0.000    0.000 {method 'get_device' of 'torch._C.CudaLongStorageBase' objects}
        6    0.000    0.000    0.000    0.000 {built-in method constant_pad_nd}
       22    0.000    0.000    0.000    0.000 result.py:90(_generate_sync_fn)
        3    0.000    0.000    0.000    0.000 core.py:153(close)
        6    0.000    0.000    0.000    0.000 {method 'getvalue' of '_io.BytesIO' objects}
       13    0.000    0.000    0.000    0.000 {built-in method posix.stat}
        3    0.000    0.000    0.000    0.000 registry.py:199(get_filesystem_class)
       12    0.000    0.000    0.000    0.000 {built-in method zeros}
        3    0.000    0.000    0.000    0.000 core.py:217(_close)
       66    0.000    0.000    0.000    0.000 result.py:157(forked_name)
      180    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C.CudaLongStorageBase' objects}
        3    0.000    0.000    0.000    0.000 serialization.py:263(_open_zipfile_writer)
        6    0.000    0.000    0.000    0.000 imports.py:114(_fault_tolerant_training)
        7    0.000    0.000    0.000    0.000 roc.py:26(_roc_update)
       33    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:1009(_handle_fromlist)
        3    0.000    0.000    0.000    0.000 model_checkpoint.py:398(_should_skip_saving_checkpoint)
        2    0.000    0.000    0.000    0.000 model_checkpoint.py:748(file_exists)
        6    0.000    0.000    0.000    0.000 utils.py:270(tokenize)
      164    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
        6    0.000    0.000    0.000    0.000 {built-in method posix.mkdir}
        6    0.000    0.000    0.000    0.000 base.py:2420(__reduce__)
        7    0.000    0.000    0.000    0.000 precision_recall_curve.py:64(_precision_recall_curve_update)
        9    0.000    0.000    0.000    0.000 model_checkpoint.py:254(state_key)
        2    0.000    0.000    0.000    0.000 data.py:24(dim_zero_cat)
        6    0.000    0.000    0.000    0.000 genericpath.py:16(exists)
        3    0.000    0.000    0.000    0.000 serialization.py:254(__init__)
        6    0.000    0.000    0.000    0.000 {built-in method cumsum}
        6    0.000    0.000    0.000    0.000 os.py:769(getenv)
       11    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        3    0.000    0.000    0.000    0.000 generic.py:2045(__getstate__)
        2    0.000    0.000    0.000    0.000 sre_compile.py:536(_compile_info)
        2    0.000    0.000    0.000    0.000 spec.py:553(exists)
        7    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 registry.py:229(_import_class)
      116    0.000    0.000    0.000    0.000 enum.py:628(value)
        5    0.000    0.000    0.000    0.000 {method 'sum' of 'torch._C._TensorBase' objects}
      147    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}
        2    0.000    0.000    0.000    0.000 local.py:65(info)
       20    0.000    0.000    0.000    0.000 local.py:200(make_path_posix)
       30    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        6    0.000    0.000    0.000    0.000 {method 'to' of 'torch._C._TensorBase' objects}
      136    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 __init__.py:109(import_module)
        6    0.000    0.000    0.000    0.000 _collections_abc.py:657(get)
       38    0.000    0.000    0.000    0.000 sre_parse.py:164(__getitem__)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:994(_gcd_import)
        3    0.000    0.000    0.000    0.000 core.py:304(<setcomp>)
        6    0.000    0.000    0.000    0.000 posixpath.py:104(split)
        3    0.000    0.000    0.000    0.000 serialization.py:258(__exit__)
        4    0.000    0.000    0.000    0.000 {built-in method isnan}
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:978(_find_and_load)
        9    0.000    0.000    0.000    0.000 base.py:51(_generate_state_key)
        6    0.000    0.000    0.000    0.000 base.py:683(_get_attributes_dict)
       27    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
       60    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C.LongStorageBase' objects}
       69    0.000    0.000    0.000    0.000 {method 'is_neg' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 trainer.py:2018(sanity_checking)
        3    0.000    0.000    0.000    0.000 local.py:174(_parent)
        4    0.000    0.000    0.000    0.000 contextlib.py:107(__enter__)
        6    0.000    0.000    0.000    0.000 os.py:673(__getitem__)
       26    0.000    0.000    0.000    0.000 utils.py:290(stringify_path)
        4    0.000    0.000    0.000    0.000 metric.py:421(__setattr__)
       60    0.000    0.000    0.000    0.000 {method 'element_size' of 'torch._C.LongStorageBase' objects}
        8    0.000    0.000    0.000    0.000 metric.py:317(sync_context)
       69    0.000    0.000    0.000    0.000 {method 'is_conj' of 'torch._C._TensorBase' objects}
        3    0.000    0.000    0.000    0.000 optimizer.py:120(<dictcomp>)
        5    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        3    0.000    0.000    0.000    0.000 core.py:634(<listcomp>)
        3    0.000    0.000    0.000    0.000 core.py:530(expand_paths_if_needed)
        9    0.000    0.000    0.000    0.000 {built-in method builtins.repr}
       51    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
       17    0.000    0.000    0.000    0.000 sre_parse.py:254(get)
       30    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       69    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}
        3    0.000    0.000    0.000    0.000 posixpath.py:154(dirname)
       75    0.000    0.000    0.000    0.000 copy.py:190(_deepcopy_atomic)
       12    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        9    0.000    0.000    0.000    0.000 trainer.py:2037(current_epoch)
        4    0.000    0.000    0.000    0.000 module.py:1180(__setattr__)
       66    0.000    0.000    0.000    0.000 result.py:153(forked)
        2    0.000    0.000    0.000    0.000 sre_compile.py:276(_optimize_charset)
        3    0.000    0.000    0.000    0.000 posixpath.py:75(join)
        3    0.000    0.000    0.000    0.000 trainer.py:1773(is_global_zero)
        3    0.000    0.000    0.000    0.000 serialization.py:228(_open_file_like)
      8/3    0.000    0.000    0.000    0.000 sre_parse.py:174(getwidth)
        6    0.000    0.000    0.000    0.000 base.py:688(<dictcomp>)
       66    0.000    0.000    0.000    0.000 result.py:562(any_tensor)
        6    0.000    0.000    0.000    0.000 config.py:66(apply_config)
        2    0.000    0.000    0.000    0.000 enum.py:836(__and__)
        4    0.000    0.000    0.000    0.000 metric.py:259(sync)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.sorted}
        5    0.000    0.000    0.000    0.000 genericpath.py:39(isdir)
        3    0.000    0.000    0.000    0.000 core.py:308(<listcomp>)
        3    0.000    0.000    0.000    0.000 version.py:444(_cmpkey)
        3    0.000    0.000    0.000    0.000 {method 'flush' of '_io._IOBase' objects}
        3    0.000    0.000    0.000    0.000 local.py:334(close)
        3    0.000    0.000    0.000    0.000 generic.py:2053(<dictcomp>)
       44    0.000    0.000    0.000    0.000 {method 'startswith' of 'str' objects}
        2    0.000    0.000    0.000    0.000 {built-in method ones_like}
        9    0.000    0.000    0.000    0.000 trainer.py:2033(global_step)
        2    0.000    0.000    0.000    0.000 data.py:27(<listcomp>)
       33    0.000    0.000    0.000    0.000 result.py:60(should)
       47    0.000    0.000    0.000    0.000 result.py:142(sync)
        3    0.000    0.000    0.000    0.000 trainer.py:1619(global_rank)
        6    0.000    0.000    0.000    0.000 {built-in method _hashlib.openssl_md5}
        3    0.000    0.000    0.000    0.000 {method 'close' of '_io.BufferedWriter' objects}
        6    0.000    0.000    0.000    0.000 os.py:751(encode)
        4    0.000    0.000    0.000    0.000 sre_compile.py:423(_simple)
        3    0.000    0.000    0.000    0.000 base.py:384(after_save_checkpoint)
       45    0.000    0.000    0.000    0.000 trainer.py:2061(fit_loop)
       15    0.000    0.000    0.000    0.000 sre_parse.py:160(__len__)
       23    0.000    0.000    0.000    0.000 sre_parse.py:233(__next)
        4    0.000    0.000    0.000    0.000 metric.py:34(jit_distributed_available)
       12    0.000    0.000    0.000    0.000 posixpath.py:41(_get_sep)
       32    0.000    0.000    0.000    0.000 {method 'rstrip' of 'str' objects}
        3    0.000    0.000    0.000    0.000 core.py:601(<listcomp>)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:157(_get_module_lock)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:147(__enter__)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.all}
        1    0.000    0.000    0.000    0.000 {built-in method stack}
        6    0.000    0.000    0.000    0.000 serialization.py:193(_is_path)
       30    0.000    0.000    0.000    0.000 {method 'group' of 're.Match' objects}
        6    0.000    0.000    0.000    0.000 result.py:528(valid_items)
        3    0.000    0.000    0.000    0.000 trainer.py:2049(max_steps)
        3    0.000    0.000    0.000    0.000 optimizer.py:112(<dictcomp>)
       10    0.000    0.000    0.000    0.000 sre_parse.py:286(tell)
        3    0.000    0.000    0.000    0.000 {method 'search' of 're.Pattern' objects}
        9    0.000    0.000    0.000    0.000 model_checkpoint.py:351(on_save_checkpoint)
        6    0.000    0.000    0.000    0.000 hparams_mixin.py:127(hparams)
        3    0.000    0.000    0.000    0.000 core.py:60(__init__)
        4    0.000    0.000    0.000    0.000 contextlib.py:237(helper)
        3    0.000    0.000    0.000    0.000 stat_scores.py:227(_get_final_stats)
      3/2    0.000    0.000    0.000    0.000 sre_compile.py:461(_get_literal_prefix)
       13    0.000    0.000    0.000    0.000 {method 'flatten' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 {built-in method mean}
       15    0.000    0.000    0.000    0.000 blocks.py:238(mgr_locs)
        6    0.000    0.000    0.000    0.000 enum.py:613(__reduce_ex__)
        1    0.000    0.000    0.000    0.000 {method 'reshape' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 {method 'transpose' of 'torch._C._TensorBase' objects}
       15    0.000    0.000    0.000    0.000 fit_loop.py:65(global_step)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        6    0.000    0.000    0.000    0.000 _VF.py:25(__getattr__)
       14    0.000    0.000    0.000    0.000 sre_parse.py:249(match)
       17    0.000    0.000    0.000    0.000 {built-in method builtins.min}
       12    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
        9    0.000    0.000    0.000    0.000 fit_loop.py:55(current_epoch)
        3    0.000    0.000    0.000    0.000 core.py:170(__init__)
        3    0.000    0.000    0.000    0.000 utils.py:97(update_storage_options)
        1    0.000    0.000    0.000    0.000 sre_parse.py:96(closegroup)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:194(_lock_unlock_module)
        9    0.000    0.000    0.000    0.000 {method 'rfind' of 'str' objects}
       22    0.000    0.000    0.000    0.000 result.py:70(op)
        3    0.000    0.000    0.000    0.000 flags.py:96(__getitem__)
        4    0.000    0.000    0.000    0.000 enum.py:284(__call__)
        3    0.000    0.000    0.000    0.000 local.py:348(__getattr__)
        3    0.000    0.000    0.000    0.000 core.py:207(__getitem__)
        2    0.000    0.000    0.000    0.000 sre_compile.py:249(_compile_charset)
        7    0.000    0.000    0.000    0.000 sre_parse.py:172(append)
       20    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
       22    0.000    0.000    0.000    0.000 result.py:80(group)
       11    0.000    0.000    0.000    0.000 result.py:291(__setattr__)
       18    0.000    0.000    0.000    0.000 base.py:54(trainer)
        1    0.000    0.000    0.000    0.000 registry.py:43(register_implementation)
        6    0.000    0.000    0.000    0.000 typing_extensions.py:1067(_dict_new)
        9    0.000    0.000    0.000    0.000 pathlib.py:628(__reduce__)
        2    0.000    0.000    0.000    0.000 sre_parse.py:224(__init__)
        6    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
        6    0.000    0.000    0.000    0.000 local.py:337(closed)
       12    0.000    0.000    0.000    0.000 version.py:271(<genexpr>)
        6    0.000    0.000    0.000    0.000 base.py:1449(name)
        4    0.000    0.000    0.000    0.000 contextlib.py:81(__init__)
        6    0.000    0.000    0.000    0.000 serialization.py:199(__init__)
        3    0.000    0.000    0.000    0.000 core.py:512(split_protocol)
       12    0.000    0.000    0.000    0.000 {built-in method posix.fspath}
        3    0.000    0.000    0.000    0.000 core.py:124(__del__)
        3    0.000    0.000    0.000    0.000 core.py:547(<listcomp>)
        1    0.000    0.000    0.000    0.000 sre_parse.py:343(_escape)
        6    0.000    0.000    0.000    0.000 {method 'hexdigest' of '_hashlib.HASH' objects}
        3    0.000    0.000    0.000    0.000 dataset.py:78(__getattr__)
        6    0.000    0.000    0.000    0.000 sre_parse.py:81(groups)
       14    0.000    0.000    0.000    0.000 result.py:97(__call__)
        3    0.000    0.000    0.000    0.000 training_type_plugin.py:326(should_rank_save_checkpoint)
        1    0.000    0.000    0.000    0.000 sre_parse.py:84(opengroup)
        2    0.000    0.000    0.000    0.000 sre_parse.py:408(_uniq)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:58(__init__)
        3    0.000    0.000    0.000    0.000 <string>:1(__new__)
        4    0.000    0.000    0.000    0.000 __init__.py:8(is_available)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:176(cb)
       14    0.000    0.000    0.000    0.000 single_device.py:45(reduce)
        3    0.000    0.000    0.000    0.000 trainer.py:1699(lr_schedulers)
        3    0.000    0.000    0.000    0.000 serialization.py:314(_check_dill_version)
        4    0.000    0.000    0.000    0.000 sre_compile.py:595(isstring)
       10    0.000    0.000    0.000    0.000 {built-in method _thread.get_ident}
        3    0.000    0.000    0.000    0.000 {method 'findall' of 're.Pattern' objects}
        9    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}
        8    0.000    0.000    0.000    0.000 {method 'find' of 'bytearray' objects}
        7    0.000    0.000    0.000    0.000 result.py:162(is_mean_reduction)
        6    0.000    0.000    0.000    0.000 generic.py:345(flags)
        1    0.000    0.000    0.000    0.000 sre_parse.py:295(_class_escape)
        6    0.000    0.000    0.000    0.000 {method 'replace' of 'str' objects}
        4    0.000    0.000    0.000    0.000 {method 'rsplit' of 'str' objects}
        6    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C.DoubleStorageBase' objects}
        3    0.000    0.000    0.000    0.000 trainer.py:1615(precision_plugin)
        3    0.000    0.000    0.000    0.000 serialization.py:224(__exit__)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:78(acquire)
        2    0.000    0.000    0.000    0.000 {built-in method _sre.compile}
        4    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        3    0.000    0.000    0.000    0.000 trainer.py:1686(optimizers)
        9    0.000    0.000    0.000    0.000 hooks.py:802(on_save_checkpoint)
        4    0.000    0.000    0.000    0.000 registry.py:36(__contains__)
        6    0.000    0.000    0.000    0.000 core.py:504(get_compression)
        3    0.000    0.000    0.000    0.000 spec.py:143(_fs_token)
        9    0.000    0.000    0.000    0.000 version.py:393(_parse_letter_version)
        7    0.000    0.000    0.000    0.000 sre_parse.py:111(__init__)
        2    0.000    0.000    0.000    0.000 sre_parse.py:903(fix_flags)
        6    0.000    0.000    0.000    0.000 {method 'flush' of '_io.BytesIO' objects}
        9    0.000    0.000    0.000    0.000 base.py:75(after_save_checkpoint)
        9    0.000    0.000    0.000    0.000 base.py:283(on_save_checkpoint)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:103(release)
        3    0.000    0.000    0.000    0.000 {method 'split' of 'str' objects}
        6    0.000    0.000    0.000    0.000 {method 'clear' of 'list' objects}
        6    0.000    0.000    0.000    0.000 fit_loop.py:70(global_step)
        6    0.000    0.000    0.000    0.000 core.py:627(<genexpr>)
        4    0.000    0.000    0.000    0.000 enum.py:526(__new__)
        3    0.000    0.000    0.000    0.000 {built-in method _weakref.proxy}
        6    0.000    0.000    0.000    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
        6    0.000    0.000    0.000    0.000 core.py:636(<genexpr>)
        6    0.000    0.000    0.000    0.000 spec.py:56(<genexpr>)
        6    0.000    0.000    0.000    0.000 version.py:459(<lambda>)
        4    0.000    0.000    0.000    0.000 distributed_c10d.py:386(is_initialized)
        1    0.000    0.000    0.000    0.000 sre_compile.py:432(_generate_overlap_table)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:151(__exit__)
        5    0.000    0.000    0.000    0.000 {built-in method _stat.S_ISDIR}
        6    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        3    0.000    0.000    0.000    0.000 {method 'keys' of 'dict' objects}
        3    0.000    0.000    0.000    0.000 fit_loop.py:102(max_steps)
        3    0.000    0.000    0.000    0.000 training_type_plugin.py:42(checkpoint_io)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:485(check_monitor_top_k)
        6    0.000    0.000    0.000    0.000 serialization.py:202(__enter__)
        3    0.000    0.000    0.000    0.000 generic.py:2047(<dictcomp>)
        3    0.000    0.000    0.000    0.000 generic.py:324(attrs)
        3    0.000    0.000    0.000    0.000 flags.py:51(allows_duplicate_labels)
        4    0.000    0.000    0.000    0.000 sre_compile.py:453(_get_iscased)
        2    0.000    0.000    0.000    0.000 sre_parse.py:76(__init__)
        4    0.000    0.000    0.000    0.000 sre_parse.py:168(__setitem__)
        4    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}
        3    0.000    0.000    0.000    0.000 {method 'element_size' of 'torch._C.DoubleStorageBase' objects}
        3    0.000    0.000    0.000    0.000 {method 'data_ptr' of 'torch._C.DoubleStorageBase' objects}
        4    0.000    0.000    0.000    0.000 metric.py:295(unsync)
        1    0.000    0.000    0.000    0.000 sre_compile.py:492(_get_charset_prefix)
        4    0.000    0.000    0.000    0.000 {built-in method _imp.acquire_lock}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.ord}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.sum}
        3    0.000    0.000    0.000    0.000 utilities.py:173(_is_max_limit_reached)
        3    0.000    0.000    0.000    0.000 single_device.py:73(is_global_zero)
        3    0.000    0.000    0.000    0.000 registry.py:24(__getitem__)
        3    0.000    0.000    0.000    0.000 spec.py:178(_get_kwargs_from_urls)
        3    0.000    0.000    0.000    0.000 version.py:326(release)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:929(_sanity_check)
        3    0.000    0.000    0.000    0.000 {method 'endswith' of 'str' objects}
        3    0.000    0.000    0.000    0.000 {function OpenFiles.__getitem__ at 0x7f1ab8d7a488}
        2    0.000    0.000    0.000    0.000 single_device.py:80(broadcast)
        3    0.000    0.000    0.000    0.000 version.py:432(_parse_local_version)
        3    0.000    0.000    0.000    0.000 base.py:126(on_train_epoch_end)
        4    0.000    0.000    0.000    0.000 {built-in method _imp.release_lock}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.iter}
        1    0.000    0.000    0.000    0.000 {method 'insert' of 'list' objects}
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:694(_is_valid_monitor_key)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        2    0.000    0.000    0.000    0.000 sre_compile.py:65(_combine_flags)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:143(__init__)
        1    0.000    0.000    0.000    0.000 hooks.py:193(on_train_epoch_end)



Profile stats for: on_train_end
         177195 function calls (172984 primitive calls) in 0.601 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.601    0.601 callback_hook.py:140(on_train_end)
        3    0.000    0.000    0.598    0.199 model_checkpoint.py:335(on_train_end)
        1    0.000    0.000    0.592    0.592 model_checkpoint.py:657(_save_last_checkpoint)
        1    0.000    0.000    0.591    0.591 trainer.py:1914(save_checkpoint)
        1    0.000    0.000    0.591    0.591 checkpoint_connector.py:464(save_checkpoint)
        1    0.000    0.000    0.522    0.522 training_type_plugin.py:286(save_checkpoint)
        1    0.001    0.001    0.522    0.522 torch_plugin.py:32(save_checkpoint)
        1    0.000    0.000    0.521    0.521 cloud_io.py:50(atomic_save)
        1    0.001    0.001    0.353    0.353 serialization.py:333(save)
        1    0.067    0.067    0.351    0.351 serialization.py:457(_save)
        1    0.072    0.072    0.258    0.258 {method 'dump' of '_pickle.Pickler' objects}
    64186    0.117    0.000    0.179    0.000 serialization.py:461(persistent_id)
        1    0.000    0.000    0.118    0.118 core.py:121(__exit__)
        1    0.000    0.000    0.118    0.118 core.py:153(close)
        1    0.000    0.000    0.118    0.118 core.py:217(_close)
        1    0.000    0.000    0.118    0.118 local.py:334(close)
        1    0.118    0.118    0.118    0.118 {method 'close' of '_io.BufferedWriter' objects}
        1    0.000    0.000    0.069    0.069 checkpoint_connector.py:335(dump_checkpoint)
        1    0.000    0.000    0.068    0.068 checkpoint_connector.py:474(_get_lightning_module_state_dict)
        1    0.000    0.000    0.068    0.068 training_type_plugin.py:281(lightning_module_state_dict)
     97/1    0.001    0.000    0.068    0.068 module.py:1286(state_dict)
        1    0.000    0.000    0.066    0.066 __init__.py:328(state_dict_hook)
   1041/1    0.025    0.000    0.066    0.066 __init__.py:355(_recurse_update_dict)
    64186    0.060    0.000    0.060    0.000 __init__.py:291(is_storage)
        1    0.000    0.000    0.043    0.043 local.py:316(write)
        1    0.043    0.043    0.043    0.043 {method 'write' of '_io.BufferedWriter' objects}
      140    0.001    0.000    0.026    0.000 storage.py:70(cpu)
      140    0.002    0.000    0.025    0.000 __init__.py:613(type)
6146/3122    0.014    0.000    0.023    0.000 module.py:1653(named_modules)
    20162    0.018    0.000    0.018    0.000 {built-in method builtins.isinstance}
      140    0.002    0.000    0.016    0.000 _utils.py:10(_type)
      120    0.013    0.000    0.013    0.000 {method 'copy_' of 'torch._C.FloatStorageBase' objects}
        1    0.000    0.000    0.006    0.006 model_checkpoint.py:652(_monitor_candidates)
        1    0.000    0.000    0.006    0.006 core.py:100(__enter__)
        1    0.000    0.000    0.006    0.006 spec.py:954(open)
        1    0.000    0.000    0.006    0.006 local.py:151(_open)
        1    0.000    0.000    0.006    0.006 local.py:240(__init__)
        1    0.000    0.000    0.006    0.006 local.py:252(_open)
        1    0.006    0.006    0.006    0.006 {built-in method io.open}
     51/1    0.000    0.000    0.006    0.006 copy.py:132(deepcopy)
        1    0.000    0.000    0.006    0.006 copy.py:236(_deepcopy_dict)
      265    0.001    0.000    0.006    0.000 _tensor.py:131(__reduce_ex__)
      120    0.002    0.000    0.005    0.000 metric.py:560(__hash__)
      265    0.003    0.000    0.005    0.000 _tensor.py:152(_reduce_ex_internal)
       23    0.001    0.000    0.005    0.000 _tensor.py:81(__deepcopy__)
     2082    0.002    0.000    0.004    0.000 {method 'add' of 'set' objects}
      163    0.001    0.000    0.004    0.000 __init__.py:269(__enter__)
      163    0.001    0.000    0.004    0.000 __init__.py:265(__init__)
      163    0.001    0.000    0.003    0.000 _utils.py:7(_get_device_index)
       23    0.000    0.000    0.003    0.000 storage.py:44(__deepcopy__)
       23    0.000    0.000    0.002    0.000 storage.py:60(clone)
        1    0.000    0.000    0.002    0.002 tqdm_progress.py:263(on_train_end)
        1    0.000    0.000    0.002    0.002 std.py:1279(close)
        1    0.000    0.000    0.002    0.002 std.py:1478(display)
     2372    0.002    0.000    0.002    0.000 {method 'items' of 'collections.OrderedDict' objects}
      163    0.001    0.000    0.002    0.000 __init__.py:477(current_device)
      120    0.000    0.000    0.002    0.000 {built-in method builtins.hash}
      349    0.001    0.000    0.002    0.000 __init__.py:188(_lazy_init)
      265    0.001    0.000    0.002    0.000 serialization.py:164(location_tag)
        3    0.000    0.000    0.002    0.001 utils.py:333(disp_len)
        3    0.000    0.000    0.002    0.001 utils.py:329(_text_width)
        4    0.000    0.000    0.002    0.000 {built-in method builtins.sum}
      456    0.001    0.000    0.002    0.000 _tensor.py:650(__hash__)
        1    0.000    0.000    0.001    0.001 std.py:1164(__str__)
       97    0.001    0.000    0.001    0.000 module.py:1249(_save_to_state_dict)
        1    0.000    0.000    0.001    0.001 std.py:355(format_meter)
      446    0.001    0.000    0.001    0.000 utils.py:330(<genexpr>)
      163    0.001    0.000    0.001    0.000 _utils.py:476(_get_device_index)
      349    0.001    0.000    0.001    0.000 __init__.py:146(is_initialized)
     1045    0.001    0.000    0.001    0.000 {method 'items' of 'dict' objects}
     1042    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
      264    0.001    0.000    0.001    0.000 serialization.py:121(_cuda_tag)
        1    0.000    0.000    0.001    0.001 std.py:348(print_status)
       20    0.001    0.000    0.001    0.000 {method 'copy_' of 'torch._C.LongStorageBase' objects}
        1    0.000    0.000    0.001    0.001 utils.py:341(disp_trim)
       23    0.001    0.000    0.001    0.000 {method 'copy_' of 'torch._C.CudaFloatStorageBase' objects}
        1    0.000    0.000    0.001    0.001 core.py:412(open)
      265    0.000    0.000    0.001    0.000 _namedtensor_internals.py:10(check_serializing_named_tensor)
        1    0.000    0.000    0.001    0.001 core.py:225(open_files)
      265    0.000    0.000    0.001    0.000 serialization.py:183(normalize_storage_type)
      904    0.001    0.000    0.001    0.000 {built-in method builtins.id}
      288    0.001    0.000    0.001    0.000 {method 'storage' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:2141(callback_metrics)
        1    0.000    0.000    0.000    0.000 logger_connector.py:335(callback_metrics)
      367    0.000    0.000    0.000    0.000 {method 'get_device' of 'torch._C.CudaFloatStorageBase' objects}
      163    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_getDevice}
      443    0.000    0.000    0.000    0.000 {built-in method unicodedata.east_asian_width}
      288    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C._TensorBase' objects}
      528    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       75    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
      134    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
      349    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_isInBadFork}
        1    0.000    0.000    0.000    0.000 logger_connector.py:317(metrics)
      349    0.000    0.000    0.000    0.000 _jit_internal.py:957(is_scripting)
        1    0.000    0.000    0.000    0.000 accelerator.py:385(optimizer_state)
        1    0.000    0.000    0.000    0.000 accelerator.py:390(<lambda>)
      481    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        1    0.000    0.000    0.000    0.000 optimizer.py:96(state_dict)
      367    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C.CudaFloatStorageBase' objects}
      502    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
       23    0.000    0.000    0.000    0.000 __init__.py:601(_lazy_new)
        1    0.000    0.000    0.000    0.000 optimizer.py:118(<listcomp>)
       64    0.000    0.000    0.000    0.000 parameter.py:39(__reduce_ex__)
        1    0.000    0.000    0.000    0.000 optimizer.py:110(pack_group)
       15    0.000    0.000    0.000    0.000 metric.py:504(state_dict)
       46    0.000    0.000    0.000    0.000 grad_mode.py:213(__init__)
       13    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
        1    0.000    0.000    0.000    0.000 result.py:547(metrics)
      288    0.000    0.000    0.000    0.000 {method 'stride' of 'torch._C._TensorBase' objects}
      288    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
      163    0.000    0.000    0.000    0.000 __init__.py:278(__exit__)
        1    0.000    0.000    0.000    0.000 core.py:567(get_fs_token_paths)
       23    0.000    0.000    0.000    0.000 grad_mode.py:124(__enter__)
      265    0.000    0.000    0.000    0.000 serialization.py:116(_cpu_tag)
      265    0.000    0.000    0.000    0.000 {method 'has_names' of 'torch._C._TensorBase' objects}
      288    0.000    0.000    0.000    0.000 {method 'storage_offset' of 'torch._C._TensorBase' objects}
       23    0.000    0.000    0.000    0.000 {method 'new_empty' of 'torch._C._TensorBase' objects}
       23    0.000    0.000    0.000    0.000 grad_mode.py:128(__exit__)
      277    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        2    0.000    0.000    0.000    0.000 local.py:45(makedirs)
       13    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
      265    0.000    0.000    0.000    0.000 hooks.py:54(warn_if_has_hooks)
        1    0.000    0.000    0.000    0.000 optimizer.py:113(<dictcomp>)
       14    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 core.py:170(__init__)
        1    0.000    0.000    0.000    0.000 callback_hook.py:258(on_save_checkpoint)
        2    0.000    0.000    0.000    0.000 os.py:196(makedirs)
       23    0.000    0.000    0.000    0.000 {method 'set_' of 'torch._C._TensorBase' objects}
      163    0.000    0.000    0.000    0.000 storage.py:13(__init__)
        9    0.000    0.000    0.000    0.000 enums.py:30(__eq__)
       14    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
      120    0.000    0.000    0.000    0.000 {method 'element_size' of 'torch._C.FloatStorageBase' objects}
        3    0.000    0.000    0.000    0.000 model_checkpoint.py:398(_should_skip_saving_checkpoint)
        3    0.000    0.000    0.000    0.000 trainer.py:2153(_results)
      120    0.000    0.000    0.000    0.000 {method 'data_ptr' of 'torch._C.FloatStorageBase' objects}
      140    0.000    0.000    0.000    0.000 _utils.py:82(_get_async_or_non_blocking)
       24    0.000    0.000    0.000    0.000 copy.py:252(_keep_alive)
       84    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
      120    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C.FloatStorageBase' objects}
        2    0.000    0.000    0.000    0.000 spec.py:53(__call__)
       20    0.000    0.000    0.000    0.000 {method 'element_size' of 'torch._C.LongStorageBase' objects}
       23    0.000    0.000    0.000    0.000 grad_mode.py:119(__init__)
        1    0.000    0.000    0.000    0.000 core.py:305(<listcomp>)
        1    0.000    0.000    0.000    0.000 std.py:583(_decr_instances)
        6    0.000    0.000    0.000    0.000 trainer.py:1959(training)
       14    0.000    0.000    0.000    0.000 apply_func.py:66(apply_to_collection)
       24    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x561a1dcdf3c0}
        6    0.000    0.000    0.000    0.000 local.py:182(_strip_protocol)
      101    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 version.py:261(__init__)
       16    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:1009(_handle_fromlist)
        1    0.000    0.000    0.000    0.000 optimizer.py:115(<listcomp>)
       97    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
       23    0.000    0.000    0.000    0.000 _tensor.py:1001(grad)
        1    0.000    0.000    0.000    0.000 cloud_io.py:41(get_filesystem)
        1    0.000    0.000    0.000    0.000 std.py:1460(format_dict)
        3    0.000    0.000    0.000    0.000 trainer.py:2018(sanity_checking)
        2    0.000    0.000    0.000    0.000 {method 'getvalue' of '_io.BytesIO' objects}
        3    0.000    0.000    0.000    0.000 fit_loop.py:142(_results)
       69    0.000    0.000    0.000    0.000 {built-in method torch._C.is_grad_enabled}
        3    0.000    0.000    0.000    0.000 trainer.py:2128(_active_loop)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:542(format_checkpoint_name)
       60    0.000    0.000    0.000    0.000 {method 'get_device' of 'torch._C.CudaLongStorageBase' objects}
        2    0.000    0.000    0.000    0.000 imports.py:114(_fault_tolerant_training)
       14    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        2    0.000    0.000    0.000    0.000 base.py:2420(__reduce__)
       18    0.000    0.000    0.000    0.000 types.py:164(__get__)
        1    0.000    0.000    0.000    0.000 utils.py:282(_screen_shape_linux)
        4    0.000    0.000    0.000    0.000 {built-in method posix.stat}
       60    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C.CudaLongStorageBase' objects}
        4    0.000    0.000    0.000    0.000 utils.py:143(inner)
        1    0.000    0.000    0.000    0.000 serialization.py:263(_open_zipfile_writer)
        2    0.000    0.000    0.000    0.000 genericpath.py:16(exists)
       46    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
        2    0.000    0.000    0.000    0.000 utils.py:270(tokenize)
        7    0.000    0.000    0.000    0.000 result.py:511(_get_cache)
        2    0.000    0.000    0.000    0.000 utils.py:222(_is_ascii)
        2    0.000    0.000    0.000    0.000 os.py:769(getenv)
        1    0.000    0.000    0.000    0.000 serialization.py:254(__init__)
        7    0.000    0.000    0.000    0.000 result.py:536(_forked_name)
        1    0.000    0.000    0.000    0.000 std.py:342(fp_write)
        3    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        2    0.000    0.000    0.000    0.000 _collections_abc.py:657(get)
        1    0.000    0.000    0.000    0.000 serialization.py:258(__exit__)
      2/1    0.000    0.000    0.000    0.000 core.py:324(_un_chain)
        3    0.000    0.000    0.000    0.000 model_checkpoint.py:254(state_key)
        8    0.000    0.000    0.000    0.000 result.py:531(<genexpr>)
        1    0.000    0.000    0.000    0.000 generic.py:2045(__getstate__)
        2    0.000    0.000    0.000    0.000 std.py:115(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method posix.mkdir}
        6    0.000    0.000    0.000    0.000 local.py:200(make_path_posix)
        2    0.000    0.000    0.000    0.000 posixpath.py:104(split)
       48    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}
        1    0.000    0.000    0.000    0.000 core.py:304(<setcomp>)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:106(remove)
       14    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
       23    0.000    0.000    0.000    0.000 {method 'is_conj' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 core.py:326(<listcomp>)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:512(_format_checkpoint_name)
        2    0.000    0.000    0.000    0.000 os.py:673(__getitem__)
       20    0.000    0.000    0.000    0.000 {method 'data_ptr' of 'torch._C.LongStorageBase' objects}
        5    0.000    0.000    0.000    0.000 trainer.py:2033(global_step)
        2    0.000    0.000    0.000    0.000 base.py:683(_get_attributes_dict)
        1    0.000    0.000    0.000    0.000 local.py:174(_parent)
        2    0.000    0.000    0.000    0.000 std.py:1300(fp_write)
        2    0.000    0.000    0.000    0.000 {method 'remove' of 'set' objects}
       23    0.000    0.000    0.000    0.000 {method 'is_neg' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 config.py:66(apply_config)
        1    0.000    0.000    0.000    0.000 core.py:634(<listcomp>)
        2    0.000    0.000    0.000    0.000 std.py:112(__enter__)
       25    0.000    0.000    0.000    0.000 copy.py:190(_deepcopy_atomic)
       23    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}
        9    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
       20    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C.LongStorageBase' objects}
       21    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        2    0.000    0.000    0.000    0.000 std.py:288(format_interval)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:58(__iter__)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        7    0.000    0.000    0.000    0.000 result.py:157(forked_name)
        3    0.000    0.000    0.000    0.000 base.py:51(_generate_state_key)
        2    0.000    0.000    0.000    0.000 genericpath.py:39(isdir)
        8    0.000    0.000    0.000    0.000 utils.py:290(stringify_path)
        1    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
        1    0.000    0.000    0.000    0.000 posixpath.py:75(join)
        1    0.000    0.000    0.000    0.000 posixpath.py:154(dirname)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.sorted}
        1    0.000    0.000    0.000    0.000 optimizer.py:120(<dictcomp>)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 std.py:104(acquire)
        1    0.000    0.000    0.000    0.000 core.py:530(expand_paths_if_needed)
       18    0.000    0.000    0.000    0.000 enum.py:628(value)
        2    0.000    0.000    0.000    0.000 std.py:108(release)
        2    0.000    0.000    0.000    0.000 base.py:688(<dictcomp>)
       21    0.000    0.000    0.000    0.000 {built-in method builtins.ord}
       18    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 re.py:215(findall)
        2    0.000    0.000    0.000    0.000 re.py:271(_compile)
        2    0.000    0.000    0.000    0.000 os.py:751(encode)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.repr}
       13    0.000    0.000    0.000    0.000 {method 'startswith' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'flush' of '_io._IOBase' objects}
        1    0.000    0.000    0.000    0.000 registry.py:199(get_filesystem_class)
        1    0.000    0.000    0.000    0.000 version.py:444(_cmpkey)
        1    0.000    0.000    0.000    0.000 utils.py:74(__eq__)
        2    0.000    0.000    0.000    0.000 trainer.py:2037(current_epoch)
       13    0.000    0.000    0.000    0.000 trainer.py:2061(fit_loop)
        1    0.000    0.000    0.000    0.000 serialization.py:228(_open_file_like)
        4    0.000    0.000    0.000    0.000 posixpath.py:41(_get_sep)
       10    0.000    0.000    0.000    0.000 {method 'group' of 're.Match' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.all}
        7    0.000    0.000    0.000    0.000 fit_loop.py:65(global_step)
        1    0.000    0.000    0.000    0.000 core.py:308(<listcomp>)
        1    0.000    0.000    0.000    0.000 std.py:188(__format__)
        1    0.000    0.000    0.000    0.000 generic.py:2053(<dictcomp>)
        1    0.000    0.000    0.000    0.000 re.py:232(compile)
        2    0.000    0.000    0.000    0.000 {built-in method _hashlib.openssl_md5}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        4    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        1    0.000    0.000    0.000    0.000 core.py:207(__getitem__)
        1    0.000    0.000    0.000    0.000 {method 'search' of 're.Pattern' objects}
       10    0.000    0.000    0.000    0.000 {method 'rstrip' of 'str' objects}
        2    0.000    0.000    0.000    0.000 std.py:1167(_comparable)
        2    0.000    0.000    0.000    0.000 serialization.py:193(_is_path)
        1    0.000    0.000    0.000    0.000 {built-in method now}
        2    0.000    0.000    0.000    0.000 hparams_mixin.py:127(hparams)
        1    0.000    0.000    0.000    0.000 core.py:124(__del__)
        5    0.000    0.000    0.000    0.000 blocks.py:238(mgr_locs)
        4    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
        7    0.000    0.000    0.000    0.000 result.py:153(forked)
        2    0.000    0.000    0.000    0.000 local.py:337(closed)
        1    0.000    0.000    0.000    0.000 core.py:601(<listcomp>)
        1    0.000    0.000    0.000    0.000 utils.py:97(update_storage_options)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:26(__exit__)
        2    0.000    0.000    0.000    0.000 enum.py:613(__reduce_ex__)
        3    0.000    0.000    0.000    0.000 {method 'sub' of 're.Pattern' objects}
        3    0.000    0.000    0.000    0.000 {method 'rfind' of 'str' objects}
        1    0.000    0.000    0.000    0.000 result.py:528(valid_items)
        7    0.000    0.000    0.000    0.000 result.py:562(any_tensor)
        1    0.000    0.000    0.000    0.000 core.py:60(__init__)
        3    0.000    0.000    0.000    0.000 model_checkpoint.py:351(on_save_checkpoint)
        1    0.000    0.000    0.000    0.000 std.py:155(__init__)
        1    0.000    0.000    0.000    0.000 flags.py:96(__getitem__)
        3    0.000    0.000    0.000    0.000 pathlib.py:628(__reduce__)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:20(__enter__)
        2    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
        1    0.000    0.000    0.000    0.000 trainer.py:2049(max_steps)
        1    0.000    0.000    0.000    0.000 local.py:348(__getattr__)
        1    0.000    0.000    0.000    0.000 core.py:512(split_protocol)
        4    0.000    0.000    0.000    0.000 version.py:271(<genexpr>)
        4    0.000    0.000    0.000    0.000 {built-in method posix.fspath}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        2    0.000    0.000    0.000    0.000 {method 'replace' of 'str' objects}
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:326(should_rank_save_checkpoint)
        1    0.000    0.000    0.000    0.000 std.py:1171(__hash__)
        2    0.000    0.000    0.000    0.000 generic.py:345(flags)
        2    0.000    0.000    0.000    0.000 base.py:1449(name)
        2    0.000    0.000    0.000    0.000 {method 'hexdigest' of '_hashlib.HASH' objects}
        3    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 fit_loop.py:55(current_epoch)
        2    0.000    0.000    0.000    0.000 core.py:504(get_compression)
        3    0.000    0.000    0.000    0.000 version.py:393(_parse_letter_version)
        1    0.000    0.000    0.000    0.000 dataset.py:78(__getattr__)
        1    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        1    0.000    0.000    0.000    0.000 optimizer.py:112(<dictcomp>)
        1    0.000    0.000    0.000    0.000 serialization.py:224(__exit__)
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        3    0.000    0.000    0.000    0.000 base.py:234(on_train_end)
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        2    0.000    0.000    0.000    0.000 {built-in method _thread.get_ident}
        1    0.000    0.000    0.000    0.000 {built-in method time.time}
        2    0.000    0.000    0.000    0.000 {built-in method _stat.S_ISDIR}
        1    0.000    0.000    0.000    0.000 {method 'findall' of 're.Pattern' objects}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        2    0.000    0.000    0.000    0.000 {method 'clear' of 'list' objects}
        2    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C.DoubleStorageBase' objects}
        2    0.000    0.000    0.000    0.000 fit_loop.py:70(global_step)
        3    0.000    0.000    0.000    0.000 base.py:54(trainer)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(precision_plugin)
        1    0.000    0.000    0.000    0.000 trainer.py:1686(optimizers)
        1    0.000    0.000    0.000    0.000 trainer.py:1699(lr_schedulers)
        3    0.000    0.000    0.000    0.000 hooks.py:802(on_save_checkpoint)
        2    0.000    0.000    0.000    0.000 core.py:627(<genexpr>)
        1    0.000    0.000    0.000    0.000 <string>:1(__new__)
        2    0.000    0.000    0.000    0.000 serialization.py:199(__init__)
        1    0.000    0.000    0.000    0.000 typing_extensions.py:1067(_dict_new)
        1    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        2    0.000    0.000    0.000    0.000 {method 'flush' of '_io.BytesIO' objects}
        2    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'split' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'rsplit' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'keys' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'data_ptr' of 'torch._C.DoubleStorageBase' objects}
        1    0.000    0.000    0.000    0.000 fit_loop.py:102(max_steps)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:42(checkpoint_io)
        1    0.000    0.000    0.000    0.000 registry.py:36(__contains__)
        1    0.000    0.000    0.000    0.000 core.py:547(<listcomp>)
        2    0.000    0.000    0.000    0.000 core.py:636(<genexpr>)
        2    0.000    0.000    0.000    0.000 spec.py:56(<genexpr>)
        1    0.000    0.000    0.000    0.000 registry.py:24(__getitem__)
        1    0.000    0.000    0.000    0.000 spec.py:143(_fs_token)
        1    0.000    0.000    0.000    0.000 version.py:326(release)
        2    0.000    0.000    0.000    0.000 version.py:459(<lambda>)
        1    0.000    0.000    0.000    0.000 std.py:165(colour)
        1    0.000    0.000    0.000    0.000 std.py:169(colour)
        1    0.000    0.000    0.000    0.000 utils.py:57(__init__)
        1    0.000    0.000    0.000    0.000 utils.py:61(__format__)
        1    0.000    0.000    0.000    0.000 serialization.py:314(_check_dill_version)
        2    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        3    0.000    0.000    0.000    0.000 base.py:283(on_save_checkpoint)
        1    0.000    0.000    0.000    0.000 generic.py:324(attrs)
        1    0.000    0.000    0.000    0.000 flags.py:51(allows_duplicate_labels)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:16(__init__)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:52(_commit_removals)
        1    0.000    0.000    0.000    0.000 {method 'endswith' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {function OpenFiles.__getitem__ at 0x7f1ab8d7a488}
        1    0.000    0.000    0.000    0.000 {method 'element_size' of 'torch._C.DoubleStorageBase' objects}
        1    0.000    0.000    0.000    0.000 utilities.py:173(_is_max_limit_reached)
        1    0.000    0.000    0.000    0.000 single_device.py:73(is_global_zero)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:347(on_train_end)
        1    0.000    0.000    0.000    0.000 hooks.py:43(on_train_end)
        1    0.000    0.000    0.000    0.000 spec.py:178(_get_kwargs_from_urls)
        1    0.000    0.000    0.000    0.000 version.py:432(_parse_local_version)
        1    0.000    0.000    0.000    0.000 std.py:1315(<lambda>)
        2    0.000    0.000    0.000    0.000 serialization.py:202(__enter__)
        1    0.000    0.000    0.000    0.000 generic.py:2047(<dictcomp>)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_fit_end
         75 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:70(on_fit_end)
        6    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
        6    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        6    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        6    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        6    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        6    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        7    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        6    0.000    0.000    0.000    0.000 base.py:87(on_fit_end)
        1    0.000    0.000    0.000    0.000 trainer.py:1611(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 hooks.py:34(on_fit_end)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: teardown
         72 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:50(teardown)
        6    0.000    0.000    0.000    0.000 trainer.py:1682(lightning_module)
        6    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        6    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        6    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        6    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        6    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        6    0.000    0.000    0.000    0.000 trainer.py:1607(accelerator)
        6    0.000    0.000    0.000    0.000 base.py:71(teardown)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 hooks.py:399(teardown)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}


